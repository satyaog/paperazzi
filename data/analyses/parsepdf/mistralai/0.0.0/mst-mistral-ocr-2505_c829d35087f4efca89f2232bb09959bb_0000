{
  "pages": [
    {
      "markdown": "# scCross: A Deep Generative Model for Unifying Single-cell Multi-omics with Seamless Integration, Cross-modal Generation, and In-silico Exploration \n\nXiuhui Yang ${ }^{1}$, Koren K. Mann ${ }^{2}$, Hao Wu ${ }^{1 *}$ and Jun Ding ${ }^{3,4 *}$<br>${ }^{1}$ School of Software, Shandong University, 1500 Shunhua, Jinan, 250101, Shandong, China.<br>${ }^{2}$ Department of Pharmacology and Therapeutics, McGill<br>University, Montreal, H3G 1Y6, QC, Canada.<br>${ }^{3}$ Meakins-Christie Laboratories, Department of Medicine, McGill<br>University Health Centre, Montreal, H4A 3J1, QC, Canada.<br>${ }^{4}$ Mila-Quebec AI Institute, Montreal, H2S 3H1, QC, Canada.\n\n*Corresponding author(s). E-mail(s): haowu@sdu.edu.cn; jun.ding@mcgill.ca;\nContributing authors: xiuhuiyang@mail.sdu.edu.cn; koren.mann@mcgill.ca;\n\n\n#### Abstract\n\nSingle-cell multi-omics illuminate intricate cellular states, yielding transformative insights into cellular dynamics and disease. Yet, while the potential of this technology is vast, the integration of its multifaceted data presents challenges. Some modalities have not reached the robustness or clarity of established scRNA-seq. Coupled with data scarcity for newer modalities and integration intricacies, these challenges limit our ability to maximize single-cell omics benefits. We introduce scCross: a tool adeptly engineered using variational autoencoder, generative adversarial network principles, and the Mutual Nearest Neighbors (MNN) technique for modality alignment. This synergy ensures seamless integration of varied single-cell multi-omics data. Beyond its foundational prowess in multi-omics data integration, scCross excels in single-cell cross-modal data generation, multi-omics data simulation, and profound in-silico cellular perturbations. Armed with these capabilities, scCross is set to transform the field of single-cell research, establishing itself in the nuanced integration, generation, and simulation of complex multi-omics data."
    },
    {
      "markdown": "Keywords: single cell, muti-omics, cross-modal generation, in-silico perturbations, multimodal integration, generative adversarial network, autoencoder\n\n# Backgrounds \n\nThe advent of single-cell sequencing technologies has ushered in a new era of biological research, enabling scientists to deconvolve cellular heterogeneity in unprecedented detail [1-3]. This granularity has illuminated intricate cellular dynamics across myriad biological processes. To harness the full potential of this data deluge, a suite of computational tools has been developed, propelling advancements in fields as diverse as cancer biology, neurobiology, and drug discovery [4-8]. However, many of these tools are tailored to specific data modalities, such as scRNA-seq [9] or scATAC-seq [10, 11], often providing a piecemeal view of the cellular landscape.\n\nAs the single-cell sequencing paradigm matures, we are seeing the convergence of multiple data modalities, offering a holistic view of cellular states [3, 12-28]. Effective single-cell multi-omics data integration remains challenging, particularly when integrating unmatched data. Many single-cell multi-omics measurements are unmatched, profiling varied cell populations across modalities and thus missing the matched multimodal profiling of the same cells.\n\nExisting methods have emerged to tackle this data integration challenge, each with its own set of advantages and drawbacks. Some, like Seurat [29], hinge on finding commonalities across modalities, while others explore nonlinear transformations or lean into deep learning. Many of these techniques face issues ranging from information loss [30] to noise susceptibility. Furthermore, due to the cost and difficulty in experiments, there is often a significant scarcity of matched single-cell multi-omics data that comprehensively profiles cellular states. Instead, we typically have abundant data for the most dominant modality (like scRNA-seq) but limited or no profiling for other modalities (e.g., epigenetics). The presence of other matched single-cell multi-omics data offers the potential for cross-modal generation of missing modalities from the more abundant ones by transferring knowledge learned from the reference.\n\nHere, we introduce scCross. At its foundation, scCross excels in its function of single-cell multi-omics data integration, bringing unparalleled precision to the assimilation of diverse data modalities. While preserving its primary proficiency in this arena, the most distinctive feature of scCross emerges: its prowess in cross-modal single-cell data generation. This capability, layered atop its integration strength, unlocks transformative potentials for researchers to bridge disparities between abundant and scant modalities. Building on these two principal functionalities, scCross further showcases its versatility by simulating single-cell multi-omics data with high fidelity. Moreover, the tool unveils opportunities for in-silico perturbations within and across modalities,"
    },
    {
      "markdown": "enabling researchers to postulate and evaluate potential cellular interventions. By capturing and elucidating intricate cellular states, scCross equips the scientific community with a thorough grasp of cellular dynamics across modalities. scCross stakes its claim as a vanguard in single-cell multi-omics integration, generation, and simulation.\n\n# Results \n\n## Overview of scCross\n\nscCross employs the Variational utoencoder(VAE)-Generative adversial network(GAN) deep generative framework to integrate single-cell multi-omics datasets, generate cross-modal data, simulate multi-omics data, and perform in-silico perturbations within and across modalities(Fig. 1 and Supplementary Fig. S1). The methodology begins by training modality-specific Variational Autoencoders (VAEs) to capture low-dimensional cell embeddings for each data type, supplemented by the integration of gene set score vectors as representative features. With these embeddings learned, they are integrated into a common latent space. The harmonization of the modalities' data distributions then ensues. The Generative Adversarial Network (GAN) refines this process, with a discriminator network juxtaposed against the VAE generator. This structure ensures a robust multi-modal data integration and confirms the alignment between the actual and generated single-cell inputs.\n\nVenturing beyond mere integration and other functions, the model is specifically designed to facilitate cross-modal data generation. The bidirectional aligner is crucial for this cross-modal generation, as it decodes the shared latent embedding into a distinct modality, relying on the cell embedding sourced from the other modalities. This ambition of the model requires a dual alignment: a congruent data distribution and a meticulous coordination of individual cells across modalities. Mutual Nearest Neighbor (MNN) cell pairs are strategically employed as alignment anchors, guiding this intricate process. The optimization of the neural network aims to minimize discrepancies across modalities, especially those evident between MNN pairs. Once trained, the model enables the generation of single-cell data across modalities, encoding data from one modality into the latent space, and subsequently decoding it into another. It can also simulate multi-omics data and facilitates in-silico perturbations within and across modalities, revealing potential modulations of cellular states. By merging single-cell multi-omic data into a unified latent space and enabling information flow across modalities, scCross sets the stage for various multi-omic tasks.\n\n## scCross empowers cross-modal single-cell data generation\n\nSingle-cell multi-omics data offers deep insights into the complexities of cellular states. Yet, factors such as cost and experimental challenges often impede our capability to fully harness its advantages, leading to some modalities being"
    },
    {
      "markdown": "![img-0.jpeg](img-0.jpeg)\n\nFig. 1 Architecture of the scCross framework. scCross employs modality-specific Variational Autoencoders to capture cell latent embeddings $\\mathbf{z}_{R}, \\mathbf{z}_{S}, \\mathbf{z}_{A}, \\ldots$, for each omics type. During single-cell data integration, the method leverages biological priors by integrating gene set matrices $\\mathcal{G} \\mathcal{S}_{R}, \\mathcal{G} \\mathcal{S}_{S}, \\mathcal{G} \\mathcal{S}_{A}, \\ldots$, as additional features for each cell. The framework then harmonizes these enriched embeddings into shared embeddings $z$ using further variational autoencoders and critically, bidirectional aligners. Bidirectional aligners are pivotal for the cross-modal generation, depicted by brown arrows signifying the transition from scRNAseq to scATAC-seq. Mutual Nearest Neighbor (MNN) cell pairs ensure precision during alignment. Discriminator $\\mathrm{D}_{z}$ maintains the integration of different omics and discriminators $\\mathrm{D}_{g e_{R}}, \\mathrm{D}_{g e_{S}}, \\mathrm{D}_{g e_{A}}, \\ldots$, maintain the integrity and consistency of generated data. scCross offers a powerful toolbox for single-cell data integration, facilitating cross-modal data generation, single-cell data self augmentation, single-cell multi-omics simulation, and in-silico perturbations, making it versatile for a plethora of single-cell multi-omics challenges.\nless explored than others. In this context, scCross emerges as a crucial tool, focused on bolstering cross-modal single-cell data generation to tap into the vast potential of single-cell multi-omics. It achieves this by seamlessly integrating knowledge across modalities, drawing from established reference single-cell multi-omics datasets encompassing all desired modalities or from multi-omic datasets where the underrepresented modalities were insufficiently profiled.\n\nWhile tools like scglue have their merits in single-cell multi-omics data integration, they inherently lack the capability for cross-modal generation. Specifically, scglue's entire framework emphasizes its unsuitability for crossmodal data generation, especially when noting that its decoder is designed to process embeddings from the input of the same modality. Contrastingly, scCross is architected to bridge such analytical gaps. To showcase its prowess"
    },
    {
      "markdown": "![img-1.jpeg](img-1.jpeg)\n\nFig. 2 Performance of scCross in crossmodal single-cell data generation: emphasis on similarity between actual and cross-generated data. a-e, Results when the model was trained on the partial dataset: a, UMAP visualization emphasizes the overlapping distribution between the original and cross-generated scRNA-seq data. b, Comparison of cell type proportions reveals a robust correlation of $0.89(P=0.001311)$. c, Expression levels of the top 5 genes per cell type exhibit a correlation of $0.93\\left(P=5.356 \\times 10^{-177}\\right)$. d, Cell-cell interaction metrics show congruity across cell types with a correlation of 0.82 $\\left(P=1.356 \\times 10^{-20}\\right)$. e, Ratios of genes in the most significant pathways for each cell type validate a correlation of $0.85\\left(P=2.531 \\times 10^{-13}\\right)$ between the original and cross-generated datasets. f-g, Results when the model was trained on independent reference multi-omics datasets: f, UMAP visualization illustrates the clustering resemblance between the original and cross-generated matched mouse scRNA-seq data. g, Cell type proportions underscore a correlation of $0.89(P=0.001504)$ between the original and cross-generated scRNA-seq data."
    },
    {
      "markdown": "and endorse its robustness and evaluate the method's performance in situations with limited or partial single-cell data of another modality of interest, we divided the matched mouse cortex dataset [31] into two parts - $20 \\%$ for training and the remainder for testing. Leveraging the model trained on the limited matched ( $20 \\%$ ) single-cell data, we applied the method to cross-generate the single-cell RNA-seq for the other missing $80 \\%$ single-cell RNA-seq. The results, depicted in Fig. 2a-e, shed light on scCross's ability not only to generate but also to uphold the biological nuances of the original data. The UMAP visualization [32] in Fig. 2a showcases both the original and generated scRNA-seq data clustering closely, hinting at a high similarity in their distributions. A compelling confirmation of this is observed in Fig. 2b, where the cell type proportion between the original and generated datasets demonstrates a correlation of 0.89 with a $p$-value of 0.001311 . In Fig. 2c, the gene expression of the top 5 genes for each cell type between both datasets remains largely consistent, with a correlation of 0.93 and a $p$-value of $5.356 \\times 10^{-177}$. The remarkable similarity between the actual data and the crossed modality-generated data is apparent in those downstream analysis outcomes. Cell-cell interaction patterns, when analyzed through the CellChat tool [33] as seen in Fig. 2d, not only closely emulate those in the original dataset but also provide a window into potential interactions, leveraging insights from the scATAC-seq data of the other modality. This is quantitatively expressed by a correlation coefficient of 0.82 and a compellingly significant $p$-value of $1.356 \\times 10^{-20}$. Furthermore, pathway analysis based on the top 100 marker genes for each cell type, conducted with the ToppGene platform [34] and depicted in Fig. 2e, reinforces the crossed data's relevance for robust biological interpretation. This analysis maintains a high correlation of 0.85 with a $p$-value of $2.531 \\times 10^{-13}$. The integrity of the crossed data is further substantiated by UMAP analyses presented in Supplementary Figs. S2-S5, which cover a comprehensive set of benchmark datasets, both matched and unmatched. Collectively, these analyses affirm the crossed data's exceptional ability to mirror the biological intricacies and preserve the analytical properties of the actual data.\nscCross's capability for cross-modality generation was further rigorously tested in a scenario devoid of any direct training set for the missing modality. Utilizing an unmatched reference single-cell multi-omics dataset containing both RNA-seq and ATAC-seq data from the same samples [35], scCross was trained to harness and transfer this integrated knowledge. It was then tasked with generating single-cell RNA-seq data from single-cell ATAC-seq data alone, sourced from another matched multi-omics dataset [31]. The authenticity of this cross-generated RNA-seq data was critically assessed against the actual RNA-seq dataset, with the UMAP overlap in Fig. 2f serving as a visual testament to scCross's crossmodal generation precision. The correlation in cell type composition between the cross-generated RNA-seq data and the actual RNAseq data further substantiates scCross's performance, achieving a correlation of 0.89 and a $p$-value of 0.001504 as illustrated in Fig. 2g. The practicality and relevance of scCross's output are reinforced through various downstream"
    },
    {
      "markdown": "analyses, detailed in Supplementary Fig. S6. This showcases scCross's ability to not just mimic, but also potentially extrapolate and fill in gaps in singlecell omics profiles, reinforcing its role as a potent tool for advancing biological insights in the absence of comprehensive multi-omic datasets.\n\nBeyond the cross-generational capabilities from one modality to another, our exploration extended to augment the inputs within the same modality, leveraging the inherent reconstruction and augmentation strength of the VAEGAN framework [36-38]. This captivating line of inquiry uncovered that the data underwent an augmentation phase, which in turn enriched its quality and expanded its informational depth. Detailed results and visualizations can be found in Supplementary Fig. S7.\n\n# Simulation of matched single-cell multi-omics data \n\nAnother capability of scCross is its ability to generate matched single-cell multi-omics data. This computational prowess opens the door to numerous practical applications. One immediate use is in benchmarking existing single-cell multi-omics integration methods, especially in scenarios where true matched single-cell multi-omics data is lacking for accurate evaluations. Moreover, the simulated data can also serve as a basis for deciphering intricate inter-omics relationships, predicting states of unmeasured omics, or filling in the gaps in studies with incomplete modalities.\n\nOne of the standout features of scCross is its tailored generation capability, targeting specific cell types of interest across various omics layers. This becomes indispensable when focusing on rare cell populations, which often are underrepresented in sequenced datasets. The limited number of cells in these populations poses challenges for in-depth analysis and examination. Here, scCross provides a valuable solution. By simulating data up to 5 X the original count, as shown in Panels 3a and 3b, scCross can substantially upscale the representation of these rare populations, enabling more robust and comprehensive statistical analyses.\n\nPanel 3a illustrates the simulated single-cell RNA-seq data of Ast cells in matched mouse cortex dataset, both at its original count and a 5 X upscale with the whole original matched mouse cortex dataset as cluster background. Panel b mirrors this information for the scATAC-seq data. The high-quality cell clustering shown in these panels testifies to the effectiveness of our simulation approach. Other cell types in matched mouse cortex dataset also give out the same results (Supplementary Fig. S8).\n\nTo showcase the efficacy of scCross in simulating single-cell multi-omics data for rare cell populations, we targeted the Astrocyte (Ast) cells within the dataset, augmenting their representation by a fivefold increase. This upscaling was performed to better understand the potential implications of such rare cell types in subsequent analyses. We then conducted a comparative study between the original and the simulated dataset, centering on the enriched Gene Ontology (GO) terms and pathways linked to the Ast cell marker genes prior to and following their expansion. In Fig. 3c, the enriched terms are ranked"
    },
    {
      "markdown": "![img-2.jpeg](img-2.jpeg)\n\nFig. 3 Simulation of matched single-cell multi-omics data. a, UMAP visualization showcasing the prowess of scCross in simulating the scRNA-seq data of rare Ast cells in matched mouse cortex dataset (highlighted by gray cycles), presented at 1 X and 5 X their original count with the whole original dataset as cluster background. The 5 X scale highlights the model's capability to upscale the representation of underrepresented populations like Ast cells. b, Parallel to Panel a, this UMAP visualization delineates the simulated scATACseq data for Ast cells at the same 1 X and 5 X scales (highlighted by gray cycles), reinforcing the model's consistent performance across omic modalities. c, The analysis contrasts the Gene Ontology (GO) terms and pathways enriched among the top biomarkers of the original Astrocyte (Ast) cells (scRNA-seq) with those of its 5X augmented simulated equivalent. The comparison underscores the model's proficiency in amplifying key biological signals within the framework of multi-omics data simulation. d, RRHO plot emphasizing the significant correlation between the original Ast scRNA-seq data and its 1X simulated counterpart. This highlights the model's accurate capture of key biomarker genes during the simulation. e, FOSCTTM integration metrics underscore the potential of the 1X simulated Ast cells' singlecell multi-omics data (encompassing both scRNA-seq and scATAC-seq) as an evaluative benchmark. Both scCross and scglue are compared; however, the inherent bias towards scCross due to the data's origin should be acknowledged. f, UMAP visualization displaying the robust cell mixing achieved by both scglue and scCross when processing the 1X simulated Ast cells' single-cell multi-omics data, providing a vivid demonstration of their respective capabilities.\nand displayed, with particular attention to the leading terms. The two principal terms, 'Vascular transport' [39] and 'Transport across blood-brain barrier' [40], were found to be closely associated with the physiological roles of the Ast cells. The pathway 'NOTCH1 regulation of endothelial cell calcification' shows significance only in the 5 x upscaled Ast cell simulated data, but not in"
    },
    {
      "markdown": "the original dataset. These findings were verified to be associated with the signaling processes in Ast cells [41], thereby further substantiating the potential effectiveness of scCross in enhancing rare cell populations. Further validating the simulation's accuracy, Fig. 3d compares the simulated data against the actual dataset for these rare Ast cells. The RRHO plot therein confirms that scCross preserves the key attributes of the Ast cells, thereby substantiating the simulated data's fidelity for this specific subset within the larger dataset.\n\nThe utility of this simulated data extends beyond mere generation. Panels 3 e and 3 f spotlight its potential applications. The panels underscore that the generated single-cell multi-omics data (1X simulated Ast) are \"matched\" since cells from distinct modalities derive from a consistent joint latent space. Panel e showcases the potential of using simulated data as an effective ground-truth to appraise single-cell data integration techniques. This perspective is reinforced in Panel f's UMAP scatter plot, revealing exceptional cell mixing across modalities by both scglue and scCross. However, when examining the comparison in Panel e, caution is advised. Since these simulated datasets originate from the scCross model, there might be a slight bias in favor of scCross. Nevertheless, this comparison underscores that these simulated datasets can serve as robust matched single-cell multi-omics benchmarks for examining a range of other integration methods especially when ground truth is experimentally unattainable.\n\n# scCross enables multi-omic in-silico perturbation for exploring potential cellular state intervention \n\nIn our endeavor to showcase the capabilities of scCross, we highlight its expertise in conducting in-silico multi-omic perturbations. These capabilities not only enable the exploration of potential intervention strategies for cellular state manipulation but also provide insights into the intricacies of molecular responses, particularly those seen in COVID-19 infections using the single-cell multi-omic dataset derived from a comprehensive study [17].\n\nWe began by measuring the scaled cosine distance between the in-silico perturbed latent matrix of COVID-19 cells and that of healthy cells (Fig. 4a) in the joint latent space produced by scCross. This allowed us to pinpoint signature marker genes that bridge the these two conditions (i.e., diseased vs. healthy) via in-silico perturbations (see Methods for details). The identified critical disease-associated marker genes from this in-silico perturbation, presented in Fig. 4b, are in line with recent findings. A notable observation was the downperturbation of CCL3 in COVID-19 samples, suggesting its overexpression in COVID-19 patients. This concurs with prior studies that identified CCL3's role with inflammatory macrophages and its contribution to inflammatory tissue damage and respiratory issues in COVID-19 patients [42-44]. Furthermore, the GO and pathway outcomes from the down-perturbation gene findings, showcased in Fig. 4c, unveiled significant associations with immune responses. Aspects like signaling receptor binding, immunoglobulin receptor binding, antigen binding, humoral immune response, adaptive immune response, and"
    },
    {
      "markdown": "![img-3.jpeg](img-3.jpeg)\n\nFig. 4 scCross empowers in-silico multi-omic perturbation as demonstrated in the COVID-19 dataset. a, UMAP visualization of COVID-19 scRNA-seq and ADT data clusters. b, Signature genes for in-silico perturbation bridging COVID-19 and healthy states. c, Pathways and GO terms of the top differential genes detected by scCross (downperturbation gene findings), with -log ( $p$-value) indicating significance, compared with t-test and wilconxon. d, Gene comparison between scCross-derived perturbed protein data and common-gene based on scRNA-seq to protein translation. e, RRHO plot comparing crossmodal perturbed and original COVID-19 protein data against healthy samples. f, Heatmap aligning original and scCross-derived perturbed COVID-19 protein data.\nimmunoglobulin complex are highlighted. These observations align well with the recognized impact of immune responses and chemokine activations in the context of COVID-19 [43]. The performance on the COVID-19 adverse outcome pathway [45], Network map of SARS-CoV-2 signaling pathway [46], and"
    },
    {
      "markdown": "SARS-CoV-2 innate immunity evasion and cell-specific immune response pathway [47] further validates scCross's potential in pinpointing signature genes between disease conditions within the same modality.\n\nFig. 4d delves into scCross's potential in performing cross-modality insilico perturbations. By specifically perturbing the gene expression of signature genes that potentially transition healthy cells to a COVID-19-like state in the healthy scRNA-seq data and utilizing cross-generation, we generate perturbed protein data (ADT) across modalities to simulate the COVID condition. This perturbed ADT, when juxtaposed with the healthy protein data, yielded differential proteins (List A). This list was then contrasted with the actual differential protein list (List B) obtained from single-cell ADT comparisons between healthy and COVID datasets. The profound overlap between the two lists showcases the accuracy of cross-modal in-silico perturbations using scCross. Only three of the top 100 differentially expressed genes in scRNA-seq corresponded with those identified in single-cell protein measurements. This misalignment underscores the pitfalls of the naive strategy, which assumes that a gene differential at the RNA level is similarly differential at the protein level. Such discrepancies emphasize the efficacy and critical importance of scCross in these analyses.\n\nFig. 4e, with its RRHO plot, further magnifies the similarity between the cross-modal perturbed ADT and the actual ADT COVID dataset. The heatmap in Fig. 4f underlines this alignment, with a $p$-value of $1.839 \\times 10^{-51}$ (via the Wilcoxon test) cementing the proximity between the perturbed protein data and actual single-cell protein measurements. Conclusively, the data presents a compelling case for scCross's ability to manage in-silico perturbations across modalities, reiterating its value in intricate multi-omic cellular state explorations.\n\n# scCross improves single-cell multi-omics integration over established methods \n\nSingle-cell multi-omics data has emerged as a transformative tool that comprehensively captures cellular states, offering profound insights into cellular identity and function. Effective integration of the multi-omics data produces cell embeddings crucial for diverse analyses. These embeddings are pivotal for precise cell clustering and identification, and they support numerous downstream tasks. Metrics such as the Adjusted Rand Index (ARI) [48] and Normalized Mutual Information (NMI) [49] are invaluable in evaluating the quality of these embeddings, reflecting the proficiency of an integration method in retaining biological information.\n\nWe benchmarked scCross against several state-of-the-art single-cell data integration methods, including Seurat v4 [29], scglue [36], and uniPort [37]. Our analysis utilized three gold-standard datasets derived from recent single-cell multi-omics sequencing, encompassing simultaneous scRNA-seq and scATAC-seq profiling. These datasets are matched mouse cortex [31], matched mouse lymph nodes [50], and matched mouse atherosclerotic plaque immune"
    },
    {
      "markdown": "cells (GSE240753). Additionally, we benchmarked the methods on another unmatched dataset, which includes scRNA-seq [35], scATAC-seq sourced from the 10X Genomics website, and an snmC-seq dataset [18].\n![img-4.jpeg](img-4.jpeg)\n\nFig. 5 Benchmarking superiority of scCross in single-cell multi-omics data integration. a, A comprehensive comparative analysis showcases the standout performance of scCross against other integration methods. Metrics such as average ARI, NMI scores, and ASW for cell types provide insights into clustering quality on the integrated single-cell multi-omics datasets, signifying the retention of biological characteristics after integration. Additionally, the ASW for omics layers and graph connectivity metrics shed light on the effective mixing of different omics post-integration. The datasets studied include the unmatched and matched mouse cortex, matched mouse lymph nodes, and matched mouse atherosclerotic plaque immune cells. \"NA\" indicates cases where results were not obtainable. b, FOSCTTM scores further underscore the exceptional performance of scCross on subsampled datasets of varying sizes, demonstrating its consistent superiority over other integration techniques. This section delves into datasets like the matched mouse cortex, matched mouse lymph nodes, and matched mouse atherosclerotic plaque immune cells.\n\nAgainst this landscape, scCross stands as a leading method in singlecell multi-omics data integration, showcasing superior performance relative to other methods (Fig. 5 and Supplementary Figs. S9-S12). This distinction is evident from two primary angles. Firstly, scCross excels in downstream"
    },
    {
      "markdown": "cell clustering, as demonstrated by its outstanding ARI, NMI, and cell type average silhouette width [36,51] metrics across all benchmark datasets (Fig. 5a). Secondly, its prowess in cell mixing is apparent, seamlessly blending cells from different modalities. Effective cell mixing is indicative of high-quality integration and the method's ability to represent the intricate nuances of each modality. Please refer to the Methods for a detailed description of the evaluation metrics.\n\nTo further underline our model's capacity for omics mixing, we assessed the FOSCTTM (Fraction of Samples Closer than the True Match) score [52], a metric quantifying the alignment error in single-cell multi-omics data integration. This score provides insights into how closely related cells from one omics modality are to those from another in the integrated latent space. A lower FOSCTTM score signals a more accurate integration, as the true match is typically closer than many of the other potential matches. On all three matched datasets, scCross consistently achieved the lowest FOSCTTM on all sizes of subsampled datasets, underscoring its alignment capabilities (Fig. 5b). Furthermore, scCross exhibits stable integration performance across an extensive range of hyperparameter settings (Supplementary Fig. S13a-b), significantly reducing the challenge of parameter tuning.\n\nEffective integration is vital for successful downstream activities such as cross-modal generation, multi-omics simulation, and in-silico perturbation. Stellar performance in these subsequent tasks speaks to the exemplary data integration and information retention capabilities of scCross. Notable differences between modalities in the combined latent space can obstruct generation, simulation, or in-silico perturbation, underscoring the necessity of seamlessly merging all modalities into a unified space.\n\nWith the advent of high-throughput single-cell technologies, there's an increasing demand for methods that can effectively process large-scale singlecell multi-omics data, often comprising millions of cells [36, 53]. In our evaluation of scCross's integrative capabilities, we tapped into over four million human single-cell atlases, consisting of gene expression data for four million cells [54] and chromatin accessibility data for 0.7 million cells [55]. The challenge with such large-scale integration lies not just in the data volume but also in handling extensive heterogeneity, low per-cell coverage, and the imbalances in cell type compositions [36]. Moreover, there's a common pitfall where existing methods tend to blend minority cell types with the majority, skewing accurate representation and estimation of these pivotal cell groups [56].\nscCross addresses these challenges effectively and retains a significant amount of biological data. Unlike existing methods, this approach can differentiate and represent minority cell populations distinctly from the dominant ones. Thanks to the minibatch neural networks [57], scCross achieves sublinear time complexity and roughly linear memory consumption, as highlighted in Supplementary Fig. S13c. Through the strategic use of the generative adversarial network and MNN prior, scCross brings together gene expression and chromatin accessibility data into a comprehensive multi-omics human cell"
    },
    {
      "markdown": "atlas [55], distinguishing the minority cell populations from the majority as demonstrated in Supplementary Fig. S14a-b.\n\nIn scglue's analysis by Cao et al. [36], notable discrepancies between cell type labels across omics modalities were uncovered. Cells labeled as Astrocytes in scATAC-seq data were found to be aligned with Excitatory neuron clusters in scRNA-seq, suggesting a potential mislabeling in the scATAC-seq dataset, which was inferred from biomarker analysis. Furthermore, a cluster identified as Astrocytes/Oligodendrocytes in scATAC-seq was divided and realigned to separate Astrocytes and Oligodendrocytes clusters in scRNA-seq, as indicated by blue cycles in Supplementary Fig. S15a-b. These discrepancies identified by scglue were also replicated by scCross, shown in the blue-highlighted clusters in Supplementary Fig. S14b and Supplementary Fig. S15c. Our analysis further confirms the potential inaccuracy of the Astrocytes annotation in scATACseq data, as its top marker genes are not consistent with the biomarkers of Astrocytes in scRNA-seq data (Supplementary Fig. S15d). Both scglue and scCross demonstrate the ability to detect and address potential discrepancies in cell annotations across different omics datasets.\n\nCompared to methods such as scglue [36], scCross demonstrates enhanced capability in identifying minority cell type populations. This is particularly evident in the case of critical minority populations like Extravillous trophoblasts [58-60]-key cells in placental development and function-and Microglia [61-63], which are the primary immune cells in the brain involved in neuroinflammation and tissue repair. These cells are crucial in reproductive and neural systems, respectively. These critical populations are often prone to over-integration with majority cell types in other method like scglue [36] (Supplementary Fig. S15a). However, as highlighted by the red cycle in Fig. S8B, scCross distinguishes them, further validating the integration prowess of our approach. Comprehensive benchmark comparisons between scCross and scglue [36] for this dataset are available in Supplementary Fig. S15e. Alternative approaches such as Seurat v4 and UniPort have not demonstrated their effectiveness in integrating large-scale single-cell multi-omics data with millions of cells.\n\nGiven its intrinsic modularity, scCross is not limited to merely a binary omic integration but boasts the capability to consolidate multiple omic layers (e.g., more than 3), attesting to its comprehensive applicability. To showcase this extensive integration potential, we employed scCross on single-cell multiomics data of the adult mouse cortex, encompassing three distinct modalities: gene expression [35], chromatin accessibility, and DNA methylation [16].\n\nIn Fig. 6a-d, scCross exemplifies its prowess in aligning the cell types across the three modalities. The alignment is significantly enriched by the incorporation of common genes MNN prior and specific gene sets, thereby ensuring that corresponding cell types from various omic layers converge harmoniously within the latent space. Such alignment not only amplifies the clarity of cell type demarcation across the omic layers but also paves the way for enhanced"
    },
    {
      "markdown": "![img-5.jpeg](img-5.jpeg)\n\nFig. 6 Efficient integration of three omics layers in the mouse cortex by scCross. a-c, UMAP visualizations display the aligned cell embeddings, clustering, and cell type annotations for scRNA-seq $\\mathbf{a}_{i}$, snmC-seq $\\mathbf{b}_{i}$, and scATAC-seq $\\mathbf{c}$, on the shared joint latent space, exemplifying the coherence in cellular representations across modalities. d, A comprehensive UMAP presentation underlines the flawless intermixing of cells from distinct modalities within the shared latent space, reflecting a true amalgamation of multi-omics information. e, An UpSet plot emphasizes the alignment potency of our model, revealing through a three-way biomarker comparison that the distinct modalities are seamlessly integrated within the latent space. Leveraging a three-way Fisher's exact test [64], our model is showcased to either match or surpass scglue [36] in the alignment of over half of the cell types, with standout results accentuated by a red outline.\ncell typing efficacy. scCross demonstrates its proficiency in navigating tripleomics datasets, providing a shared cell embedding that effectively distinguishes between cell types for each modality, as depicted with RNA in Fig. 6a. This clear separation is mirrored in the ATAC-seq and snmC-seq modalities, where cell types also form distinct groupings in Fig. 6b and c, respectively. The embedding further shows its strength by closely aligning identical cell types across different modalities, which are visible as clusters in the same regions of the UMAP space. Adding to this, Fig. 6d illustrates the embedding's capacity for mixing cells from different modalities in the shared space, facilitating the study of cross-modality interactions without the loss of cell-type-specific clustering. This nuanced approach ensures that while cell types from different modalities interweave, they still maintain the fidelity of their distinct embeddings.\n\nUpon establishing the shared cell embeddings, our evaluation centered on the coherence of cell type-specific markers across modalities to validate the alignment accuracy. As depicted in Fig. 6e, there's a pronounced intersection of markers for each cell type between modalities, substantiating the precision of our cell type alignments. This significant overlap was confirmed by a threeway Fisher's exact test, with three cell types showing a staggering FDR below $10^{-100}$, and four additional cell types displaying FDRs between $10^{-100}$ and $10^{-50}$. All cell types, with the sole exception of mIn-1, had FDR values indicating strong significance below the 0.05 benchmark. This degree of marker congruence emphasizes the successful integration of the omics layers, as our"
    },
    {
      "markdown": "approach identifies consistent key markers across different modalities for equivalent cell types. In comparison to scglue, our analysis uncovered a greater number of overlapping gene markers in the majority of cell types (9 out of 13), further reinforcing our model's efficacy in multi-omic data integration.\n\n# Discussion \n\nThe ever-evolving domain of single-cell analyses, complemented by multi-omics strategies, continues to redefine our understanding of intricate cellular dynamics. Yet, seamlessly integrating these multi-omics dimensions has remained a challenge. In this context, our scCross method emerges, revolutionizing the way we perceive and amalgamate single-cell multi-omics data. The rigorous testing and evaluations underscore its superior performance, enabling more accurate and comprehensive multi-omics data integration.\n\nBut beyond mere integration, scCross introduces the concept of crossmodal generation. This capability allows researchers to derive data from one modality using another, once the model has been trained on a reference single-cell multi-omics dataset encompassing both source and target modalities. Given the often prohibitive cost and experimental challenges of single-cell multi-omics data acquisition, such functionality is crucial. Often, scientists have extensive data in one modality (e.g., RNA-seq) but limited or no profiling in others. With scCross, the knowledge acquired from a comprehensive multiomics dataset can be channeled to generate data in other modalities from a given single modality, filling gaps in our understanding and providing a more complete view of cellular states.\n\nFurther accentuating its ability, scCross showcases an array of functionalities tailored for the demands of modern cellular research. Its memory efficiency stands out, ensuring that even datasets with millions of cells are integrated with finesse, making it apt for the vast cell atlases being assembled. Simultaneously, its prowess extends to its capacity for single-cell multi-omics data simulation. Through judicious sampling from the joint latent space and adjusting omic-decoders, it can simulate matched single-cell datasets across various modalities for the same consistent set of cells. This serves not only for data augmentation but also as a benchmarking tool, given the known ground truth in these simulated datasets. Building on these capabilities, scCross offers the powerful in-silico perturbation functionality. As evidenced in cases like COVID-19 cellular dynamics, it offers a fresh perspective to formulate and probe potential intervention strategies to modulate cellular states. Once primed with a reference multi-omics dataset, it can be harnessed on single-modality data, enabling intricate multi-omic in-silico explorations.\n\nThe scCross method presents significant potential for the single-cell research community. Its distinct functionalities and reliable performance position it as a potentially valuable tool for researchers in the field of single-cell multi-omics analyses. scCross facilitates the integration of different modalities, supports comprehensive data generation, and enables detailed simulations and"
    },
    {
      "markdown": "perturbations. These capabilities could contribute substantially to advancing the study of complex biological systems.\n\n# Conclusions \n\nscCross has the potential to significantly influence the field of single-cell multiomics research. Its ability to bridge modalities effectively, along with capabilities in cross-modal generation, multi-omics simulation, and augmentation, may enhance both the speed and depth of biomedical research. Additionally, its suitability for in-silico explorations offers practical applications beyond academic research, potentially assisting in the design of targeted experiments for cellular state manipulations and possibly hastening the translation of biomedical research into real-world applications.\n\n## Methods\n\n## Single-cell data processing\n\nThe single-cell data employed in our study follows specific preprocessing pipelines tailored to each modality. Initial procedures, such as cell calling, quality control, and other relevant steps, can follow standard single-cell data processing methods and are often performed by the original data sources $[17,18,31,35]$. Within our workflow, these matrices are further transformed to produce cell vectors optimized for neural network input. Besides, these matrices' feature sets are denoted as $\\mathcal{S}_{k}$, where $k$ ranges from 1 to $K . K$ symbolizes the number of distinct omics data types collected. For example, in scRNA-seq, $\\mathcal{S}_{k}$ represents a gene list, while in scATAC-seq, it represents a set of chromatin regions. Profiling matrices from the $k^{t h}$ modality is represented as $\\mathcal{X}_{k}$. Individual cells from this modality are given by $\\mathbf{x}_{k}^{(n)}$, and $N_{k}$ indicates the sample size.\n\nFor single-cell transcriptomic data, specifically scRNA-seq, we adopt Scanpy [9] (v.1.8.2). The cell-by-gene expression matrix experiences normalization, log-transformation, and scaling. Dimensionality reduction follows, with PCA, as realized in Scanpy [65], being our method of choice. On the epigenetic data front, modalities like scATAC-seq and snmC-seq demand distinct processes. SnmC-seq data transitions through a sequence of normalization, log-transformation, scaling, and PCA, utilizing epiScanpy [66] (v.0.4.0). Given the inherent sparsity of the scATAC-seq data matrix, dimensionality reduction employs the LSI (Latent Semantic Indexing) function of scCross, grounded in the latent semantic indexing algorithm $[14,67]$.\n\nTo facilitate the calculations of gene sets matrix and common gene MNN priors, it is crucial to have a consistent gene-centric representation across different modalities. Due to the inherent nature of MNN priors, the single-cell data from diverse modalities needs to be translated into activities associated with genes. To achieve this uniform representation, we employ the geneactivity function in epiScanpy [66] (v.0.4.0), transforming various omics data types"
    },
    {
      "markdown": "(like scATAC-seq and snmC-seq) into gene activity. The gene formed data (Gene expression/Gene activity score) of each modality $k$ is represented with $\\hat{\\mathbf{x}}_{\\mathbf{k}}$. It is obvious that $\\hat{\\mathbf{x}}_{\\mathbf{k}}=\\mathbf{x}_{\\mathbf{k}}$ when $k^{t h}$ modality is scRNA-seq.\n\nIt's noteworthy that our model's applicability isn't confined to the discussed modalities. For any modality, the transformation of each cell into a real-valued vector is a must. Often, normalization is required to address technical nuances, such as variations in library size among cells. For modalities not tackled in this work, we advocate adhering to the modality-specific standard single-cell preprocessing protocol when generating the input vectors.\n\n# Curating gene sets from Gene Ontology and Pathway terms \n\nIn our study, gene sets $\\mathcal{G} \\mathcal{S}$ are tapped as an avenue to integrate functional biological priors, enhancing the representation learning of cells across different modalities. This, in turn, bolsters the effectiveness of single-cell data integration and generation efforts, as these tasks are fundamentally rooted in effective cell embeddings.\n\nWe utilize a rich collection of gene sets, comprising 7,481 sets from the GO Biological Process ontology (denoted as c5.go.bp in MSigDB [68]), 2,922 gene sets curated from pathway databases (c2.cp in MSigDB [68]), and 335 sets of transcription factor targets sourced from [69]. Gene sets related to biological processes bear the prefix \"GOBP\", while those derived from pathway databases are assigned prefixes echoing their respective sources, such as KEGG [70], WP [71], and REACTOME [72].\n\nTo effectively harness the gene sets, $\\mathcal{G} \\mathcal{S}$, each gene set is characterized based on the genes it contains. In the context of scRNA-seq data, a gene set is represented by the expression levels of its constituent genes. This provides a direct quantification of the gene set's activity within a cell, crucial for grasping cellular states and functions. However, with non-transcriptomic modalities, such as scATAC-seq, where direct gene expression values are absent, we resort to the geneactivity function from epiScanpy [66] (v.0.4.0). This tool calculates a gene activity matrix, serving as an effective surrogate for gene expression. Using this matrix, we can obtain the binary matrix $\\tilde{\\mathbf{x}}_{k}$, which is the correlation of genes in gene expression/activity matrix and genesets in the databases we mentioned above. We utilize the approach of [73] where we set the correlation of a gene to a geneset to 1 if the gene is contained in the geneset, 0 otherwise. Then, we obtain the cell by geneset matrix with the function:\n\n$$\n\\mathcal{G} \\mathcal{S}_{k}=\\hat{\\mathbf{x}}_{k} \\cdot \\tilde{\\mathbf{x}}_{k}\n$$\n\nwhere $\\mathcal{G} \\mathcal{S}_{k}$ means the cell by geneset feature matrix of modality $k$. These scores, once extracted, are integrated with the processed input features, grounding our analyses in solid biological contexts."
    },
    {
      "markdown": "# Deep generative neural network structure \n\nTo learn cell embeddings from omics data, we employ a variational autoencoder (VAE).\n\nOur model initially projects $\\mathbf{x}_{k}$ into a low-dimensional latent space, $\\mathbf{z}_{k}$, utilizing a variational approach. The encoder function is formulated as:\n\n$$\n\\begin{gathered}\nq\\left(\\mathbf{z}_{k} \\mid \\mathbf{x}_{k}, \\mathcal{G S}_{k} ; \\phi_{e n_{k}}\\right)= \\\\\nN\\left(\\mathbf{z}_{k} ; \\operatorname{MLP}_{e n_{k, \\mu}}\\left(\\operatorname{CONCATE}\\left(\\operatorname{GCN}\\left(\\mathbf{x}_{k}, \\mathcal{G}_{k}\\right), \\mathcal{G S}_{k}\\right) ; \\phi_{e n_{k}}\\right)\\right. \\\\\n\\left.\\operatorname{MLP}_{e n_{k, \\sigma^{2}}}\\left(\\operatorname{CONCATE}\\left(\\operatorname{GCN}\\left(\\mathbf{x}_{k}, \\mathcal{G}_{k}\\right), \\mathcal{G S}_{k}\\right) ; \\phi_{e n_{k}}\\right)\\right)\n\\end{gathered}\n$$\n\nHere, $q\\left(\\mathbf{z}_{k} \\mid \\mathbf{x}_{k}, \\mathcal{G} \\mathcal{S}_{k} ; \\phi_{e n_{k}}\\right)$ describes the encoder part of the VAE for the $k^{\\text {th }}$ modality, CONCATE means concatenating two matrices together. It uses a graph convolutional network (GCN) to model the latent space $\\mathbf{z}_{k}$ given the observed data $\\mathbf{x}_{k}$.\n\n$$\n\\mathcal{G}_{k}=\\operatorname{KNN}\\left(\\mathbf{x}_{k}\\right)\n$$\n\nThe graph $\\mathcal{G}_{k}$ is constructed using the k-nearest-neighbor algorithm and serves as the adjacency matrix for the GCN.\n\nThe data likelihoods $p\\left(\\mathbf{x}_{k} \\mid \\mathbf{z}_{k} ; \\theta_{k}\\right)$, which represent the data decoders, are constructed using a multilayer perceptron. The specific formulation of the data likelihood depends on the distribution of the omics data. In the case of count-based scRNA-seq and scATAC-seq data, our model utilizes the negative binomial (NB) distribution. The NB distribution is defined as follows:\n\n$$\n\\begin{gathered}\np\\left(\\mathbf{x}_{k} \\mid \\mathbf{z}_{k} ; \\theta_{k}, \\phi_{d e_{k}}\\right)=\\prod_{i \\in \\mathcal{S}_{k}} \\mathrm{NB}\\left(\\mathbf{x}_{k}^{(i)} ; \\mu^{(i)}, \\boldsymbol{\\theta}^{(i)}, \\phi_{d e_{k}}\\right) \\\\\n\\mathrm{NB}\\left(\\mathbf{x}_{k}^{(i)} ; \\mu^{(i)}, \\boldsymbol{\\theta}^{(i)}, \\phi_{d e_{k}}\\right)= \\\\\n\\frac{\\Gamma\\left(\\mathbf{x}_{k}^{(i)}+\\boldsymbol{\\theta}^{(i)}\\right)}{\\Gamma\\left(\\boldsymbol{\\theta}^{(i)}\\right) \\Gamma\\left(\\mathbf{x}_{k}^{(i)}+1\\right)}\\left(\\frac{\\mu^{(i)}}{\\boldsymbol{\\theta}^{(i)}+\\mu^{(i)}}\\right)^{\\mathbf{x}_{k}^{(i)}}\\left(\\frac{\\boldsymbol{\\theta}^{(i)}}{\\boldsymbol{\\theta}^{(i)}+\\mu^{(i)}}\\right)^{\\boldsymbol{\\theta}^{(i)}}\n\\end{gathered}\n$$\n\nIn the equation above, $\\mu, \\boldsymbol{\\theta} \\in \\mathbb{R}_{+}^{\\left|\\mathcal{S}_{k}\\right|}$ are the mean and dispersion of the negative binomial distribution. Additionally, $\\alpha, \\beta \\in \\mathbb{R}_{+}^{\\left|\\mathcal{S}_{k}\\right|}$ are scaling and bias factors. The Hadamard product is denoted by $\\odot$, Softmax ${ }^{(i)}$ represents the $i^{\\text {th }}$ dimension of the softmax output, and $\\sum_{v \\in \\mathcal{S}_{k}} \\mathbf{x}_{k}^{(v)}$ provides the total count in the cell ensuring the library size of reconstructed data matches the original.\n\n$$\n\\mu^{(i)}=\\operatorname{Softmax}^{(i)}\\left(\\alpha \\odot \\operatorname{MLP}_{d e_{k}}\\left(\\mathbf{z}_{k}, \\phi_{d e_{k}}\\right)+\\beta\\right) \\cdot \\sum_{v \\in \\mathcal{S}_{k}} \\mathbf{x}_{k}^{(v)}\n$$"
    },
    {
      "markdown": "The set of learnable parameters in this context is $\\theta_{k}=\\{\\boldsymbol{\\alpha}, \\boldsymbol{\\beta}, \\boldsymbol{\\theta}\\}$. Meanwhile, $\\phi_{d e_{k}}$ denotes the set of learnable parameters in the multilayer perceptron decoder of the $k^{t h}$ omics layer, $\\mathrm{MLP}_{d e_{k}}$. The flexibility of this model also allows for the incorporation of many other distributions.\n\nFinally, the optimization process aims to maximize the evidence lower bound:\n\n$$\n\\begin{gathered}\np\\left(\\mathbf{z}_{k}\\right)=N\\left(\\mathbf{z}_{k} ;[0]^{m},[1]^{m}\\right) \\\\\n\\mathcal{L}_{\\mathcal{X}}^{\\prime}\\left(\\theta, \\phi_{e n}, \\phi_{d e}\\right)= \\\\\n\\sum_{k=1}^{K} \\mathbb{E}_{\\mathbf{x}_{k} \\sim p_{\\text {data }}\\left(\\mathbf{x}_{k}\\right)}\\left[\\begin{array}{c}\n\\mathbb{E}_{\\mathbf{z}_{k} \\sim q\\left(\\mathbf{z}_{k} \\mid \\mathbf{x}_{k}, \\mathcal{G S}_{k} ; \\phi_{e n_{k}}\\right)} \\log p\\left(\\mathbf{x}_{k} \\mid \\mathbf{z}_{k} ; \\theta_{k}, \\phi_{d e_{k}}\\right) \\\\\n-\\mathrm{KL}\\left(q\\left(\\mathbf{z}_{k} \\mid \\mathbf{x}_{k}, \\mathcal{G S}_{k} ; \\phi_{e n_{k}}\\right) \\mid p\\left(\\mathbf{z}_{k}\\right)\\right)\n\\end{array}\\right]\n\\end{gathered}\n$$\n\nThis equation represents the loss function that the VAE optimizes, where $m$ means the length of latent space vector which is 50 and $\\theta=\\bigcup_{k=1}^{K} \\theta_{k}$, $\\phi_{e n}=\\bigcup_{k=1}^{K} \\phi_{e n_{k}}, \\phi_{d e}=\\bigcup_{k=1}^{K} \\phi_{d e_{k}}$ are the combined sets of encoder and decoder parameters, respectively. It incorporates both the data likelihood and a Kullback-Leibler (KL) divergence term to enforce a meaningful latent space for each of the $K$ modalities.\n\n# Multi-omics data integration, crossmodal generation, and simulation \n\nTo harmonize the latent embeddings produced from different omics modalities, we implement a cross-modal bidirectional alignment method utilizing multilayer perceptrons (MLPs):\n\n$$\n\\begin{gathered}\nq\\left(\\mathbf{z} \\mid \\mathbf{z}_{k} ; \\phi_{a l \\_e n_{k}}\\right)= \\\\\nN\\left(z ; \\mathrm{MLP}_{a l \\_e n_{k}, \\mu}\\left(\\mathbf{z}_{k} ; \\phi_{a l \\_e n_{k}}\\right), \\mathrm{MLP}_{a l \\_e n_{k}, \\sigma^{2}}\\left(\\mathbf{z}_{k} ; \\phi_{a l \\_e n_{k}}\\right)\\right) \\\\\np\\left(\\mathbf{z}_{k} \\mid \\mathbf{z} ; \\phi_{a l \\_d e_{k}}\\right)= \\\\\nN\\left(z_{k} ; \\mathrm{MLP}_{a l \\_d e_{k}, \\mu}\\left(\\mathbf{z} ; \\phi_{a l \\_d e_{k}}\\right), \\mathrm{MLP}_{a l \\_d e_{k}, \\sigma^{2}}\\left(\\mathbf{z} ; \\phi_{a l \\_d e_{k}}\\right)\\right)\n\\end{gathered}\n$$\n\nIn these equations, $\\mathrm{MLP}_{a l \\_e n_{k}}$ denotes the aligner encoder, which converts the latent embedding of the $k^{t h}$ omics layer to a collective latent space. On the other hand, $\\mathrm{MLP}_{a l \\_d e_{k}}$ represents the aligner decoder, which translates the unified latent space embedding back to the latent space of the $k^{t h}$ omics modality. This alignment process is key to converting single-cell multi-omics data into a shared latent representation, denoted as z. By establishing such a common latent space, we facilitate an effective integration of disparate omics data."
    },
    {
      "markdown": "The architecture of scCross operates on a two-step variational autoencoder (VAE) framework to encode omics layers into a merged space. Inverting this methodology, any encoded data in this unified space can be reverted to any particular omics layer's latent representation using a dual-step decoding procedure. The benefit here is the cost-efficiency: rather than requiring $k$ ! distinct encoder/decoder combinations to synchronize any two modalities, this method necessitates only a couple. This streamlined approach facilitates multi-omics simulations across any number of omics layers. Nevertheless, the method's success heavily depends on the precise integration of data in the shared latent space. If discrepancies emerge in this unified space between modalities, the generated data will mirror those differences.\n\nBy leveraging a bi-directional aligner, the cross-modal generation of data from modality $j$ to modality $h$ can be conceptualized with the following equation:\n\n$$\n\\begin{gathered}\n\\mathbf{x}_{h \\_c r o s s} \\sim \\\\\np\\left(\\mathbf{x}_{h}\\left|p\\left(\\mathbf{z}_{h}\\right| q\\left(\\mathbf{z} \\mid q\\left(\\mathbf{z}_{j} \\mid \\mathbf{x}_{j}, \\mathcal{G S}_{j} ; \\phi_{e n_{j}}\\right) ; \\phi_{a l_{-} e n_{j}}\\right) ; \\phi_{a l_{-} d e_{h}}\\right) ; \\theta_{h}, \\phi_{d e_{h}}\\right)\n\\end{gathered}\n$$\n\nwhere $x_{h \\_c r o s s}$ means cross generated $x_{h}$ from $x_{j}$. A visual representation of the described procedure is illustrated in Supplementary Fig. S1a. The process begins with the input vector from modality $j$, which undergoes dimensionality reduction and mapping to the joint latent space $z$. Subsequently, the decoder associated with modality $h$ is employed to reconstruct $z$ into the data vector for modality $h$.\n\nNotably, when $j$ is not equal to $h$, this process facilitates cross-modal generation, allowing the transformation of information from one modality to another. Conversely, when $j$ is equal to $h$, it becomes a mechanism for self-augmentation within the same modality. A visual representation of the described procedure is illustrated in Supplementary Fig. S1b.\n\nSimilarly, single-cell data simulations tailored to specific cellular states for a particular modality $h$ are described as:\n\n$$\n\\begin{gathered}\n\\mathbf{x}_{h_{-} \\text {simu }}^{s} \\sim p\\left(\\mathbf{x}_{h}\\left|p\\left(\\mathbf{z}_{h}\\right| \\mathbf{z}^{s \\prime} ; \\phi_{a l_{-} d e_{h}}\\right) ; \\theta_{h}, \\phi_{d e_{h}}\\right) \\\\\n\\mathbf{z}^{s \\prime} \\sim q\\left(\\mathbf{z} \\mid q\\left(\\mathbf{z}_{1} \\mid \\mathbf{x}_{1}^{s}, \\mathcal{G} \\mathcal{S}_{1}^{s} ; \\phi_{e n_{h}}\\right), \\cdots, q\\left(\\mathbf{z}_{K} \\mid \\mathbf{x}_{K}^{s}, \\mathcal{G} \\mathcal{S}_{K}^{s} ; \\phi_{e n_{h}}\\right) ; \\phi_{a l_{-} e n_{h}}\\right)\n\\end{gathered}\n$$\n\nIn this context, $\\mathbf{x}_{h_{-} \\text {simu }}^{s}$ means simulated data of $h$ modality for specific cellular states, $\\mathbf{x}_{k}^{s}$ pertains to the feature matrices of specific cellular states for $k^{t h}$ modality, $\\mathcal{G S}_{k}^{s}$ is the gene set matrices for $k^{t h}$ modality of specific cellular states, $\\mathbf{z}^{s \\prime}$ represents the sample result of $q\\left(\\mathbf{z} \\mid q\\left(\\mathbf{z}_{1} \\mid \\mathbf{x}_{1}^{s}, \\mathcal{G} \\mathcal{S}_{1}^{s} ; \\phi_{e n_{h}}\\right), \\cdots, q\\left(\\mathbf{z}_{K} \\mid \\mathbf{x}_{K}^{s}, \\mathcal{G} \\mathcal{S}_{K}^{s} ; \\phi_{e n_{h}}\\right) ; \\phi_{a l_{-} e n_{h}}\\right)$. To simulate single-cell multi-omics for a certain cell population. We first sample in the joint latent space to produce latent embedding vectors to represent cells from"
    },
    {
      "markdown": "the specific cell population. The number of samples determines the number of simulated cells. The latent embedding $z_{h}$ will then be converted back into the input vector $x_{h}$ via specific modality-specific decoder. A visual representation of the described procedure is illustrated in Supplementary Fig. S1c.\n\nThe model's fitting procedure seeks to maximize the evidence lower bound expressed as:\n\n$$\n\\begin{gathered}\n\\mathcal{L}_{\\mathcal{X}}(\\theta, \\phi)= \\\\\n\\sum_{k=1}^{K} \\mathbb{E}_{\\mathbf{x}_{k} \\sim p_{\\text {data }}\\left(\\mathbf{x}_{k}\\right)}\\left[\\begin{array}{c}\n\\mathbb{E}_{\\mathbf{z}_{k} \\sim q\\left(\\mathbf{z}_{k} \\mid \\mathbf{x}_{k}, \\mathcal{G S}_{k} ; \\phi_{k}\\right)} \\log p\\left(\\mathbf{x}_{k} \\mid \\mathbf{z}_{k} ; \\theta_{k}\\right) \\\\\n-\\mathrm{KL}\\left(q\\left(\\mathbf{z}_{k} \\mid \\mathbf{x}_{k}, \\mathcal{G S}_{k} ; \\phi_{k}\\right) \\| p\\left(\\mathbf{z}_{k}\\right)\\right) \\\\\n-\\mathrm{KL}\\left(q\\left(\\mathbf{z} \\mid \\mathbf{z}_{k} ; \\phi_{a l \\_e n_{k}}\\right) \\| \\frac{1}{K} \\sum_{l=1}^{K} q\\left(\\mathbf{z}_{l} \\mid \\mathbf{x}_{l}, \\mathcal{G} \\mathcal{S}_{l} ; \\phi_{l}\\right)\\right)\n\\end{array}\\right]\n\\end{gathered}\n$$\n\nHere, the set of encoder and decoder parameters are expressed as $\\phi=\\bigcup_{k=1}^{K}\\left\\{\\phi_{e n_{k}}, \\phi_{d e_{k}}, \\phi_{a l \\_e n_{k}}, \\phi_{a l \\_d e_{k}}\\right\\}$ and $\\theta=\\bigcup_{k=1}^{K} \\theta_{k}$, respectively.\n\n# High-quality data integration and generation via generative adversarial learning \n\nIn the endeavor to ensure precise alignment of diverse omics data, we harness the potential of a generative adversarial learning strategy, a method that showcases its prowess in numerous prior studies [36, 74].\n\nCentral to our model is a discriminator, denoted as $\\mathrm{D}_{z}$, equipped with a $K$ dimensional softmax output, designed specifically for the seamless alignment of various omics layers [35, 75]. Functioning based on the latent space embeddings of cells, denoted as $z, \\mathrm{D}_{z}$ endeavors to identify the omics layer origin of the cells. The training of this discriminator is steered by the minimization of the multi-class classification cross entropy:\n\n$$\n\\begin{gathered}\n\\mathcal{L}_{\\mathrm{D}_{z}}(\\phi, \\psi)= \\\\\n-\\frac{1}{K} \\sum_{k=1}^{K} \\mathbb{E}_{\\mathbf{x}_{k} \\sim p_{\\text {data }}\\left(\\mathbf{x}_{k}\\right)} \\mathbb{E}_{\\mathbf{z}_{k} \\sim q\\left(\\mathbf{z}_{k} \\mid \\mathbf{x}_{k}, \\mathcal{G} \\mathcal{S}_{k} ; \\phi_{e n_{k}}\\right)} \\mathbb{E}_{\\mathbf{z} \\sim q\\left(\\mathbf{z} \\mid \\mathbf{z}_{k} ; \\phi_{a l \\_e n_{k}}\\right)} \\log \\mathrm{D}_{z_{k}}(\\mathbf{z} ; \\psi)\n\\end{gathered}\n$$\n\nHere, $\\mathrm{D}_{z_{k}}$ symbolizes the $k$ th dimension of the discriminator output, while $\\psi$ refers to the suite of parameters, amenable to learning, within the discriminator. Contrarily, the data encoders are trained with the ambition to deceive this discriminator, a strategic move to fortify the alignment of cell embeddings stemming from distinct omics layers.\n\nFurthermore, to bolster the generation of cross-modality data, we present unique discriminators for each modality. This approach aids in refining the reconstruction of the data:"
    },
    {
      "markdown": "$$\n\\begin{gathered}\n\\mathcal{L}_{\\mathrm{D}_{\\mathrm{ge}}}(\\phi, \\theta, \\delta)= \\\\\n-\\frac{1}{K} \\sum_{k=1}^{K} \\mathbb{E}_{\\mathbf{x}_{k} \\sim p_{\\text {data }}\\left(\\mathbf{x}_{k}\\right)} \\mathbb{E}_{\\mathbf{z}_{k} \\sim q\\left(\\mathbf{z}_{k} \\mid \\mathbf{x}_{k}, \\mathcal{G} \\mathcal{S}_{k} ; \\phi_{e n_{k}}\\right)} \\mathbb{E}_{\\mathbf{z} \\sim q\\left(\\mathbf{z} \\mid \\mathbf{z}_{k} ; \\phi_{a l, e n_{k}}\\right)} \\\\\n\\mathbb{E}_{\\hat{\\mathbf{z}}_{k} \\sim p\\left(\\hat{\\mathbf{z}}_{k} \\mid \\mathbf{z} ; \\phi_{a l, d e_{k}}\\right)} \\mathbb{E}_{\\hat{\\mathbf{x}}_{k} \\sim p\\left(\\hat{\\mathbf{x}}_{k} \\mid \\hat{\\mathbf{z}}_{k} ; \\theta_{k}, \\phi_{d e_{k}}\\right)} \\log \\mathrm{D}_{g e_{k}}\\left(\\left(\\mathbf{x}_{k}, \\hat{\\mathbf{x}}_{k}\\right) ; \\delta_{k}\\right) \\\\\n\\mathcal{L}_{\\mathrm{D}}(\\phi, \\psi, \\theta, \\delta)=\\mathcal{L}_{\\mathrm{D}_{\\mathrm{s}}}(\\phi, \\psi)+\\mathcal{L}_{\\mathrm{D}_{\\mathrm{ge}}}(\\phi, \\theta, \\delta)\n\\end{gathered}\n$$\n\nWithin this context, $\\delta=\\bigcup_{k=1}^{K} \\delta_{k}$ encapsulates the collection of learnable parameters in the discriminators. Additionally, $\\mathrm{D}_{g e_{k}}$ represents the output from the $k^{t h}$ discriminator, tailored to reinforce the congruence between the model-generated data $\\hat{\\mathbf{x}}_{k}$ and the real data $\\mathbf{x}_{k}$ for the $k^{t h}$ omics layers. The terms $\\hat{\\mathbf{z}}_{k}$ and $\\hat{\\mathbf{x}}_{k}$ depict the data generated by the aligner decoder and VAE decoder for the $k^{t h}$ modality, respectively.\n\n# Common gene MNN prior to align cells in similar cellular states \n\nFor an effective alignment across various modalities, it is essential to harness common genes that span across modalities, such as gene expression in scRNAseq and gene activity in scATAC-seq and snmC-seq. These genes serve as a pivotal anchor, ensuring consistency and coherence across modalities. While previous omics data integration methods have been successful in achieving a semblance of agreement in the data distribution, the main challenge remains. The true test of alignment is whether embeddings of the same or similar cells across different modalities can be represented identically or similarly within the shared latent space.\n\nHere, the effective multi-modal alignment is achieved by utilizing the Mutual Nearest Neighbors (MNN) approach, which has been shown to effectively align cells of analogous cellular states across different omics data [76]. First, each modality is represented by a matrix, $\\hat{\\mathbf{x}}$, comprised of cells by common genes. Subsequently, the MNN-corrected common genes matrix from each modality is processed using PCA. This produces a common gene prior, $G$, which encapsulates all modalities:\n\n$$\nG=\\operatorname{PCA}\\left(\\operatorname{MNN} . \\operatorname{CORRECT}\\left(\\hat{\\mathbf{x}}_{1}, \\ldots, \\hat{\\mathbf{x}}_{k}\\right)\\right)\n$$\n\nThe alignment loss function, $\\mathcal{L}_{\\mathrm{MNN}}$, is then formulated to minimize the difference between the cosine similarities of the latent embeddings and their corresponding common gene priors:\n\n$$\n\\mathcal{L}_{\\mathrm{MNN}}=\\sum_{h \\neq j}^{K}\\left\\|\\left(z_{h}^{\\prime} \\cdot z_{j}^{\\prime \\top}\\right)-\\lambda_{G}\\left(G_{h} \\cdot G_{j}^{\\top}\\right)\\right\\|^{2}\n$$"
    },
    {
      "markdown": "where $z_{h}^{\\prime} \\sim q\\left(\\mathbf{z} \\mid \\mathbf{z}_{h} ; \\phi_{a l \\_e n_{h}}\\right), z_{j}^{\\prime} \\sim q\\left(\\mathbf{z} \\mid \\mathbf{z}_{j} ; \\phi_{a l_{-} e n_{j}}\\right)$ and $\\lambda_{G}$ are the cell embedding in the shared space for the modality h and j , respectively, generally set to 1 , assists in scaling the difference between the two subtractions. In this equation, $G_{h}$ and $G_{j}$ refer to the common gene priors for modality $h$ and $j$ corresponding to the cells' embedding $z_{h}^{\\prime}$ and $z_{j}^{\\prime}$, respectively.\n\n# Overall training strategy \n\nThe training process for scCross unfolds over two distinct stages. Initially, the primary objective is the isolated training of a Variational Autoencoder (VAE) for each modality. This approach enables us to capture and understand the unique biological information inherent within each modality before proceeding to their integration. The loss function for this first stage is represented as:\n\n$$\n\\max _{\\theta, \\phi, \\psi, \\delta} \\mathcal{L}_{\\mathcal{X}}^{\\prime}\\left(\\theta, \\phi_{e n}, \\phi_{d e}\\right)\n$$\n\nTransitioning to the second stage, the trained VAE models from the preliminary stage serve as a foundation. At this juncture, bi-directional aligners are incorporated, merging the modalities into a unified latent space. Discriminators also come into play during this stage, contributing to the integration of multi-omics data. The associated training losses for this stage are detailed as:\n\n$$\n\\begin{gathered}\n\\min _{\\psi, \\delta} \\lambda_{D} \\mathcal{L}_{\\mathrm{D}}(\\phi, \\psi, \\theta, \\delta) \\\\\n\\max _{\\theta, \\phi, \\psi, \\delta} \\mathcal{L}_{\\mathcal{X}}(\\theta, \\phi)+\\lambda_{D} \\mathcal{L}_{\\mathrm{D}}(\\phi, \\psi, \\theta, \\delta)-\\lambda_{M N N} \\mathcal{L}_{\\mathrm{MNN}}\n\\end{gathered}\n$$\n\nIn these equations, the terms $\\lambda_{D}$ and $\\lambda_{M N N}$ dictate the relative contributions of the discriminator and the common gene MNN prior, respectively. To optimize the training of the scCross model, we utilize the stochastic gradient descent technique. Notably, the RMSprop optimizer, devoid of a momentum term, is selected to enhance stability during adversarial training.\n\n## Cross-modal generation of single-cell data\n\nCross-modal generation of single-cell data serves diverse application scenarios. Primarily, our methodology focuses on training our model using a reference multi-omics dataset encompassing both source and target modalities. Subsequently, this trained model facilitates the generation of the missing modality in a untrained dataset. An alternative application stems from cases with limited data for one modality. To demonstrate our method's prowess, we train it on such partial datasets and leverage this for cross-modal generation.\n\nInitially, we employ the unmatched mouse cortex dataset [35] to train our model. Post this preliminary training, we execute fine-tuning using the scATAC-seq component of the matched brain dataset [31]. We then project the scATAC-seq data from this matched dataset to its corresponding scRNA-seq, using the latter's original data as a benchmark. To showcase the capability of our model in handling datasets with limited modalities, we design a simulation"
    },
    {
      "markdown": "using the matched mouse cortex dataset [31]. The dataset is bifurcated: $20 \\%$ is employed for model training, and the remaining serves for cross-generation and validation. This simulation essentially aims at highlighting how our model, when trained on single-cell multi-omics data with a restricted modality, can upscale and extract valuable insights from the limited data. After the training phase, we employ our model to cross-generate the scRNA-seq data from the available scATAC-seq modality, thereby demonstrating the model's ability to effectively leverage the trained insights from the limited dataset.\n\nThe robustness of our cross-modal generation technique is underscored by a comprehensive downstream analysis. The generated data is first clustered using the Leiden algorithm [77]. With the assistance of Scanpy [9], we discern the top 100 differentially expressed genes (DEgenes) for each cell type in both the generated and original scRNA-seq datasets. These DEgenes not only facilitate the transfer of cell type annotations from the original to the generated datasets but also serve as potential biomarker genes. Cell types with the majority of shared genes are aligned. Pathway enrichment further enriches our validation process. For each cell type, pathway associations rooted in the top 100 DEgenes are pinpointed via the ToppGene portal [34]. Concurrently, to decipher the intricate interplay between cells, CellChat [78] is employed for detailed cell-cell interaction analysis. To gauge the accuracy and resemblance between our generated and the original scRNA-seq data, we deploy an array of validation metrics. Pearson correlation [79] coefficients provide insights into decomposition, cell-cell interactions, and pathway analyses.\n\n# Single cell multi-omic data simulation. \n\nOur model's training is grounded on the matched mouse cortex dataset [31]. Specifically, for our simulation exercise, we choose the cellular type Ast as the target cellular status. Leveraging our model, we generate data sets at one-fold (1X) and five-fold (5X) of the original count of Ast cells' single-cell multiomics data. These data sets are subsequently visualized using both Scanpy [9] (v.1.8.2) and epiScanpy [66].\n\nWith the assistance of Scanpy [9], we discern the top 100 differentially expressed genes (DEgenes) for Ast cells in both the 5 X simulated and original scRNA-seq data. GO and pathway enrichment in both data further enriches our validation process. GO and pathway associations rooted in the top 100 DEgenes are pinpointed via the ToppGene portal [34].\n\nTo assess the level of correlation between the differential gene signatures of the original Ast cells and the simulated 1X Ast data against a background, we employ the RRHO methodology [80].\n\nTo further harness and validate the simulated 1X Ast single-cell multiomics data, we input it into various integration techniques, notably our scCross and the externally established scglue [36]. The outcomes from these integrative analyses serve to demonstrate the adeptness of the scCross model in generating high-quality matched single-cell multi-omics data for specific cellular states,"
    },
    {
      "markdown": "which can be potentially leveraged to benchmark other single-cell multi-omics data integration methods.\n\n# In-silico perturbations and explorations \n\nIn this section, we aim to showcase the in-silico perturbation pipeline of scCross, using the single-cell multi-omics dataset of COVID-19 as an exemplar. This dataset, comprising both scRNA-seq and ADT data (CITE-Seq), serves as a suitable backdrop for our demonstration, given its comprehensive nature that facilitates deeper insights into the disease [17]. The preliminary step in our pipeline involves visualizing the scRNA-seq data of the COVID-19 dataset. We utilized the Scanpy package for this purpose [9] (v.1.8.2), generating a UMAP plot depicted in Fig. 4. Concurrently, the same package aided in the identification of the highly variable genes. With these genes in focus, the scCross model, once trained on matched scRNA-seq and single-cell protein datasets [17], embarked on the in-silico perturbation process. Each highly variable gene underwent a virtual perturbation on COVID-19 patient cells, and the model gauged and scored its influence on bridging the latent space gap between contrasting disease states, namely healthy and COVID-19 conditions. The culmination of this process results in a ranked list of genes, with top scorers spotlighted as potential RNA bio-markers for COVID-19.\n\nTo further visualize the ramifications of these perturbations, we employed the Seaborn Python package [81] (v.0.11.2). This involved computing the cosine distances in the latent space between COVID-19 and healthy cells during both upward and downward perturbations (scaled by $\\pm 1$ in log space) of each gene. The resultant visualization, available in Fig. 4b, exclusively displays genes that effectively narrowed the latent space divide.\n\nTo further analyze the genes obtained from perturbation, we perform pathway analysis using the ToppGene website [34] with the down-perturbed genes that make the latent space closer. Additionally, we use the t-test [82] and Wilcoxon [83] tests, which are general methods for differential gene expression analysis, to generate the same number of DEgenes as our approach between COVID-19 patient cells and healthy cells. The pathway analysis is also performed using the ToppGene website [34]. We select several pathways highly associated with COVID-19 to demonstrate the effectiveness of our approach in identifying disease biomarkers via in-silico perturbations (Fig. 4c).\n\nFurthermore, we execute cross-generation of single-cell protein data using the scRNA-seq dataset. For this procedure, we perturb the relevant genes identified in the prior analysis within the healthy scRNA-seq data. This gene perturbation leads to the creation of perturbed COVID-19 scRNA-seq data, which is subsequently harnessed for cross-generation in order to produce a generated dataset representing single-cell COVID-19 protein data.\n\nTo evaluate the correlation between the similarity of differential protein expressions in the original COVID-19 protein data and the perturbed, generated COVID-19 protein data against the backdrop of healthy protein data, we employ RRHO [80] as a visualization technique."
    },
    {
      "markdown": "In order to validate the degree of resemblance between the up-perturbed and cross-generated single-cell protein data and the original dataset, we leverage the Scanpy package [9] (v.1.8.2). This comparison is performed within a comprehensive landscape encompassing all cells (Fig. 4f). Pearson correlation [79], along with its associated $p$-values, is adopted to quantitatively affirm the similarity between these datasets.\n\n# Single cell multi-omics data integration \n\nWe evaluate the agreement between the cell-type labels and the Leiden algorithm [77] clusters obtained from the integrated dataset for each omic separately using Normalized Mutual Information (NMI). NMI measures the overlap between two clusterings, with scores ranging from 0 (no overlap) to 1 (perfect agreement). We perform the Leiden clustering [77] with a resolution of 1 for all methods and datasets. We use the scikit-learn [84] (v.0.22.1) implementation of NMI.\n\nThe Rand index is another metric that compares the overlap of two clusterings. We compare the cell-type labels with the Leiden clustering [77] computed on the integrated dataset for each omic separately. An ARI of 0 or 1 corresponds to uncorrelated clustering or a perfect match, respectively. We perform the Leiden clustering [77] with a resolution of 1 for all methods and datasets. We use the scikit-learn [84] (v.0.22.1) implementation of the ARI.\n\nIn our work, there are two kinds of ASW. One is cell type ASW, another is omics layer ASW. Cell type ASW is used to evaluate the cell type resolution. It can metrix model's clustering ability. Cell typ ASW is defined as in a recent benchmark study $[36,51]$ :\n\n$$\n\\text { cell type ASW }=\\frac{1}{2}\\left(\\frac{\\sum_{i=1}^{N} s_{\\text {cell type }}^{(i)}}{N}+1\\right)\n$$\n\nwhere $s_{\\text {cell type }}^{(i)}$ is the cell type silhouette width for the $i^{\\text {th }}$ cell, and $N$ is the total number of cells. Cell type ASW has a range of 0 to 1 . Higher values indicate better cell type clustering resolution.\n\nOmics layer ASW is used to evaluate the integration mixing ability among omics layers. It is defined as in a recent benchmark study[36, 51]:\n\n$$\n\\begin{aligned}\n& \\text { omics layer ASW }=\\frac{1}{M} \\sum_{j=1}^{M} \\text { omics layer } \\mathrm{ASW}_{\\mathrm{j}} \\\\\n& \\text { omics layer } \\mathrm{ASW}_{\\mathrm{j}}=\\frac{1}{N_{j}} \\sum_{i=1}^{N_{j}} 1-\\left|s_{\\text {omics layer }}^{(i)}\\right|\n\\end{aligned}\n$$\n\nwhere $s_{\\text {omics layer }}^{(i)}$ is the omics layer silhouette width for the $i^{\\text {th }}$ cell, $N_{j}$ is the number of cells in cell type $j$, and $M$ is the total number of cell types. Omics"
    },
    {
      "markdown": "layer ASW has a range of 0 to 1 . Higher values indicate better integration mixing ability.\n\nThe graph connectivity metric $[36,51]$ is used to estimate the ability to mixing different omics data:\n\n$$\n\\mathrm{GC}=\\frac{1}{M} \\sum_{j=1}^{M} \\frac{\\left|\\mathrm{LCC}_{j}\\right|}{N_{j}}\n$$\n\nwhere $\\mathrm{LCC}_{j}$ is the number of cells in largest connected component of the cell k-nearest neighbors graph $(\\mathrm{K}=15)$ for cell type $j, N_{j}$ is the number of cells in cell type $j$ and $M$ is the total number of cell types. Graph connectivity has a range of 0 to 1 . Higher values of graph connectivity indicate better mixing ability.\n\nThe FOSCTTM metric $[36,52]$ is used to evaluate the single-cell level alignment accuracy. It is computed on two datasets with known cell-to-cell pairings. Suppose that each dataset contains $N$ cells, and that the cells are sorted in the same order, that is, the $i^{t h}$ cell in the first dataset is paired with the $i^{t h}$ cell in the second dataset. Denote $x$ and $y$ as the cell embeddings of the first and second dataset, respectively. The FOSCTTM is then defined as:\n\n$$\n\\begin{gathered}\n\\text { FOSCTTM }=\\frac{1}{2 N}\\left(\\sum_{i=1}^{N} \\frac{n_{1}^{(i)}}{N}+\\sum_{i=1}^{N} \\frac{n_{2}^{(i)}}{N}\\right) \\\\\nn_{1}^{(i)}=\\left|\\left\\{t \\mid d\\left(\\mathbf{x}^{(t)}, \\mathbf{y}^{(i)}\\right)<d\\left(\\mathbf{x}^{(i)}, \\mathbf{y}^{(i)}\\right)\\right\\}\\right| \\\\\nn_{2}^{(i)}=\\left|\\left\\{t \\mid d\\left(\\mathbf{x}^{(i)}, \\mathbf{y}^{(t)}\\right)<d\\left(\\mathbf{x}^{(i)}, \\mathbf{y}^{(i)}\\right)\\right\\}\\right|\n\\end{gathered}\n$$\n\nwhere $n_{1}^{(i)}$ and $n_{2}^{(i)}$ represent the number of cells in the first and second dataset that are closer to the $i^{t h}$ cell than their true matches in the opposite dataset. The Euclidean distance, denoted as $d$, is used to calculate the distance between cells. FOSCTTM ranges from 0 to 1 , and lower values indicate higher accuracy.\n\nTo train the atlas level large scale data, we made several adaptations to our training process. We employed the Leiden algorithm [77] to cluster the original scRNA-seq and scATAC-seq data and obtained the cluster numbers. Then, we aggregated and averaged the cells within each cluster to create a meta cell representing that cluster. The common gene MNN prior for cells within each cluster was calculated based on these meta cells. To boost training efficiency, we utilized the MNN loss, calculated based on the meta cells instead of all cells, for the second stage of fine-tuning scCross (loss defined in eqn.22). Finally, we utilized Scanpy [9] (v.1.8.2) to generate the UMAP visualization.\n\nIn the triple omics integration, as the snmC-seq data's distribution is close to zero-inflated log-normal (ZILN) distribution, we use that distribution in our data decoder:\n\n$$\np\\left(\\mathbf{x}_{k} \\mid \\mathbf{z}_{k} ; \\theta_{k}, \\phi_{d e_{k}}\\right)=\\prod_{i \\in \\mathcal{S}_{k}} \\operatorname{ZILN}\\left(\\mathbf{x}_{k}^{(i)} ; \\boldsymbol{\\mu}^{(i)}, \\boldsymbol{\\sigma}^{(i)}, \\delta^{(i)}, \\phi_{d e_{k}}\\right)\n$$"
    },
    {
      "markdown": "$$\n\\begin{gathered}\n\\operatorname{ZILN}\\left(\\mathbf{x}_{k}^{(i)} ; \\mu^{(i)}, \\sigma^{(i)}, \\delta^{(i)}, \\phi_{d e_{k}}\\right)= \\\\\n\\left\\{\\begin{array}{l}\n\\frac{1-\\delta^{(i)}}{\\mathbf{x}_{k}^{(i)} \\sigma^{(i)} \\sqrt{2 \\pi}} \\exp \\left(-\\frac{\\left(\\log \\mathbf{x}_{k}^{(i)}-\\mu^{(i)}\\right)^{2}}{2 \\sigma^{(i)^{2}}}\\right), \\mathbf{x}_{k}^{(i)}>0 \\\\\n\\delta^{(i)}, \\\\\n\\mathbf{x}_{k}^{(i)}=0\n\\end{array}\\right. \\\\\n\\mu^{(i)}=\\alpha \\odot \\operatorname{MLP}_{d e_{k}}\\left(\\mathbf{z}_{k}, \\phi_{d e_{k}}\\right)+\\beta\n\\end{gathered}\n$$\n\nIn the equation above, $\\mu \\in \\mathbb{R}^{\\left|\\mathcal{S}_{k}\\right|}, \\sigma \\in \\mathbb{R}_{+}^{\\left|\\mathcal{S}_{k}\\right|}, \\delta \\in(0,1)^{\\left|\\mathcal{S}_{k}\\right|}$ are the logscale mean, log-scale standard deviation and zero-inflation parameters of the zero-inflated log-normal distribution, respectively. Additionally, $\\alpha \\in \\mathbb{R}_{+}^{\\left|\\mathcal{S}_{k}\\right|}, \\beta \\in \\mathbb{R}^{\\left|\\mathcal{S}_{k}\\right|}$ are scaling and bias factors. The set of learnable parameters in this context is $\\theta_{k}=\\{\\sigma, \\delta, \\alpha, \\beta\\}$ and $\\phi_{d e_{k}}$.\n\nTo further verify our model's triple omics integration ability, we employ a nearest neighbor-based label transfer approach using the ATAC-seq dataset as the reference and test the cell similarity of cells with the same label in different omics by markers. For each cell in the scRNA-seq and snmC-seq datasets, we identify the five closest neighbors in the ATAC-seq dataset within the shared embedding space. We achieve label assignment through a majority voting system based on these neighbors. To confirm the accuracy of our alignment, we test for significant overlap in cell type marker genes across modalities. Initially, we convert features from all omics layers into gene-centric representations with geneactivity function in epiScanpy [66]. Subsequently, we pinpoint cell type markers for each omics layer. We adopt a one-versus-rest Wilcoxon rank-sum test to ascertain these markers, using a significance threshold of FDR $<0.05$. The significance of overlapping markers among the three omics datasets is gauged using the three-way Fisher's exact test [64]. Visualization of the significant markers, as well as a comparison of FDR with the scglue method [36], is facilitated by the UpSet plot [85].\n\n# Batch effect correction \n\nBatch effect intro modalities can be a hard problem to resolve when integrating multi-modal datasets. Assuming $b \\in 1,2, \\ldots, B$ is batch index, where $B$ is the total number of batches in all modalities. Here, we utilize the batch effect correction method in [36], which is introduce batch-specific parameters in VAE data decoder:\n\n$$\np\\left(\\mathbf{x}_{k} \\mid \\mathbf{z}_{k}, b ; \\theta_{k}, \\phi_{d e_{k}}\\right)=\\prod_{i \\in \\mathcal{S}_{k}} \\mathrm{NB}\\left(\\mathbf{x}_{k}^{(i)} ; \\mu^{(i)}, \\theta_{b}^{(i)}, \\phi_{d e_{k}}\\right)\n$$"
    },
    {
      "markdown": "$$\n\\begin{gathered}\n\\mathrm{NB}\\left(\\mathbf{x}_{k}^{(i)} ; \\mu^{(i)}, \\boldsymbol{\\theta}_{b}^{(i)}, \\phi_{d e_{k}}\\right)= \\\\\n\\frac{\\Gamma\\left(\\mathbf{x}_{k}^{(i)}+\\boldsymbol{\\theta}_{b}^{(i)}\\right)}{\\Gamma\\left(\\boldsymbol{\\theta}_{b}^{(i)}\\right) \\Gamma\\left(\\mathbf{x}_{k}^{(i)}+1\\right)}\\left(\\frac{\\mu^{(i)}}{\\boldsymbol{\\theta}_{b^{(i)}}+\\mu^{(i)}}\\right)^{\\mathbf{x}_{k}^{(i)}}\\left(\\frac{\\boldsymbol{\\theta}_{b}^{(i)}}{\\boldsymbol{\\theta}_{b}^{(i)}+\\mu^{(i)}}\\right)^{\\boldsymbol{\\theta}_{b}^{(i)}} \\\\\n\\mu^{(i)}=\\operatorname{Softmax}^{(1)}\\left(\\boldsymbol{\\alpha}_{b} \\odot \\operatorname{MLP}_{d e_{k}}\\left(\\mathbf{z}_{k}, \\phi_{d e_{k}}\\right)+\\boldsymbol{\\beta}_{b}\\right) \\cdot \\sum_{v \\in \\mathcal{S}_{k}} \\mathbf{x}_{k}^{(v)}\n\\end{gathered}\n$$\n\nwhere $\\boldsymbol{\\theta} \\in \\mathbb{R}_{+}^{B *\\left|\\mathcal{S}_{k}\\right|}, \\boldsymbol{\\alpha} \\in \\mathbb{R}_{+}^{B *\\left|\\mathcal{S}_{k}\\right|}, \\boldsymbol{\\beta} \\in \\mathbb{R}^{B *\\left|\\mathcal{S}_{k}\\right|}$, and $\\boldsymbol{\\theta}_{b}, \\boldsymbol{\\alpha}_{b}, \\boldsymbol{\\beta}_{b}$ are the $b^{\\text {th }}$ row of $\\boldsymbol{\\theta}, \\boldsymbol{\\alpha}, \\boldsymbol{\\beta}$. Other VAE decoders in different distribution can also be extended in similar ways.\n\n# Implementation details \n\nIn our model, we employ linear dimensionality reduction techniques such as PCA (Principal Component Analysis) [65] for scRNA-seq data, gene information, and gene set information. For scATAC-seq data, we use LSI (Latent Semantic Indexing) [67] as the first transformation layers of the data encoders (while the decoders were still fitted in the original feature spaces). These canonical methods effectively reduce the model size and allow for modular input, enabling the use of advanced dimensionality reduction or batch effect correction methods as preprocessing steps for scCross integration.\n\nTo balance the losses in our model, we determine the value of lambda $(\\lambda)$ for loss balancing. The lambda selection process can be found in Supplementary Fig. S13a-b (please refer to the supplementary materials of the corresponding publication).\n\nOur model consists of two steps of training. In the first step, each omic layer's VAE is trained separately for each modality. This step aims to obtain well-preserved bio-information in the latent embeddings (represented as $\\mathbf{z}_{k}$ ) without interference from other modalities. In the second step, integration is performed by training all modalities' $\\mathbf{z}_{k}$ together to achieve a unified latent space represented as z. This step enables the integration of different omic layers in the scCross model. The set of the best hyperparameters is presented in Supplementary Fig. S13a-b.\n\n## Data availability\n\nThe datasets used in this study have been obtained from various sources. The matched mouse cortex dataset [31] is obtained from Gene Expression Omnibus (GEO) repository under the following accession numbers GSE126074. The matched mouse atherosclerotic plaque immune cells dataset is got from Gene Expression Omnibus (GEO) repository under the following accession numbers GSE240753. The matched mouse lymphonodus dataset [50] is downloaded"
    },
    {
      "markdown": "from Gene Expression Omnibus (GEO) repository under the following accession numbers GSE140203. The unmatched mouse cortex scRNA-seq dataset [35] is publicly available in the website at dropviz.org. The unmatched mouse cortex snmC-seq dataset [18] is publicly available and obtained from the Gene Expression Omnibus (GEO) repository under the following accession numbers GSE97179. The unmatched mouse cortex scATAC-seq dataset is downloaded from the 10X Genomics website at support.10xgenomics.com. The human cell atlas dataset $[54,55]$ is obtained from Gene Expression Omnibus (GEO) repository under the following accession numbers GSE156793 for scRNA-seq and GSE149683 for scATAC-seq. Lastly, the COVID-19 dataset [17] used in the study is obtained from the website at covid19.cog.sanger.ac.uk. Detailed average benchmarking information for our integration evaluation across methods section is available in Supplementary Data S1.\n\n# Code availability \n\nThe scCross framework is implemented in the \"scCross\" Python package, which is available at https://github.com/mcgilldinglab/scCross.\n\n## Acknowledgments\n\nThis work is partially supported by grants awarded to JD from the Canadian Institutes of Health Research (CIHR) (Grant No. PJT-180505), the Fonds de recherche du Québec - Santé (FRQS) (Grant Nos. 295298 \\& 295299), and the Natural Sciences and Engineering Research Council of Canada (NSERC) (Grant No. RGPIN2022-04399), along with support from the Meakins-Christie Chair in Respiratory Research. The study also benefits from partial funding to HW through grants from the National Natural Science Foundation of China (Grant Nos. 62272278 \\& 61972322), the National Key Research and Development Program (Grant No. 2021YFF0704103), and the Fundamental Research Funds of Shandong University. Additionally, KKM has received partial support for this research from the CIHR (Grant No. PJT-166142).\n\n## Author contributions\n\nJD and XY conceived the study; JD, XY and HW designed the analyses and experiments; XY performed the analyses, experiments and visualizations; XY and JD prepared the first draft; JD, XY, HW and KKM reviewed and edited the draft; KKM contributed the data GSE240753.\n\n## Competing interests\n\nThe authors declare no competing interests."
    },
    {
      "markdown": "# References \n\n[1] Xue, R., Zhang, Q., Cao, Q., Kong, R., Xiang, X., Liu, H., Feng, M., Wang, F., Cheng, J., Li, Z., et al.: Liver tumour immune microenvironment subtypes and neutrophil heterogeneity. Nature, 1-7 (2022)\n[2] Blanchard, J.W., Akay, L.A., Davila-Velderrain, J., von Maydell, D., Mathys, H., Davidson, S.M., Effenberger, A., Chen, C.-Y., ManerSmith, K., Hajjar, I., et al.: Apoe4 impairs myelination via cholesterol dysregulation in oligodendrocytes. Nature, 1-11 (2022)\n[3] Niño, J.L.G., Wu, H., LaCourse, K.D., Kempchinsky, A.G., Baryiames, A., Barber, B., Futran, N., Houlton, J., Sather, C., Sicinska, E., et al.: Effect of the intratumoral microbiota on spatial and cellular heterogeneity in cancer. Nature, 1-8 (2022)\n[4] Finkbeiner, C., Ortuño-Lizarán, I., Sridhar, A., Hooper, M., Petter, S., Reh, T.A.: Single-cell atac-seq of fetal human retina and stem-cell-derived retinal organoids shows changing chromatin landscapes during cell fate acquisition. Cell Reports 38(4), 110294 (2022)\n[5] Lawson, D.A., Bhakta, N.R., Kessenbrock, K., Prummel, K.D., Yu, Y., Takai, K., Zhou, A., Eyob, H., Balakrishnan, S., Wang, C.-Y., et al.: Single-cell analysis reveals a stem-cell program in human metastatic breast cancer cells. Nature 526(7571), 131-135 (2015)\n[6] Griffiths, J.A., Scialdone, A., Marioni, J.C.: Using single-cell genomics to understand developmental processes and cell fate decisions. Molecular systems biology 14(4), 8046 (2018)\n[7] Usoskin, D., Furlan, A., Islam, S., Abdo, H., Lönnerberg, P., Lou, D., Hjerling-Leffler, J., Haeggström, J., Kharchenko, O., Kharchenko, P.V., et al.: Unbiased classification of sensory neuron types by large-scale singlecell rna sequencing. Nature neuroscience 18(1), 145-153 (2015)\n[8] Heath, J.R., Ribas, A., Mischel, P.S.: Single-cell analysis tools for drug discovery and development. Nature reviews Drug discovery 15(3), 204216 (2016)\n[9] Wolf, F.A., Angerer, P., Theis, F.J.: Scanpy: large-scale single-cell gene expression data analysis. Genome biology 19, 1-5 (2018)\n[10] Bravo González-Blas, C., Minnoye, L., Papasokrati, D., Aibar, S., Hulselmans, G., Christiaens, V., Davie, K., Wouters, J., Aerts, S.: cistopic: cis-regulatory topic modeling on single-cell atac-seq data. Nature methods 16(5), 397-400 (2019)"
    },
    {
      "markdown": "[11] Stuart, T., Srivastava, A., Madad, S., Lareau, C.A., Satija, R.: Single-cell chromatin state analysis with signac. Nature methods 18(11), 1333-1341 (2021)\n[12] Picelli, S., Björklund, Å.K., Faridani, O.R., Sagasser, S., Winberg, G., Sandberg, R.: Smart-seq2 for sensitive full-length transcriptome profiling in single cells. Nature methods 10(11), 1096-1098 (2013)\n[13] Zheng, G.X., Terry, J.M., Belgrader, P., Ryvkin, P., Bent, Z.W., Wilson, R., Ziraldo, S.B., Wheeler, T.D., McDermott, G.P., Zhu, J., et al.: Massively parallel digital transcriptional profiling of single cells. Nature communications 8(1), 1-12 (2017)\n[14] Cusanovich, D.A., Daza, R., Adey, A., Pliner, H.A., Christiansen, L., Gunderson, K.L., Steemers, F.J., Trapnell, C., Shendure, J.: Multiplex single-cell profiling of chromatin accessibility by combinatorial cellular indexing. Science 348(6237), 910-914 (2015)\n[15] Chen, X., Miragaia, R.J., Natarajan, K.N., Teichmann, S.A.: A rapid and robust method for single cell chromatin accessibility profiling. Nature communications 9(1), 1-9 (2018)\n[16] Luo, C., Keown, C.L., Kurihara, L., Zhou, J., He, Y., Li, J., Castanon, R., Lucero, J., Nery, J.R., Sandoval, J.P., et al.: Single-cell methylomes identify neuronal subtypes and regulatory elements in mammalian cortex. Science 357(6351), 600-604 (2017)\n[17] Stephenson, E., Reynolds, G., Botting, R.A., Calero-Nieto, F.J., Morgan, M.D., Tuong, Z.K., Bach, K., Sungnak, W., Worlock, K.B., Yoshida, M., et al.: Single-cell multi-omics analysis of the immune response in covid-19. Nature medicine 27(5), 904-916 (2021)\n[18] Mulqueen, R.M., Pokholok, D., Norberg, S.J., Torkenczy, K.A., Fields, A.J., Sun, D., Sinnamon, J.R., Shendure, J., Trapnell, C., O’Roak, B.J., et al.: Highly scalable generation of dna methylation profiles in single cells. Nature biotechnology 36(5), 428-431 (2018)\n[19] Hickey, J.W., Becker, W.R., Nevins, S.A., Horning, A., Perez, A.E., Zhu, C., Zhu, B., Wei, B., Chiu, R., Chen, D.C., et al.: Organization of the human intestine at single-cell resolution. Nature 619(7970), 572-584 (2023)\n[20] Xiong, X., James, B.T., Boix, C.A., Park, Y.P., Galani, K., Victor, M.B., Sun, N., Hou, L., Ho, L.-L., Mantero, J., et al.: Epigenomic dissection of alzheimer's disease pinpoints causal variants and reveals epigenome erosion. Cell 186(20), 4422-4437 (2023)"
    },
    {
      "markdown": "[21] Meier, A.B., Zawada, D., De Angelis, M.T., Martens, L.D., Santamaria, G., Zengerle, S., Nowak-Imialek, M., Kornherr, J., Zhang, F., Tian, Q., et al.: Epicardioid single-cell genomics uncovers principles of human epicardium biology in heart development and disease. Nature Biotechnology, $1-14(2023)$\n[22] Ma, S., Chi, X., Cai, Y., Ji, Z., Wang, S., Ren, J., Liu, G.-H.: Decoding aging hallmarks at the single-cell level. Annual Review of Biomedical Data Science 6 (2023)\n[23] Bülow, R.D., Hölscher, D.L., Costa, I.G., Boor, P.: Extending the landscape of omics technologies by pathomics. npj Systems Biology and Applications 9(1), 38 (2023)\n[24] Bärthel, S., Falcomatà, C., Rad, R., Theis, F.J., Saur, D.: Single-cell profiling to explore pancreatic cancer heterogeneity, plasticity and response to therapy. Nature Cancer, 1-14 (2023)\n[25] Wang, R.-S., Maron, B.A., Loscalzo, J.: Multiomics network medicine approaches to precision medicine and therapeutics in cardiovascular diseases. Arteriosclerosis, Thrombosis, and Vascular Biology 43(4), 493-503 (2023)\n[26] Fetahu, I.S., Esser-Skala, W., Dnyansagar, R., Sindelar, S., Rifatbegovic, F., Bileck, A., Skos, L., Bozsaky, E., Lazic, D., Shaw, L., et al.: Singlecell transcriptomics and epigenomics unravel the role of monocytes in neuroblastoma bone marrow metastasis. Nature Communications 14(1), 3620 (2023)\n[27] Chiou, K.L., Huang, X., Bohlen, M.O., Tremblay, S., DeCasien, A.R., O'Day, D.R., Spurrell, C.H., Gogate, A.A., Zintel, T.M., Unit, C.B.R., et al.: A single-cell multi-omic atlas spanning the adult rhesus macaque brain. Science Advances 9(41), 1914 (2023)\n[28] Yuan, J., Zhao, K., Tan, X., Xue, R., Zeng, Y., Ratti, C., Trivedi, P.: Perspective on the development of synthetic microbial community (syncom) biosensors. Trends in Biotechnology (2023)\n[29] Burge, J.E., Brown, D.C.: Seurat: integrated rationale management. In: Proceedings of the 30th International Conference on Software Engineering, pp. 835-838 (2008)\n[30] Chen, H., Lareau, C., Andreani, T., Vinyard, M.E., Garcia, S.P., Clement, K., Andrade-Navarro, M.A., Buenrostro, J.D., Pinello, L.: Assessment of computational methods for the analysis of single-cell atac-seq data. Genome biology 20(1), 1-25 (2019)"
    },
    {
      "markdown": "[31] Chen, S., Lake, B.B., Zhang, K.: High-throughput sequencing of the transcriptome and chromatin accessibility in the same cell. Nature biotechnology 37(12), 1452-1457 (2019)\n[32] McInnes, L., Healy, J., Melville, J.: Umap: Uniform manifold approximation and projection for dimension reduction. arXiv preprint arXiv:1802.03426 (2018)\n[33] Armingol, E., Officer, A., Harismendy, O., Lewis, N.E.: Deciphering cell-cell interactions and communication from gene expression. Nature Reviews Genetics 22(2), 71-88 (2021)\n[34] Chen, J., Bardes, E.E., Aronow, B.J., Jegga, A.G.: Toppgene suite for gene list enrichment analysis and candidate gene prioritization. Nucleic acids research 37 (suppl_2), 305-311 (2009)\n[35] Saunders, A., Macosko, E.Z., Wysoker, A., Goldman, M., Krienen, F.M., de Rivera, H., Bien, E., Baum, M., Bortolin, L., Wang, S., et al.: Molecular diversity and specializations among the cells of the adult mouse brain. Cell 174(4), 1015-1030 (2018)\n[36] Cao, Z.-J., Gao, G.: Multi-omics single-cell data integration and regulatory inference with graph-linked embedding. Nature Biotechnology, 1-9 (2022)\n[37] Cao, K., Gong, Q., Hong, Y., Wan, L.: A unified computational framework for single-cell data integration with optimal transport. Nature Communications 13(1), 7419 (2022)\n[38] Li, G., Fu, S., Wang, S., Zhu, C., Duan, B., Tang, C., Chen, X., Chuai, G., Wang, P., Liu, Q.: A deep generative model for multi-view profiling of single-cell rna-seq and atac-seq data. Genome biology 23(1), 1-23 (2022)\n[39] Koehler, R.C., Roman, R.J., Harder, D.R.: Astrocytes and the regulation of cerebral blood flow. Trends in neurosciences 32(3), 160-169 (2009)\n[40] Pardridge, W.M.: Drug transport across the blood-brain barrier. Journal of cerebral blood flow \\& metabolism 32(11), 1959-1972 (2012)\n[41] Sweeney, M.D., Ayyadurai, S., Zlokovic, B.V.: Pericytes of the neurovascular unit: key functions and signaling pathways. Nature neuroscience 19(6), 771-783 (2016)\n[42] Xu, Z.-S., Shu, T., Kang, L., Wu, D., Zhou, X., Liao, B.-W., Sun, X.-L., Zhou, X., Wang, Y.-Y.: Temporal profiling of plasma cytokines, chemokines and growth factors from mild, severe and fatal covid-19 patients. Signal transduction and targeted therapy 5(1), 100 (2020)"
    },
    {
      "markdown": "[43] Chua, R.L., Lukassen, S., Trump, S., Hennig, B.P., Wendisch, D., Pott, F., Debnath, O., Thürmann, L., Kurth, F., Völker, M.T., et al.: Covid19 severity correlates with airway epithelium-immune cell interactions identified by single-cell analysis. Nature biotechnology 38(8), 970-979 (2020)\n[44] Lee, J.S., Park, S., Jeong, H.W., Ahn, J.Y., Choi, S.J., Lee, H., Choi, B., Nam, S.K., Sa, M., Kwon, J.-S., et al.: Immunophenotyping of covid-19 and influenza highlights the role of type i interferons in development of severe covid-19. Science immunology 5(49), 1554 (2020)\n[45] Vinken, M.: Covid-19 and the liver: an adverse outcome pathway perspective. Toxicology 455, 152765 (2021)\n[46] Rex, D., Dagamajalu, S., Kandasamy, R.K., Raju, R., Prasad, T.K.: Sars-cov-2 signaling pathway map: A functional landscape of molecular mechanisms in covid-19. Journal of Cell Communication and Signaling 15(4), 601-608 (2021)\n[47] Rus, M.A., Willighagen, E., Talih, N., Summer-Kutmon, M., Ehrhart, F., Weitz, E., Pham, N., Willighagen, L., et al.: Sars-cov-2 innate immunity evasion and cell-specific immune response (2023)\n[48] Steinley, D.: Properties of the hubert-arable adjusted rand index. Psychological methods 9(3), 386 (2004)\n[49] Strehl, A., Ghosh, J.: Cluster ensembles - a knowledge reuse framework for combining multiple partitions. Journal of machine learning research 3(Dec), 583-617 (2002)\n[50] Ma, S., Zhang, B., LaFave, L.M., Earl, A.S., Chiang, Z., Hu, Y., Ding, J., Brack, A., Kartha, V.K., Tay, T., et al.: Chromatin potential identified by shared single-cell profiling of rna and chromatin. Cell 183(4), 1103-1116 (2020)\n[51] Luecken, M.D., Büttner, M., Chaichoompu, K., Danese, A., Interlandi, M., Müller, M.F., Strobl, D.C., Zappia, L., Dugas, M., Colomé-Tatché, M., et al.: Benchmarking atlas-level data integration in single-cell genomics. Nature methods 19(1), 41-50 (2022)\n[52] Singh, R., Demetci, P., Bonora, G., Ramani, V., Lee, C., Fang, H., Duan, Z., Deng, X., Shendure, J., Disteche, C., et al.: Unsupervised manifold alignment for single-cell multi-omics data. In: Proceedings of the 11th ACM International Conference on Bioinformatics, Computational Biology and Health Informatics, pp. 1-10 (2020)\n[53] Cui, Z., Liao, Y., Xu, T., Wang, Y.: Geneformer: Learned gene"
    },
    {
      "markdown": "compression using transformer-based context modeling. arXiv preprint arXiv:2212.08379 (2022)\n[54] Cao, J., O'Day, D.R., Pliner, H.A., Kingsley, P.D., Deng, M., Daza, R.M., Zager, M.A., Aldinger, K.A., Blecher-Gonen, R., Zhang, F., et al.: A human cell atlas of fetal gene expression. Science 370(6518), 7721 (2020)\n[55] Domcke, S., Hill, A.J., Daza, R.M., Cao, J., O'Day, D.R., Pliner, H.A., Aldinger, K.A., Pokholok, D., Zhang, F., Milbank, J.H., et al.: A human cell atlas of fetal chromatin accessibility. Science 370(6518), 7612 (2020)\n[56] Jouanneau, J., Moens, G., Bourgeois, Y., Poupon, M., Thiery, J.: A minority of carcinoma cells producing acidic fibroblast growth factor induces a community effect for tumor progression. Proceedings of the National Academy of Sciences 91(1), 286-290 (1994)\n[57] Li, M., Zhang, T., Chen, Y., Smola, A.J.: Efficient mini-batch training for stochastic optimization. In: Proceedings of the 20th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, pp. $661-670(2014)$\n[58] King, A., Burrows, T., Hiby, S., Bowen, J., Joseph, S., Verma, S., Lim, P., Gardner, L., Le Bouteiller, P., Ziegler, A., et al.: Surface expression of hla-c antigen by human extravillous trophoblast. Placenta 21(4), 376-387 (2000)\n[59] Tantbirojn, P., Crum, C., Parast, M.: Pathophysiology of placenta creta: the role of decidua and extravillous trophoblast. Placenta 29(7), 639-645 (2008)\n[60] Champion, H., Innes, B.A., Robson, S.C., Lash, G.E., Bulmer, J.N.: Effects of interleukin-6 on extravillous trophoblast invasion in early human pregnancy. Molecular human reproduction 18(8), 391-400 (2012)\n[61] Kettenmann, H., Hanisch, U.-K., Noda, M., Verkhratsky, A.: Physiology of microglia. Physiological reviews 91(2), 461-553 (2011)\n[62] Loane, D.J., Byrnes, K.R.: Role of microglia in neurotrauma. Neurotherapeutics 7(4), 366-377 (2010)\n[63] Perry, V.H., Nicoll, J.A., Holmes, C.: Microglia in neurodegenerative disease. Nature Reviews Neurology 6(4), 193-201 (2010)\n[64] Wang, M., Zhao, Y., Zhang, B.: Efficient test and visualization of multi-set intersections. Scientific reports 5(1), 16923 (2015)"
    },
    {
      "markdown": "[65] Roweis, S.: Em algorithms for pca and spca. Advances in neural information processing systems 10 (1997)\n[66] Danese, A., Richter, M.L., Chaichoompu, K., Fischer, D.S., Theis, F.J., Colomé-Tatché, M.: Episcanpy: integrated single-cell epigenomic analysis. Nature Communications 12(1), 5228 (2021)\n[67] Hofmann, T.: Probabilistic latent semantic indexing. In: Proceedings of the 22nd Annual International ACM SIGIR Conference on Research and Development in Information Retrieval, pp. 50-57 (1999)\n[68] Liberzon, A., Subramanian, A., Pinchback, R., Thorvaldsdóttir, H., Tamayo, P., Mesirov, J.P.: Molecular signatures database (msigdb) 3.0. Bioinformatics 27(12), 1739-1740 (2011)\n[69] Ernst, J., Vainas, O., Harbison, C.T., Simon, I., Bar-Joseph, Z.: Reconstructing dynamic regulatory maps. Molecular systems biology 3(1), 74 (2007)\n[70] Kanehisa, M., Araki, M., Goto, S., Hattori, M., Hirakawa, M., Itoh, M., Katayama, T., Kawashima, S., Okuda, S., Tokimatsu, T., et al.: Kegg for linking genomes to life and the environment. Nucleic acids research 36(suppl_1), 480-484 (2007)\n[71] Kerr, M.: The human complement system: assembly of the classical pathway c3 convertase. Biochemical Journal 189(1), 173-181 (1980)\n[72] Fabregat, A., Jupe, S., Matthews, L., Sidiropoulos, K., Gillespie, M., Garapati, P., Haw, R., Jassal, B., Korninger, F., May, B., et al.: The reactome pathway knowledgebase. Nucleic acids research 46(D1), 649-655 (2018)\n[73] Ding, J., Aronow, B.J., Kaminski, N., Kitzmiller, J., Whitsett, J.A., BarJoseph, Z.: Reconstructing differentiation networks and their regulation from time series single-cell expression data. Genome research 28(3), 383395 (2018)\n[74] Dincer, A.B., Janizek, J.D., Lee, S.-I.: Adversarial deconfounding autoencoder for learning robust gene expression embeddings. Bioinformatics 36(Supplement_2), 573-582 (2020)\n[75] Cao, Z.-J., Wei, L., Lu, S., Yang, D.-C., Gao, G.: Searching large-scale scrna-seq databases via unbiased cell embedding with cell blast. Nature communications 11(1), 1-13 (2020)\n[76] Haghverdi, L., Lun, A.T., Morgan, M.D., Marioni, J.C.: Batch effects in single-cell rna-sequencing data are corrected by matching mutual nearest"
    },
    {
      "markdown": "neighbors. Nature biotechnology 36(5), 421-427 (2018)\n[77] Traag, V.A., Waltman, L., Van Eck, N.J.: From louvain to leiden: guaranteeing well-connected communities. Scientific reports 9(1), 1-12 (2019)\n[78] Jin, S., Guerrero-Juarez, C.F., Zhang, L., Chang, I., Ramos, R., Kuan, C.-H., Myung, P., Plikus, M.V., Nie, Q.: Inference and analysis of cellcell communication using cellchat. Nature communications 12(1), 1-20 (2021)\n[79] Cohen, I., Huang, Y., Chen, J., Benesty, J., Benesty, J., Chen, J., Huang, Y., Cohen, I.: Pearson correlation coefficient. Noise reduction in speech processing, 1-4 (2009)\n[80] Plaisier, S.B., Taschereau, R., Wong, J.A., Graeber, T.G.: Rank-rank hypergeometric overlap: identification of statistically significant overlap between gene-expression signatures. Nucleic acids research 38(17), 169$169(2010)$\n[81] Waskom, M.L.: Seaborn: statistical data visualization. Journal of Open Source Software 6(60), 3021 (2021)\n[82] Kim, T.K.: T test as a parametric statistic. Korean journal of anesthesiology 68(6), 540-546 (2015)\n[83] Cuzick, J.: A wilcoxon-type test for trend. Statistics in medicine 4(1), $87-90(1985)$\n[84] Pedregosa, F., Varoquaux, G., Gramfort, A., Michel, V., Thirion, B., Grisel, O., Blondel, M., Prettenhofer, P., Weiss, R., Dubourg, V., et al.: Scikit-learn: Machine learning in python. the Journal of machine Learning research 12, 2825-2830 (2011)\n[85] Conway, J.R., Lex, A., Gehlenborg, N.: Upsetr: an r package for the visualization of intersecting sets and their properties. Bioinformatics 33(18), $2938-2940(2017)$"
    }
  ],
  "usage_info": {
    "pages_processed": 39,
    "doc_size_bytes": 10173152
  },
  "_metadata": {
    "model_version": "0.0.0",
    "llm_model": "mistral-ocr-2505",
    "query_data": {
      "pdf": "/Users/satyaortiz-gagne/CODE/paperext/data/cache/fulltext/c829d35087f4efca89f2232bb09959bb/fulltext.pdf"
    },
    "model_id": "parsepdf"
  }
}