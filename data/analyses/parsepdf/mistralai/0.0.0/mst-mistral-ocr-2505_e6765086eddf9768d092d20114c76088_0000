{
  "pages": [
    {
      "markdown": "![img-0.jpeg](img-0.jpeg)\n\nCheck for updates\n\n## 2\n\nOPEN ACCESS\nCitation: Romani A, Antonietti A, Bella D, Budd J, Giacalone E, Kurban K, et al. (2024) Communitybased reconstruction and simulation of a full-scale model of the rat hippocampus CA1 region. PLoS Biol 22(11): e3002861. https://doi.org/10.1371/ journal.pbio. 3002861\n\nAcademic Editor: Jozsef Csicsvari, Institute of Science and Technology Austria, AUSTRIA\n\nReceived: January 17, 2024\nAccepted: September 24, 2024\nPublished: November 5, 2024\nPeer Review History: PLOS recognizes the benefits of transparency in the peer review process; therefore, we enable the publication of all of the content of peer review and author responses alongside final, published articles. The editorial history of this article is available here: https://doi.org/10.1371/journal.pbio. 3002861\n\nCopyright: © 2024 Romani et al. This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.\n\nData Availability Statement: All relevant data, tools, software, and models are available on the Hippocampus Hub (https://www.hippocampushub. eu). The full network model, along with the code\n\n## METHODS AND RESOURCES\n\n## Community-based reconstruction and simulation of a full-scale model of the rat hippocampus CA1 region\n\nArmando Romani ${ }^{1 *}$, Alberto Antonietti ${ }^{1}$, Davide Bella ${ }^{1}$, Julian Budd ${ }^{1,2}$, Elisabetta Giacalone ${ }^{3}$, Kerem Kurban ${ }^{1}$, Sára Sáray ${ }^{2,4}$, Marwan Abdellah ${ }^{1}$, Alexis Arnaudon ${ }^{1}$, Elvis Bociol ${ }^{1}$, Cristina Colangelo ${ }^{1}$, Jean-Denis Courco ${ }^{1}$, Thomas Delemonte ${ }^{1}$, András Ecker ${ }^{1}$, Joanne Falck ${ }^{2}$, Cyrille Favreau ${ }^{1}$, Michael Gevaert ${ }^{1}$, Juan B. Hernando ${ }^{1}$, Joni Herttuainen ${ }^{1}$, Genrich Ivaska ${ }^{1}$, Lida Kanari ${ }^{1}$, Anna-Kristin Kaufmann ${ }^{1}$, James Gonzalo King ${ }^{1}$, Pramod Kumbhar ${ }^{1}$, Sigrun Lange ${ }^{5,6}$, Huanxiang Lu ${ }^{1}$, Carmen Alina Lupascus ${ }^{3}$, Rosanna Migliore ${ }^{3}$, Fabien Petitjean ${ }^{1}$, Judit Planas ${ }^{1}$, Pranav Rai ${ }^{1}$, Srikanth Ramaswamy ${ }^{1,7}$, Michael W. Reimann ${ }^{1}$, Juan Luis Riquelme ${ }^{1}$, Nadir Román Guerrero ${ }^{1}$, Ying Shi ${ }^{1}$, Vishal Sood ${ }^{1}$, Mohameth François Sy ${ }^{1}$, Werner Van Geit ${ }^{1}$, Liesbeth Vanherpe ${ }^{1}$, Tamás F. Freund ${ }^{2,4 \\ddagger}$, Audrey Mercer ${ }^{3 \\ddagger}$, Eilif Muller ${ }^{1,6,9,10 \\ddagger}$, Felix Schürmann ${ }^{1 \\ddagger}$, Alex M. Thomson ${ }^{3 \\ddagger}$, Michele Migliore ${ }^{3 \\ddagger *}$, Szabolcs Káli ${ }^{2,4 \\ddagger *}$, Henry Markram ${ }^{1 \\ddagger *}$\n\n1 Blue Brain Project, École polytechnique fédérale de Lausanne (EPFL), Campus Biotech, Geneva, Switzerland, 2 HUN-REN Institute of Experimental Medicine (KOKI), Budapest, Hungary, 3 Institute of Biophysics, National Research Council (CNR), Palermo, Italy, 4 Faculty of Information Technology and Bionics, Pázmány Péter Catholic University, Budapest, Hungary, 5 UCL School of Pharmacy, University College London (UCL), London, United Kingdom, 6 School of Life Sciences, University of Westminster, London, United Kingdom, 7 Neural Circuits Laboratory, Biosciences Institute, Newcastle University, Newcastle upon Tyne, United Kingdom, 8 Department of Neurosciences, Faculty of Medicine, Université de Montréal, Montréal, Canada, 9 Centre Hospitalier Universitaire (CHU) Sainte-Justine Research Center, Montréal, Canada, 10 Mila Quebec AI Institute, Montréal, Canada\n$\\ddagger$ These senior authors also contributed equally to this work.\n\n* romani.armando @ gmail.com (AR); michele.migliore @ cnr.it (MM); kali @ koki.hu (SK); henry.markram@epfl.ch (HM)\n\n\n#### Abstract\n\nThe CA1 region of the hippocampus is one of the most studied regions of the rodent brain, thought to play an important role in cognitive functions such as memory and spatial navigation. Despite a wealth of experimental data on its structure and function, it has been challenging to integrate information obtained from diverse experimental approaches. To address this challenge, we present a community-based, full-scale in silico model of the rat CA1 that integrates a broad range of experimental data, from synapse to network, including the reconstruction of its principal afferents, the Schaffer collaterals, and a model of the effects that acetylcholine has on the system. We tested and validated each model component and the final network model, and made input data, assumptions, and strategies explicit and transparent. The unique flexibility of the model allows scientists to potentially address a range of scientific questions. In this article, we describe the methods used to set up simulations to reproduce in vitro and in vivo experiments. Among several applications in the article, we focus on theta rhythm, a prominent hippocampal oscillation associated with various behavioral correlates and use our computer model to reproduce experimental findings."
    },
    {
      "markdown": "and data needed to reproduce all the figures, are also accessible on the Harvard Dataverse. Model: https://dataverse.harvard.edu/dataset.xhtml? persistentId=doi:10.7910/DVN/TN3DUJ Figures: https://dataverse.harvard.edu/dataset.xhtml? persistentId=doi:10.7910/DVN/UGOQWE.\n\nFunding: This study was supported by allocated funding to the Blue Brain Project (www.epfl.ch/ research/domains/bluebrain/), a research center of the École Polytechnique Fédérale de Lausanne (EPFL) (www.epfl.ch/), from the Swiss government's Board of the Swiss Federal Institutes of Technology (ethrat.ch/) to A.A., A.Ar., A.E., A-K. K., A.R., C.C., C.F., D.B., E.B., E.M., F.P., F.S., G.I., H.L., H.M., J.B., J.B.H., J-D.C., J.G.K., J.H., J.L.R., J.P., K.K., L.K., L.V., M.A., M.F.S., M.G., M.W.R., N. R.G., P.K., P.R., S.R., T.D., Y.S., V.S., W.V.G. Funding was also provided by The Human Brain Project (www.humanbrainproject.eu/) through the European Union Seventh Framework (FP7/20072013) under grant agreement no. 604102 (HBP) and from the Horizon 2020 Framework Programme for Research and Innovation (https:// www.humanbrainproject.eu/en/about-hbp/project-structure/human-brain-project-ec-grants/) under the Specific Grant Agreements No. 720270 (Human Brain Project SGA1) and No. 785907 (Human Brain Project SGA2) to to H.M., S.K., M. M., A.M., and A.M.T.. M.M. also acknowledge funding for this work from the European Union, NextGenerationEU (Project IR0000011, CUP B51E22000150006, \"EBRAINS-Italy\"), the EU Horizon Europe Program under the specific Grant Agreement 101147319, EBRAINS 2.0 project, the Fenix computing and storage resources under the Specific Grant Agreement No. 800858 (Human Brain Project ICEI, https://fenix-ri.eu/about-fenix), and a grant from the Centro Svizzero di Calcolo Scientifico (CSCS) under project ID ich002 and ich011 (https://www.cscs.ch/publications/news/ 2019/fenix-consortium-partner-eth-zurich/cscs-e-infrastructure-enabling-nine-projects-from-human-brain-project). S.K. and S.S. were supported by the European Union Instrument for Recovery and Resilience project RRF-2.3.1-21-2022-00004 within the framework of the Hungarian Artificial Intelligence National Laboratory (https://mi. remzetilabor.hu). The Wellcome Trust (https:// wellcome.org/), Medical Research Council (https:// www.ukri.org/councils/mrc/), Novartis Pharma (https://www.novartis.com/research-and-development/research-collaborations) and the Human Brain Project funded A.M. and A.M.T.. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.\n\nFinally, we make data, code, and model available through the hippocampushub.eu portal, which also provides an extensive set of analyses of the model and a user-friendly interface to facilitate adoption and usage. This community-based model represents a valuable tool for integrating diverse experimental data and provides a foundation for further research into the complex workings of the hippocampal CA1 region.\n\n## Introduction\n\nThe hippocampus is thought to play a fundamental role in cognitive functions such as learning, memory, and spatial navigation [1,2]. It consists of three subfields of cornu ammonis (CA), CA1, CA2, and CA3 (see [3]). CA1, for instance, one of the most studied, provides the major hippocampal output to the neocortex and many other brain regions (e.g., [4]). Therefore, understanding the function of CA1 represents a significant step towards explaining the role of hippocampus in cognition.\n\nEach year, the large neuroscientific community studying hippocampus contributes thousands of papers to an existing mass of empirical data collected over many decades of research (see S1 Fig). Recent reviews have, however, highlighted gaps and inconsistencies in the existing literature [5-8]. Currently, the community lacks a unifying, multiscale model of hippocampal structure and function with which to integrate new and existing data.\n\nComputational models and simulations have emerged as crucial tools in neuroscience for consolidating diverse multiscale data into unified, consistent, and quantitative frameworks that can be used to validate and predict dynamic behavior [9]. However, constructing such models requires assigning values to model parameters, which often involves resolving conflicts in the data, filling gaps in knowledge, and making explicit assumptions to compensate for any incomplete data. In order to validate the model, it must be tested under specific experimental conditions using independent sources of empirical evidence before the model can be used to generate experimentally testable predictions. Therefore, the curation of a vast range of experimental data is a fundamental step in constructing and parametrizing any data-driven model of hippocampus.\n\nThe challenge of incorporating these data into a comprehensive reference model of hippocampus, however, is considerable and calls for a community effort. While community-wide projects are common in other disciplines (e.g., Human Genome Project in bioinformatics, CERN in particle physics, NASA's Great Observatories program in astronomy-[10-12]), they are a relatively recent development in neuroscience. OpenWorm, for example, is a successful, decade-long community project to create and simulate a realistic, data-driven reference model of the roundworm Caenorhabditis elegans (C. elegans) including its neural circuitry of approximately 302 neurons to study the behavior of this relatively simple organism in silico [13,14]. By contrast, for the hippocampus, with a circuit many orders of magnitude larger than C. elegans, models have typically been constructed with a minimal circuit structure on a relatively small scale and often their model parameters have been tuned with the goal of reproducing a single empirical phenomenon (see [15]). Comparing the results from a variety of circuit models is problematic because they vary in their degree of realism and frequently rely on one or a few single neuron models making generalization of their findings difficult (see [15]). While these focused models have led to valuable insights (see [16]), this piecemeal approach fails to demonstrate whether these separate phenomena can be reproduced in a full circuit model without the need to adjust parameters."
    },
    {
      "markdown": "Competing interests: The authors have declared that no competing interests exist.\n\nAbbreviations: ACh, acetylcholine; aCSF, artificial cerebrospinal fluid; ADF, augmented Dickey-Fuller; AIS, axon initial segment; bAC, bursting accommodating; BBP, Blue Brain Project; BC, basket cell; BPAP, back-propagating action potential; CA, cornu ammonis; cAC, classical accommodating; cNAC, classical nonaccommodating; CSD, current source density; CV, coefficient of variation; DG, dentate gyrus; eFEL, Electrophys Feature Extraction Library; LFP, local field potential; MOOC, massive online open course; MS, medial septum; MVS, median over visible spread; OVS, overall visible spread; PC, pyramidal cell; PCA, principal component analysis; PP, perforant pathway; PSC, postsynaptic current; PSD, power spectral density; PSP, postsynaptic potential; SC, Schaffer collaterals; STD, standard deviation; STP, short-term plasticity; STTC, spike time tiling coefficient; TMD, topological morphological descriptor.\n\nLarge-scale circuit models of hippocampus using realistic multi-compartment spiking neuronal models pioneered by Traub and colleagues [17-20] have been used to explain key characteristics of oscillatory activity observed in hippocampal slices and to examine the origins of epilepsy in region CA3. More recently, with significant increases in high-performance computing resources, [21] in a microcircuit model of CA1 and notably [22] in a full-scale CA1 model, have examined the contribution of diverse types of interneurons to the generation of prominent theta ( 4 to 12 Hz ) oscillations. While these large-scale circuit models provide a more holistic approach, they still need to incorporate other features to improve their realism. For example, to better reflect the highly curved shape of the hippocampus, an atlas-based structure that more closely mimics anatomy is required. Additionally, models need to employ pathway-specific short-term synaptic plasticity known to regulate circuit dynamics and neural coding [23]. While [24] have constructed a down-scaled, atlas-based model of the rat dentate gyrus (DG) to CA3 pathway, there has to date been no atlas-based, full-scale model of rat CA1 (for a more detailed comparison of these models, see S2 Table).\n\nTo initiate a community effort of this magnitude requires an approach that standardizes data curation and integration of diverse data sets from different labs and uses these curated data to construct and simulate a scalable and reproducible circuit automatically (for recent discussion on the benefits of community-based standards and workflow, see [25,26]). A reconstruction and simulation methodology was introduced and applied at the microcircuit scale, for the neocortex [27] and the thalamus [28] and at full-scale for a whole neocortical area [29,30]. However, these models relied primarily on data sets collected specifically for the purpose rather than data sought from and curated with the help of the scientific community.\n\nIn this paper, we describe a community-based reconstruction and simulation of a full-scale, atlas-based multiscale structural and functional model of the area CA1 of the hippocampus that extends and improves upon the approach described in [27]. Here, a community of 5 different labs (BBP, CNR, KOKI, LNMC, and UCL), with different expertise and having different roles, collaborated to create a \"first draft\" reference CA1 circuit model that could be shared with the wider hippocampus community. Specifically, to model stimuli originating from beyond the intrinsic circuitry, we included the synaptic input from the Schaffer collaterals (SC) from CA3, which is the largest afferent pathway to CA1 and the most commonly stimulated in experiments. Furthermore, we also added the neuromodulatory influence of cholinergic inputs, perhaps the most studied neuromodulator in the hippocampus [31]. We constrained all model parameters and data using available experimental data from different labs or explicit assumptions made when data were lacking. We extensively tested and validated each model component and the final network to assess its quality. To maximize realism of the simulations, we set up simulation experiments to represent as closely as possible the experimental conditions of each empirical validation. We demonstrated the broad applicability of the model by studying the generation of neuronal oscillations, with a specific focus on theta rhythm, in response to a variety of different stimulus conditions. Over time and with the help of the community, limitations of the model revealed by these processes can be addressed to improve upon it. To facilitate a widespread adoption by the community, we have developed a web-based resource to share the model and its components, open sourcing extensive analyses, validations, and predictions that can be accessed as a complement to direct interaction with the model (hippocampushub.eu). Finally, we have developed a massive online open course (MOOC) to introduce users to the building, analysis, and simulation of a rat CA1 microcircuit (https://www.edx.org/course/simulating-a-hippocampus-microcircuit) providing a smaller version of the full-scale model for education purposes."
    },
    {
      "markdown": "# Results \n\nWe divide the Results section into 2 parts: how the model was constructed and validated (Model reconstruction) and the simulation and analysis of activity in the reconstructed circuit model (Model simulations). For a list of abbreviations and acronyms used in the paper, see S1 Table.\n\n## Model reconstruction\n\nIn this section, we describe how we reconstructed the main components of the model: the cornu Ammonis 1 (CA1), the Schaffer collaterals (SC), and the effect of acetylcholine (ACh) on CA1. Each of these main components is itself a compound model of several circuit \"building blocks\" (Fig 1 and S4 Fig). For each of these subcomponents, we show how, from the sparse data available in the literature (see S3-S24 Tables) and a list of assumptions (section List of assumptions), we arrived at the dense data necessary to ascribe a value for each model parameter. For each \"building block\" subcomponent, we validate it against available experiment data.\n![img-1.jpeg](img-1.jpeg)\n\nFig 1. Overview of the model. A visualization of a full-scale, right-hemisphere reconstruction of rat CA1 region and its components. The number of cells is reduced to $1 \\%$ for clarity, and neurons are randomly colored. The CA1 network model integrates entities of different spatial and temporal scales. The different scales also reflect our bottom-up approach to reconstruct the model. Ion channels (1) were inserted into the different morphological types (3) to reproduce electrophysiological characteristics and obtain neuron models (4). Neurons were then connected by synapses to generate an intrinsic CA1 connectome (5). For each intrinsic pathway, synaptic receptors (2) and transmission dynamics were assigned based on single neuron paired recording data (6) to create a functional intrinsic CA1 network model (7). The intrinsic CA1 circuit received synaptic input from CA3 via Schaffer collateral (SC) axons (8). The neuromodulatory influence of cholinergic release on the response of CA1 neurons and synapses was modeled phenomenologically (9). The dynamic response of the CA1 network was simulated with a variety of manipulations to model in vitro and in vivo, intrinsic and extrinsic stimulus protocols while recording intracellularly and extracellularly (10) to validate the circuit at different spatial scales against specific experimental studies (11) and to make experimentally testable predictions (12)."
    },
    {
      "markdown": "# Building CA1 \n\nTo reconstruct a full-scale model of rat CA1, we created biophysical models of its neurons, defined an atlas volume of the region for one hemisphere, placed these neurons in the volume, and connected them together by following and adapting the method described in [27] (S4 Fig).\n\n## CA1 neurons\n\nTo achieve a full-scale version of CA1, we needed to populate the model with approximately 456,000 cells. We started by curating 43 morphological reconstructions of neurons belonging to 12 morphological types: pyramidal cell (PC), axo-axonic cell (AA), 2 subtypes of bistratified cell (BS), back-projecting cell (BP), cholecystokinin (CCK) positive basket cell (CCKBC), ivy cell (Ivy), oriens lacunosum-moleculare cell (OLM), perforant pathway associated cell (PPA), parvalbumin positive basket cell (PVBC), Schaffer collateral associated cell (SCA), and trilaminar cell (Tri). To increase the morphological variability, we scaled and cloned them producing an initial morphology library of 2,592 reconstructions.\n\nTo validate the resulting morphology library, we compared them morphometrically and topologically to the original morphologies. The similarity scores for the distribution of morphological features were statistically similar (S5 Fig, all values $R>0.98, p<10^{-25}$ ). Using the topological morphology descriptor (TMD) [32], the persistence diagrams (S6 Fig) show an increase in morphological variability introduced by the cloning process (details per m-type in S7 and S8 Figs).\n\nTo produce electrical models (e-models), we began by taking 154 single-cell recordings and classifying traces into 4 electrical types (e-types) using Petilla nomenclature [33]: classical accommodating for pyramidal cells and interneurons (cACpyr, cAC), bursting accommodating (bAC), and classical non-accommodating (cNAC). From each trace, we extracted electrical features (e-features) which we used in combination with the curated morphologies to produce and validate 36 single-cell e-models [34,35]. In the case of pyramidal cells e-models, they qualitatively reproduced experimental findings in terms of back-propagating action potential (BPAP) ([36], $R=0.878, p=0.121$ ) and postsynaptic potential (PSP) attenuation ([37], $R=0.846$, $p=0.001$, S9 Fig). However, since we constrained the models with somatic not dendritic features, we expected some degree of difference compared with experimental results (see [38]).\n\nTo match the proportions of the morpho-electrical type (me-type) composition of the CA1 (S4 Table), we combined the 36 e-models with 2,592 curated morphologies to obtain an initial library of 26,112 unique me-type models. This is the pool of biophysical cell models available to populate the full-scale version of CA1.\n\n## Defining the spatial framework\n\nTo represent the CA1 spatial volume, we started with a publicly available atlas reconstruction of the hippocampus [39]. Our aim was to create a continuous coordinate system to represent the 3 axes of the hippocampus (longitudinal, transverse, and radial) and a precise vector field for cell placement and orientation (Fig 2). For our building and analysis algorithms to work effectively, we applied a series of post-processing steps (S10 Fig, see section Atlas). Within this process, we redefined the layers parametrically to be consistent with the layer thicknesses in our data sets (section Layers).\n\n## Placing neurons in the volume\n\nAfter defining the volume, we wanted the model to match the neuronal density and proportion of cell types in rat CA1. We compiled available data to derive the cellular composition (section"
    },
    {
      "markdown": "![img-2.jpeg](img-2.jpeg)\n\nFig 2. Coordinate system. Custom parametric coordinates system used as spatial reference for circuit building, circuit segmentation, and for simulation experiments. (A) Longitudinal (l, red), transverse (t, green) and radial (r, blue) axes of the CA1 volume are defined parametrically in range [0,1]. Left: Slice from volume shows radial depth from SO/alveus $(\\mathrm{r}=0)$ to SLM/pial $(\\mathrm{r}=1)$ and transverse extent from CA3/proximal CA1 $(\\mathrm{t}=1)$ to distal CA1/subiculum $(\\mathrm{t}=0)$ boundaries. Right: Full volume shows surface grid of transverse vs. longitudinal axes. Longitudinal axis extends from dorsal $(l=0)$ to ventral $(l=1)$ CA1. (B) Circuit segmentation for analysis and simulation. Coordinates system used to select CA1 slices of a given thickness (B1) or a cylinders of a given diameter (B2) at specific locations along longitudinal axis. (C) Extracellular electrode placed at a given surface position (left) and channels at selected laminar depth (right) in CA1 volume. (D) Each neuron in the circuit is defined by a unique general identifier (gid), its morphological type (m-type), electrical type (e-type), spatial xyz-coordinates and parameterized ltr-coordinates.\nhttps://doi.org/10.1371/journal.pbio.3002861.g002\nCell composition, see S3 Table) and used it to populate the atlas with soma locations (S11A and S11B Fig). To check the consistency, we validated the resulting cell composition $\\left(R=0.999, p=1.31 \\times 10^{-28}\\right)$ and cell density $(R=0.999, p=0.0001)$ (S12B and S12C Fig and S5 Table). At each soma location, we needed to select from the e-model library the neuron that best fits in the space of the layers. To this purpose, we oriented its morphology according to the vector fields (S11C and S11D Fig) and evaluated it against a set of rules that describe the target distribution of neurites per layer (S6 Table). Visually, cells in our model follow the curvature of the hippocampus and the different parts of the cells target the expected layers (S12A Fig). Subject to the multiple constraints of the cell placement algorithm, we placed 456,380 neurons in the volume, utilizing 2,523 unique morphologies, and 25,355 unique neuron models."
    },
    {
      "markdown": "# Connecting CA1 neurons \n\nTo connect the placed neurons, we used the connectome algorithm previously described in [40]. In brief, the algorithm searches for co-localization of axon and postsynaptic neurons within a certain distance to identify a potential synapse (or apposition). After identifying all potential synapses, a subsequent pathway-specific pruning step discards some to match the known bouton densities (S7 Table) and number of synapses per single axon connection (S9 Table). This algorithm has been demonstrated to accurately recreate local connectivity [27-29] as well as higher-order topological features [41]. The resulting intrinsic connectome consisted of about 821 million synapses.\n\nGiven the importance of the connectome, we wanted to validate it as widely as possible to mitigate the uncertainty in our assumptions and literature data (S14-S17 Figs). First, we verified the bouton density and number of synapses per connection used in the pruning step was preserved in the generated connectome (bouton density: $R=0.909, p=0.0120$; number of synapses per connection: $R=0.992, p=2.41 \\times 10^{-9}$, S14 Fig and S7 and S9 Tables). Next, we observed that the shape of the distributions for connection probability (S15A Fig), convergence (S16A Fig) and divergence (S17A Fig) were positively skewed as reported experimentally [42]. In the case of mean connection probability, experimental data did not allow a direct comparison because the distance between the neuron pairs tested was typically missing (S15C Fig and S8 Table). For convergence, we found that the subcellular distribution of synapses on different compartments of pyramidal cells in our model was consistent with [43] ( $R=0.988$, $p=0.012$, S16D Fig). For divergence, the model did not always closely match the experimental data for the total number of synapses per axon formed by certain m-types ( $R=0.524$, $p=0.286$, S17C Fig and S10 Table). We compared divergence also in terms of the percentage of synapses formed with PCs or INTs (S17D Fig and S11 Table) and validated the distribution of efferent synapses in the different layers (SO: $R=0.798, p=0.057$; SP: $R=0.905, p=0.013$; SR: $R=0813, p=0.049$; SLM: $R=0.999, p=4.11 \\times 10^{-9}$, S17E Fig and S12 Table). Overall, this suggests the model connectome provides a reasonable approximation based on available data, while the discrepancies can be due, for example, to the small sample size and high variability in axon length recovered from in vitro slices.\n\nTo provide functional dynamics for synaptic connections with stochastic neurotransmitter release and short-term plasticity (STP) (see S18 Fig), we used the optimized parameters we previously derived in [34] for the 22 intrinsic synaptic classes of pathways we have identified (S13 and S14 Tables). The model was able to reproduce the PSP amplitudes (S18D Fig, $\\mathrm{R}=0.999, p=1.65 \\times 10^{-19}$ ) and postsynaptic current (PSC) coefficient of variation (CV) of the first peak (S18E Fig, $R=0.840, p=0.018$ ) for the pathways with available electrophysiological recordings. After having constrained and validated the synapses, the reconstruction process of the intrinsic CA1 circuit is complete.\n\n## Reconstruction of Schaffer collaterals (SC)\n\nAn isolated CA1 does not have substantial background activity [44], while normally the network is driven by external inputs. The Schaffer collaterals from CA3 pyramidal cells are the most prominent afferent input to the CA1 and the most studied pathway in the hippocampus [45,46]. Their inclusion allows us to deliver synaptic activity input patterns to the CA1.\n\nTo reconstruct the anatomy of Schaffer collaterals, we constrained the number of CA3 fibers and their average convergence on CA1 neurons with literature data (S15 and S16 Tables). Due to scarce topographical information, we distributed synapses uniformly along the transverse and longitudinal axes, while along the radial axis we followed a layer-wise distribution as reported by [5]. The resulting Schaffer collaterals added more than 9 billion synapses to"
    },
    {
      "markdown": "![img-3.jpeg](img-3.jpeg)\n\nFig 3. Schaffer collaterals anatomy and physiology. (A) Section of a slice of the dorsal CA1 showing neurons in gray and SC synapses in orange ( $10 \\%$ of the existing ones). (B) Example of SC synapse placement (orange dots) on one reconstructed PC (in gray). (C-H) Validation of the anatomy (C-E) and physiology (F-H) of the SC. Experimental values can be found in 515-S18 Tables. Density of SC synapses (lower x axis) and PDF (upper x axis) at different depths (radial axis percentage) (C). Distributions of afferent synapses from SC to PC (D) and INT (E). Distribution of PSP amplitudes for SC $\\rightarrow$ PC synapses (F). Distribution of PSC ratio (see text) for SC $\\rightarrow$ CB1R+ (G) and SC $\\rightarrow$ CB1R- (H). Insets in panels F-H report voltage membrane traces of 10 randomly selected pairs of $\\mathrm{SC} \\rightarrow \\mathrm{PC}, \\mathrm{SC} \\rightarrow \\mathrm{CB} 1 \\mathrm{R}+$, and $\\mathrm{SC} \\rightarrow \\mathrm{CB} 1 \\mathrm{R}$ - interneurons, respectively. The presynaptic SC is stimulated to fire 8 times at 30 Hz , plus a recovery pulse after 500 ms from the last spike of the train. Solid black lines represent mean values and shaded gray areas the standard deviation. PC, pyramidal cell; PDF, probability density function; PSP, postsynaptic potential; SC, Schaffer collaterals.\nhttps://doi.org/10.1371/journal.pbio. 3002861.g003\nCA1, representing $92 \\%$ of total modeled synapses. As expected, the synapse laminar distribution (Fig 3A-3C) and mean convergence on PCs and interneurons (Fig 3D and 3E) match experimental values (one-sample $t$ test, $p=0.957$ for PCs and $p=0.990$ for INTs). Interestingly, other unconstrained properties also match experimental data. The convergence variability is comparable with the upper and lower limits identified by [5] (model PC: $20,878 \\pm 5,867$ synapses and experimental PC: $13,059-28,697$, model INT: $12,714 \\pm 5,541$ and experimental INT 7,952-17,476, Fig 3D and 3E). In addition, the axonal divergence from a single CA3 PC is $34,135 \\pm 185$ synapses (S19A Fig), close to the higher end of the ranges measured by [47-49] (15,295-27,440, S19B Fig). Finally, most of the connections formed a single synapse per neuron ( $1.0 \\pm 0.2$ synapses/connection, S19A Fig), consistent with what has been previously reported [5].\n\nThe CA3 afferent pathway is sparsely connected to the CA1, so the chance of obtaining paired CA3-CA1 neuronal recordings is small between PCs and much smaller from PC to interneurons [50-53]. So, to constrain SC physiology we did not have enough data to follow the parametrization used for intrinsic synapses [34]. Instead, we used the available data"
    },
    {
      "markdown": "(S17 and S18 Tables) and optimized the missing parameters as shown in S19C Fig. The resulting SC $\\rightarrow$ PC synapses match the distribution of EPSP amplitudes as measured by [50] (Fig 3F, experiment: $0.14 \\pm 0.11 \\mathrm{mV}, \\mathrm{CV}=0.76$, model: $0.15 \\pm 0.12 \\mathrm{mV}, \\mathrm{CV}=0.80$, z-test $p=0.709$ ), giving a peak synaptic conductance of $0.85 \\pm 0.05 \\mathrm{nS}$ and $\\mathrm{N}_{R R P}$ of 12 . The rise and decay time constants of AMPA receptors (respectively 0.4 ms and $12.0 \\pm 0.5 \\mathrm{~ms}$ ) were obtained by matching [50] EPSP dynamics (S19C Fig, 10\\% to $90 \\%$ rise time model: $5.4 \\pm 0.9 \\mathrm{~ms}$ and experiment: $3.9 \\pm 1.8 \\mathrm{~ms}$, half-width model: $20.3 \\pm 2.9 \\mathrm{~ms}$ and experiment: $19.5 \\pm 8.0 \\mathrm{~ms}$, decay time constant model: $19.5 \\pm 2.5 \\mathrm{~ms}$ and experiment: $22.6 \\pm 11.0 \\mathrm{~ms}$ ). In the case of $\\mathrm{SC} \\rightarrow \\mathrm{INT}$ synapses, we distinguished between cannabinoid receptor type 1 negative (CB1R-) and positive (CB1R +) interneurons [54]. SC $\\rightarrow$ CB1R- synapses match EPSC $_{C B R 1-}$ EPSC $_{P C}$ experimental ratio [54] (model $6.95 \\pm 9.20$ and experiment $8.15 \\pm 6.00$, z-test $p=0.18$, Fig 3G), resulting in a peak conductance of $15.0 \\pm 1.0 \\mathrm{nS}$ and $\\mathrm{N}_{R R P}$ of $2 . \\mathrm{SC} \\rightarrow \\mathrm{CB} 1 \\mathrm{R}+$ synapses match the $\\mathrm{EPSC}_{C B R+}$ /EPSC $_{P C}$ experimental ratio (model $1.27 \\pm 1.78$ and experiment $1.09 \\pm 1.44$, z-test $p=0.06$, Fig 3H), giving peak conductance of $1.5 \\pm 0.1 \\mathrm{nS}$ and $N_{R R P}$ of $8 . \\mathrm{SC} \\rightarrow \\mathrm{INT}$ synapses (all) match the timing in the EPSP-IPSP sequence of [55] (model: $2.69 \\pm 1.18 \\mathrm{~ms}$, experiment: $1.9 \\pm 0.6 \\mathrm{~ms}$, S19 Fig E), yielding a rise and decay constants for AMPA receptors of 0.1 ms and $1.0 \\pm 0.1 \\mathrm{~ms}$, respectively. This short latency gives effective feedforward inhibition, which is a key aspect for the transmission of oscillations from CA3 to CA1 (see below).\n\nWe functionally validated SC projections reproducing [56], where the authors examined the basic input-output (I-O) characteristics of SC projections in vitro. The SC pathway is thought to be dominated by feedforward inhibition, which increases the dynamic range of the CA1 network and linearizes the I-O curve [56,57]. Blocking gamma-aminobutyric acid receptor $\\left(\\mathrm{GABA}_{A} \\mathrm{R}\\right)$ drastically reduces the dynamic range of the network resulting in an I-O curve that saturates very quickly. To match the methodology of [56], we set up the simulations to be as close as possible to the experimental conditions (slice of $300 \\mu \\mathrm{~m}, \\mathrm{Ca}^{2+} 2.4 \\mathrm{mM}, \\mathrm{Mg}^{2+} 1.4$ $\\mathrm{mM}, 32^{\\circ} \\mathrm{C}$ ) (Fig 4A) and we used the same sampling strategy: randomly sampling 101 neurons in the slice to find how many SC axons were required to make all of them fire (representing respectively $100 \\%$ of the input and $100 \\%$ of output, Fig 4B). To assess the role of feedforward inhibition, we mimic the effect of gabazine by disabling the connections from interneurons. The model captured the quasi-linearization of the I-O response in control conditions (Pearson test on linearity $\\mathrm{R}=0.992, \\mathrm{p}=2.56 \\times 10^{-9}$ ) and the rapid saturation of the CA1 network with the simulated \"no GABA\" condition (Fig 4B). In control conditions, at $50 \\%$ of input intensity (Fig 4C) the spiking activity of CA1 SP neurons is rather weak and rapidly suppressed by the feedforward inhibition, while without inhibition CA1 neurons fire for more than 50 ms at high frequency (up to 200 Hz ). Taken together, these results suggest the SC projection represents a valid model given the available empirical data.\n\n## Cholinergic modulation\n\nThe behavior of the hippocampus is shaped by several neuromodulators, with acetylcholine ( ACh ) among the most studied. Cholinergic fibers originate mainly from the medial septum (MS) and have been correlated with phenomena such as theta rhythm, plasticity, memory retrieval, and encoding, as well as pathological conditions such as Alzheimer's disease [58]. This section describes the reconstruction of a phenomenological model of ACh , quantifying the effects of ACh on neurons and synapses, and developing a novel method to integrate available experimental data (S19 and S20 Tables and Fig 5A and 5B). The data used to build the model was obtained from in vitro application of various cholinergic agonists such as ACh and carbachol (CCh); here, we assume that their effects are comparable [59]. We modeled the effect of ACh on neurons and synapses. The effect on neurons results in an increase in resting"
    },
    {
      "markdown": "![img-4.jpeg](img-4.jpeg)\n\nFig 4. Schaffer collaterals validation. Effect of the feedforward inhibition on the input-output relationship of the network illustrated in a slice experiment. (A) The illustration (redrawn from Fig 1A of [56]) shows the in silico experimental setup. (B) Response of 101 selected neurons to an increasing number of stimulated SC fibers, with and without GABA. The dashed boxes identify the condition ( $50 \\%$ of active SC) that is used to show the model's results in panel C. (C) Raster plots of SP neurons in response to the SC stimulation (orange vertical line) with the overlaying firing rate (blue). On the right, membrane voltage traces of three randomly selected SP neurons in control (black) and no GABA (gray) conditions. SC, Schaffer collaterals.\nhttps://doi.org/10.1371/journal.pbio. 3002861.g004\nmembrane potential or firing frequency. We were able to integrate both types of experimental data by estimating the net current that is required to evoke the corresponding changes for a given concentration of ACh (see Eq 9 in Methods). ACh affects synaptic transmission acting principally at the level of release probability [23,60,61] (see Eq 10 in Methods).\n\nAfter modeling the effect of ACh on neuron excitability and synaptic transmission, we validated the effect of ACh at the network level against available data (see S21 Table). To accomplish this, we simulated bath application of ACh for a wide range of concentrations (from $0 \\mu \\mathrm{M}$ (i.e., control condition) to $1,000 \\mu \\mathrm{M}$ ) (Fig 5E and 5F). We observed a subthreshold increase in the membrane potential of all neurons for values of ACh lower than $50 \\mu \\mathrm{M}$, without any significant change in spiking activity. At intermediate doses (i.e., $100 \\mu \\mathrm{M}$ and $200 \\mu \\mathrm{M}$ ), the network shifted to a more sustained activity regime. Here, we observed a generalized increase in firing rate as ACh concentration increased and a progressive build-up of coherent oscillations whose frequencies ranged from 8 to 16 Hz (from high theta to low beta frequency bands). The correlation peak between CA1 neurons occurred at $200 \\mu \\mathrm{M}$ ACh (Fig 5G and 5H). At very high concentrations (i.e., $500 \\mu \\mathrm{M}$ and $1,000 \\mu \\mathrm{M}$ ), we observed a decrease in the"
    },
    {
      "markdown": "![img-5.jpeg](img-5.jpeg)\n\nFig 5. Effects of Acetylcholine on neurons, synapses, and network. (A) Dose-response modulation of neuronal excitability caused by ACh. Black dots are experimental data points; blue curve represents the fitted equation. The dashed part of the curve indicates regions outside available experimental data. (B) Dose-response modulation of synaptic release. Same color code as in A. (C) Example traces for PC (C1) and interneurons (C2) in sub-threshold and suprathreshold conditions, with different concentrations of ACh. (D) Example traces showing the STP dynamics for PC (D1) and interneurons (D2) at different concentrations of ACh. (E) The illustration shows the in silico experimental setup to analyze network effects of ACh. Different concentrations of CCh are applied to the circuit and multiple types of recordings made in the CA1 (membrane voltage, spike times, LFPs). (F) Mean STTC as a function of ACh"
    },
    {
      "markdown": "concentration. (G) Maximum of the LFP PSD and peak frequency as a function of ACh concentration. (H) The voltage of 100 randomly selected neurons at different levels of ACh. The upper histograms show the instantaneous firing rate. (I) Spike-spike correlation histograms. (J) Spectrogram of the LFP measured in SP at different ACh levels. (K) PSD of the LFP recorded in SP. ACh, acetylcholine; LFP, local field potential; PC, pyramidal cell; PSD, power spectral density; STTC, spike time tiling coefficient.\nhttps://doi.org/10.1371/journal.pbio.3002861.g005\npower of network oscillations, which was further confirmed by analysis of local field potential (LFP) (Fig 5I). Power spectral density (PSD) analysis showed a maximum absolute amplitude for $200 \\mu \\mathrm{M}$ ACh with a peak frequency of approximately 15 Hz (Fig 5J and 5K). Higher concentrations decreased the maximum amplitude of the PSD while the peak frequency converged toward 17 Hz (Fig 5K). Thus, we observe the emergence of 3 different activity regimes at low, intermediate, and high levels of cholinergic stimulation. It is unclear whether the network behavior we observe is consistent with all experimental findings because of their different methodologies. Nevertheless, this phenomenological model of ACh allows the reproduction of other experiments in which ACh or its receptor agonists are necessary (see, for example, sections Medial septum input and Other frequencies).\n\n# Model simulations \n\nBy following a data-driven approach and independently validating each model component, we have arrived at a candidate reference model. It can serve as a basis for investigating several scientific questions where parameters are only adjusted to reflect the different experimental setups, rather than tuned to achieve a specific network behavior. A simulation experiment is essentially a model of the experimental setup that is reproduced with as much accuracy as possible within the limits of the circuit model. As presented in the Model reconstruction section we can, for example, simulate slices of a certain thickness, change the extracellular concentration of ions, change temperature, and enable spontaneous synaptic events.\n\nBecause a central interest in hippocampus has been its oscillatory activity, here, we show several simulations with particular emphasis on theta oscillations, a prominent network phenomenon observed in the hippocampus in vivo and related to many behavioral correlates [62]. Then, we examine the frequency response band-pass properties of CA1 circuit for a wider range of SC input frequencies.\n\n## Theta oscillations\n\nDuring locomotion and REM sleep, CA1 generates a characteristic rhythmic theta-band (4 to 12 Hz ) extracellular field potential [63-67]. Neurons in many other brain regions such as neocortex are phase-locked to these theta oscillations [68,69] suggesting hippocampal theta plays a crucial coordinating role in the encoding and retrieval of episodic memory during spatial navigation [62,70]. Yet, despite more than 80 years of research, the trigger that generates theta oscillations in CA1 remains unclear because of conflicting evidence. This represents an opportunity to use our reference model to investigate these inconsistencies and gain an improved understanding of theta generation. As a first step, we wanted to reproduce a series of experimental data and investigate potential mechanisms proposed in literature [71], namely, intrinsic CA1 generation and extrinsic pacemaker oscillations from CA3 or from MS.\n\n## CA1 generation\n\nTo investigate possible intrinsic mechanisms of theta rhythm generation in CA1 [72,73], we examined 3 candidate sources of excitation that might induce oscillations: (1) spontaneous synaptic release or miniature postsynaptic potentials (minis or mPSPs); (2) homogeneous"
    },
    {
      "markdown": "random spiking of SC afferent inputs; and (3) varying bath concentrations of extracellular calcium and potassium to induce tonic circuit depolarization. While in their CA1 circuit model [22] reported random synaptic activity was sufficient to induce robust theta rhythms, in our model we found none of these candidates generated robust theta rhythms. For minis, we found setting release probabilities to match empirically reported mPSP rates (S22 Table) led to irregular, wide-band activity in CA1 (see S20 Fig). For random synaptic barrage, varying presynaptic rate to match the mean postynaptic firing rate of pyramidal cells in [22] resulted in irregular beta-band, not regular theta-band oscillations (see S21 and S22 Figs). For tonic depolarization, within a restricted parameter range it was possible to generate theta oscillations around 10 to 12 Hz , but their intensity was variable and episodic (see S23 and S24 Figs). Therefore, we could not find any intrinsic mechanism capable of generating regular theta activity in our circuit model.\n\n# CA3 input \n\nTo mimic the transmission of CA3 theta oscillations to CA1, we generated SC spike trains across a range of theta-modulated sinusoidal rate functions (signal frequency) at different mean individual rates (cell frequency) (Fig 6A). We delivered these stimuli at 3 different circuit scales (whole circuit, thick slice, and cylinder circuit; see Fig 2) and measured extracellular LFP and intracellular membrane potential. To mimic recordings performed under in vivo and in vitro conditions, we did this using different calcium levels: 1 mM for \"in vivo-like\" and 2 mM for \"in vitro-like.\" For LFP, we found CA1 faithfully followed the theta-modulation input frequency at both in vivo-like and in vitro-like calcium levels and at the different circuit scales tested (e.g., 8 Hz , see Fig 6C-6F). However, for the same stimulus, the LFP at in vivolike calcium levels was around 3 orders of magnitude less powerful than the one at in vitro-like calcium levels (Fig 6B, 6C and 6F) due to CA1 spiking rates being far lower (e.g., in full circuit, pyramidal cell mean firing rate of $0.00018 \\pm 0.0067(1 \\mathrm{mM})$ versus $0.25 \\pm 0.50 \\mathrm{~Hz}(2 \\mathrm{mM})$ ). Therefore, due to this very low firing rate, we decided not to analyze results from in vivo-like conditions further and focused on those from the in vitro-like condition only (Fig 6C-6E).\n\nWe analyzed the properties of the model LFP and compared them to experimental data. First, we examined whether the circuit size is critical for theta generation. We found that all the 3 circuit scales generated theta oscillations, but slice and cylinder circuits had reduced magnitude of the modulation and LFP power (Fig 6C-6E). Second, across all the scales, the LFP waveform (Fig 6C-6E, left columns) was more asymmetrical with a fast rise and slower decay (mean asymmetry index $=-1.34 \\pm 0.23$; see S25 Fig) with respect to what was reported during rat locomotion (asymmetry index $=-0.27$, [74]) or REM sleep periods (asymmetry index $=-0.13$, [75]). Third, we observed a strong narrow-band peak of power at the same frequency as the signal that was maintained throughout the entire period of stimulation (Fig 6A6C, middle left columns). Fourth, consistent with experimental evidence (e.g., Fig 1B in [72]), first- ( 16 Hz ) and second-order ( 24 Hz ) harmonics of the theta modulation frequency were also present (Fig 6A-6C, middle right columns). Fifth, current source density (CSD) showed a highly regular alternating current dipole between layers with a phase reversal between SP and SR (Fig 6A-6C, far right column). This is similar to in vivo LFP recordings in the absence of perforant pathway input [70], which we did not model. Therefore, since the results did not depend qualitatively on circuit size, for the sake of simplicity, we further analyzed only the cylinder circuit.\n\nNext, we looked at how the spiking of different neuronal classes in the model are modulated by theta oscillations ([76-79]; see S23 Table). When the spike times of neurons close to the extracellular recording electrode in SP were compared with the phases of theta-band LFP"
    },
    {
      "markdown": "![img-6.jpeg](img-6.jpeg)\n\nFig 6. CA3 theta ( 8 Hz ) oscillatory input entrains CA1 to matched theta oscillation across different scales of circuit. (A) Schema showing the in silico experimental setup. (B) Dependency of peak frequency (left) and PSD (right) from calcium level, cell and signal frequencies during simulations of a cylinder circuit. (C) Full circuit model ( 2 mM calcium). LFP recordings from SP (far left), spectrogram (left middle), PSD (right middle), CSD (far right). (D) Slice circuit model (thickness of $300 \\mu \\mathrm{~m}, 2 \\mathrm{mM}$ calcium). (E) Cylinder circuit model (radius of $300 \\mu \\mathrm{~m}, 2 \\mathrm{mM}$ calcium). (F) Full circuit model ( 1 mM calcium). Note that PSD has 1,000 times smaller $\\gamma$-axis scaling than the ones in panels A-C. CSD, current source density; LFP, local field potential; PSD, power spectral density.\nhttps://doi.org/10.1371/journal.pbio. 3002861 .g006\nrhythm (theta trough $=0^{\\circ}$ ), all neuron types were found to respond at roughly the same phase of the theta cycle (Fig 7). As the mean rate of SC afferent spiking increased, more neurons became phase-locked yielding a denser mono-phase distribution for higher signal modulation frequencies (Fig 7A). For example, under stimuli with a 0.4 Hz SC mean spiking frequency and 8 Hz signal modulation, CA1 PCs fired first during the mid-rising phase of theta and were followed by all types of interneurons, whose spiking mostly ended before peak theta, with BS"
    },
    {
      "markdown": "![img-7.jpeg](img-7.jpeg)\n\nFig 7. CA1 morphological types are homogeneously tuned to CA3 theta oscillatory input. (A) Neurons for analysis were selected within $100 \\mu \\mathrm{~m}$ radius of the stratum pyramidale electrode location (top left), shown as shaded region with the arrow indicating the radius of this region. Phase locking angle and strength for a range of individual (CA3) cell frequencies (columns) and modulation frequencies (rows). (B) Phase modulation. Spike discharge probability of all neurons grouped by morphological type (left). Phase locked neurons tuning over theta cycle for each morphological class over a single theta cycle (middle). Experimental validation of phase-locking against in vivo recordings (right) with an arrow representing the mean phase angle (experimental data $=$ black arrow; simulated $=$ colored arrow) and gray shaded sector indicating, where known, the experimental angular deviation. (C) Spiking raster plots. SP_PC cell spiking (top panel); LFP theta rhythm (trace above plot); intereuron spiking (bottom panel). (D) Intracellular traces from morphological cell types (left) and validation against in vivo recordings. Stimulus panels B-D: 0.4 Hz SC mean spiking frequency and 8 Hz signal modulation. All simulations shown for 2 mM calcium. Experimental values in panels B and D can be found respectively in S23 and S24 Tables. LFP, local field potential; PC, pyramidal cell; SC, Schaffer collaterals."
    },
    {
      "markdown": "neurons emitting few or no spikes (Fig 7B, left). Phase-locked neurons had a tighter tuning than in vivo, with pyramidal neurons typically firing before interneurons (Fig 7B, middle). When compared with in vivo recordings of phase-locked neurons (see S23 Table), the mean phase angle of model spiking was closely matched for SP_CCKBC but substantially out of phase for SP_AA (Fig 7B, right). Although the angular deviation of phase-locking was generally tighter than observed in vivo (e.g., model versus in vivo for SP_AA $8.9^{\\circ}(n=4)$ versus $55.0^{\\circ}(n=2)$, SP_PVBC $12.0^{\\circ}(n=2)$ versus $68.0^{\\circ}(n=5)$, and SP_Ivy $10.9^{\\circ}(n=19)$ versus $63.1^{\\circ}(n=4))$.\n\nFor the same neuronal classes in the model, we compared their somatic membrane potentials and mean firing rates to experimental data. Pyramidal cell spiking was closely aligned to theta LFP rhythm although individual neurons did not spike at every cycle (Fig 7C, top). SP_Ivy showed a similar pattern to SP_PC while other types of interneuron participated more sporadically (Fig 7C, bottom). Intracellular voltage traces for pyramidal and ivy cells were also similar albeit with ivy cell firing slightly later and overlapping with other types of interneurons (Fig 7D, left). Mean firing rates during theta were generally lower than observed in vivo except for ivy cells, which were a close match; SP_AA, BS, and BC (CCK+ and PV+) were well below empirical expectations (Fig 7D, right). Theta modulated the amplitude of pyramidal cell membrane potential by $1.57-7.34 \\mathrm{mV}$ (for $0.1-0.4 \\mathrm{~Hz}$ SC axon frequency), consistent with the in vivo range ( $2-6 \\mathrm{mV}$, [80]). When we compared model population synchrony during theta oscillations with in vivo data [81], we found that the percentage of SP_PC spiking was a poor match around the theta trough $\\left(0^{\\circ}\\right)$ but was a better match around theta peak $\\left(180^{\\circ}\\right)$, while fast-spiking SP_PVBC and to a lesser degree SP_AA were under-recruited (S26 Fig). Overall, for this stimulus the pyramidal-interneuron theta phase order suggests that intrinsic inhibition was activated more powerfully by recurrent than by afferent excitation. Altogether, for the CA3 input, the model does not generate theta at in vivo-like calcium levels but does reliably at in vitro-like ones. However, the phase analysis suggests that the mechanism is different from what is observed in vivo.\n\n# Medial septum input \n\nIn vivo evidence points to a fundamental role of the MS in theta generation [71]. To model the possible role of MS-mediated disinhibition to CA1 in theta oscillations, we (i) set an in vivo extracellular calcium concentration ( 1 mM ); (ii) applied a tonic depolarizing current (\\% of rheobase current) to all neurons to represent in vivo background activity; (iii) introduced an additional current to mimic the depolarizing effect of an arhythmic release of ACh from the cholinergic projection (see ACh section); and (iv) applied a theta frequency sinusoidal hyperpolarizing current stimulus only to PV+ CA1 neurons to represent the rhythmic disinhibitory action of the GABAergic projection ([82-84]; see Fig 8A). Due to uncertainty regarding some of these factors, we examined the response over a wide range of physiological conditions (see Methods). Since this required a high number of simulations, we decided to use the cylinder circuit.\n\nPrior to the onset of the disinhibitory stimulus (\"MS OFF\"), the global tonic depolarization resulted in weak, irregular beta-band LFP activity in CA1 but after its onset (\"MS ON\"), it induced a strong and sustained, regular theta oscillation matching the frequency of the hyperpolarizing stimulus (Fig 8B). For disinhibitory modulation amplitude of 0.2 nA , the LFP waveforms generated were close to symmetrical (mean asymmetry index $=0.25 \\pm 0.11$; see 527 Fig). Over a range of ACh concentrations and tonic depolarization levels, this theta rhythm was robust, narrow banded (Fig 8B and 8C), and generated by a highly regular current source restricted to SP (Fig 8E). Higher ACh concentrations, while slightly reducing theta-band power, reduced the level of beta-band activity (Fig 8C). Increased levels of tonic depolarization"
    },
    {
      "markdown": "![img-8.jpeg](img-8.jpeg)\n\nFig 8. MS disinhibition of parvalbumin-positive (PV+) interneurons induced theta oscillations in CA1. (A) Simulation setup. All neurons received a tonic depolarizing current in the presence of ACh (\"MS OFF\" condition). For a given period, an oscillatory hyperpolarizing current was injected into PV+ interneurons only (\"MS ON\" condition). (B) Example of simulation before and after the onset of disinhibition. LFP in black and theta-filtered LFP in gray. (C) Spectrogram for a range of ACh concentrations (top labels) and tonic depolarization levels (right labels). (D) PSD across different levels of tonic depolarization (right labels) with and without disinhibition. (E) CSD analysis across different ACh concentrations (top labels), with and without disinhibition. (F) Theta band power as a function of the amplitude of oscillatory hyperpolarizing current, ACh concentration, and level of tonic depolarization. B-E: Stimulus disinhibitory modulation amplitude of 0.2 nA. ACh, acetylcholine; CSD, current source density; LFP, local field potential; MS, medial septum; PSD, power spectral density."
    },
    {
      "markdown": "enhanced both theta harmonics and higher frequency components (Fig 8C and 8D). We observed that theta-band power was more dependent on the amplitude of the disinhibitory oscillation than on either ACh concentration or tonic depolarization level (Fig 8B and 8F). Therefore, we found MS-mediated disinhibition could strongly induce CA1 theta oscillations.\n\nDuring theta oscillations, the phase of spiking of different neuronal classes here divided into 2 main groups that were in anti-phase with each other (see Fig 9). As the level of tonic depolarization increased, more phase-locked cells were detected (Fig 9A) and only above 110\\% depolarization (where $100 \\%$ represents the depolarization necessary to reach spike threshold) were there a sufficient number of active interneurons to discern this dual grouping. Increasing ACh concentration tended to weaken pyramidal phase locking (Fig 9A). For example, at 120\\% depolarization and $1 \\mu \\mathrm{M}$ ACh, the firing of SP_PC, SP_Ivy, and SP_CCKBC cells was broadly tuned around the theta trough and rising phase, while the firing of SP_AA, BS and SP_PVBC neuron was more narrowly tuned around the peak of the theta rhythm (Fig 9B, left). Neurons with significant phase locking matched this pattern but were even more narrowly tuned (Fig 9B, middle). The phase locking of SP_AA, SP_Ivy and PC closely matched in vivo recordings (see S23 Table) but SP_BS and BC (CCK+ and PV+) were by comparison more than 90 degrees out of phase (Fig 9B, right).\n\nThe voltage traces and rate of spiking during theta oscillations for different neuronal types was also grouped. While SP_PC did not spike on every theta cycle their firing appeared weakly modulated by theta (Fig 9C, top). Whereas for interneurons, SP_AA, BS, and SP_PVBC spiked tightly for most cycles, ivy cells spiked more rarely and SP_CCKBC more tonically (Fig 9C, bottom). Intracellular voltage traces for SP_AA, BS, and SP_PVBC showed they spiked tightly on the rebound from the release of the hyperpolarizing stimulus, whereas SP_PC and other interneurons lacking this were less reactive to theta (Fig 9D, left). Notably, all neurons spiked at a lower average rate than in vivo recordings [76-79] (Fig 9D, right). The population synchrony of SP_PC with theta trough was consistent with in vivo data [81] for a range of disinhibitory stimulus amplitudes, whereas for fast-spiking interneurons like SP_AA and SP_PVBC, synchronization with theta peak only occurred with lower stimulus amplitudes (S28 Fig). Taken together, the MS-mediated disinhibition entrained theta oscillations under in vivo-like conditions, creating a diversity of firing phases between interneuron classes, close to what has been observed experimentally.\n\nIn summary, we used the reference model to investigate several possible mechanisms for theta oscillations. For intrinsic mechanisms, we found that spontaneous synaptic release and random afferent synaptic barrage did not induce detectable theta oscillations in the model, while tonic depolarization could induce a variable and unstable theta oscillation at 10 to 12 Hz . For extrinsic mechanisms, both CA3 and MS input induced a stable and stronger theta oscillation but in different ways, where MS disinhibition was more compatible with in vivo data.\n\n## Other frequencies\n\nNext we asked whether the reference circuit was capable of propagating gamma oscillation using the commonly used in vitro experimental paradigm of inducing them using bath carbachol (CCh) [85-88]. Specifically, we replicated the setup of [89], where the authors added CCh to generate oscillations in CA3, which were transmitted to CA1 via SC. The simulation conditions were tailored to these in vitro experiments (i.e., $300 \\mu \\mathrm{~m}$-thick slices, 2 mM extracellular $\\mathrm{Ca}^{2+}, 2 \\mathrm{mM}$ extracellular $\\mathrm{Mg}^{2+}, 10 \\mu \\mathrm{M} \\mathrm{ACh})$. We matched the shape and frequency of the input stimulus reported by [89] and followed the same LFP analysis methodology. We observed that gamma oscillatory SC input could entrain the entire CA1 network of the model slice to oscillate at the driving frequency ( 31 Hz ) (S29A Fig). As well as inducing oscillations in"
    },
    {
      "markdown": "![img-9.jpeg](img-9.jpeg)\n\nFig 9. MS disinhibition induced anti-phase modulation of CA1 neurons during theta cycles. (A) Neurons for analysis were selected within $100 \\mu \\mathrm{~m}$ radius of the stratum pyramidale electrode location (top left). Phase locking angle and strength for range of ACh concentration (columns) and levels of tonic depolarization (rows, where 100\\% represents the spike threshold) for modulation amplitude of $\\mathrm{A}=0.2 \\mathrm{nA}$. (B) Phase modulation. Spike discharge probability of all neurons grouped by morphological type (left). Phase-locked neurons tuning over theta cycle for each morphological class over a single theta cycle (middle). Experimental validation of phase locking against in vivo recordings (right) with an arrow representing the mean phase angle (experimental data = black arrow; simulated = colored arrow) and gray shaded sector indicating, where known, the experimental angular deviation. (C) Spiking raster plots. SP_PC cell spiking (top panel); LFP theta rhythm (trace above plot); interneuron spiking (bottom panel). Disinhibition is switched on (\"MS ON\") at"
    },
    {
      "markdown": "time 10 s . (D) Intracellular traces from morphological cell types (left) and validation against in in vivo recordings. B-D: Stimulus disinhibitory modulation amplitude of $\\mathrm{A}=0.2 \\mathrm{nA}, 1 \\mu \\mathrm{M}$ ACh and tonic depolarization $120 \\%$. Experimental values in panels B and D can be found respectively in 523 and 524 Tables. ACh, acetylcholine; LFP, local field potential; MS, medial septum.\nhttps://doi.org/10.1371/journal.pbio. 3002861 . g009\nCA3, in vitro CCh could alter the response of CA1 neurons to the SC input. Thus, to quantify the effect of CCh on CA1, we repeated the simulation without the influence of CCh. SC inputs, ranging from 15,000 to 100,000 stimulated fibers, were able to induce strong gamma oscillation in the absence of CCh. However, CCh increased the number of inputs needed for stable gamma oscillation, probably due to its weakening effect on synapses (S29B Fig). Therefore, at least for this experimental setup, the circuit was capable of propagating gamma oscillations.\n\nFinally, we investigated how the reference circuit behaved across a much wider range of SC input frequencies. Because the nature of the input was less clear across this range, we used a sinusoidal modulated stimulus. In this case, we isolated the role of SC input and we excluded the influence of modulators as ACh. In particular, we extended SC input for a wider range of cell ( 0.1 to 0.8 Hz ) and modulation frequencies ( 0.5 to 200 Hz ) and measured the corresponding input-output (I-O) gain and spike-spike correlation (Fig 10A). We found I-O gain was not uniform but depended on both cell and signal input frequencies (Fig 10B). The I-O responses of PC and interneurons were different, with interneuron gain greater at lower cell frequencies compared to PCs (Fig 10B). The strongest overall CA1 gain was obtained with a mean CA3 frequency of 0.4 Hz . The spike-spike correlation also depends on both cell and signal input frequencies (Fig 10C-10E, upper). In the case of input cell frequency of 0.4 Hz , we found CA1 spiking activity was strongly correlated for delta- to lower gamma-band input signal frequencies (i.e., between 1 and 30 Hz ) but weaker outside this range. Internal CA1-CA1 spike correlation was similar but spanned higher frequencies of the gamma-band (Fig 10C-10E, lower). Therefore, the model predicts that oscillations propagate better within the delta- to low gamma-band range.\n\n# Discussion \n\n## Main summary\n\nThis study presents the reconstruction and simulation of a full-scale, atlas-based reference model of the rat hippocampal CA1 region based on community data and collaboration. We extended and improved the framework of [27] to curate and integrate a wide variety of anatomical and physiological experimental data from synaptic to network levels. We then systematically applied multiple validations for each level of the model. We augmented the resulting highly detailed intrinsic CA1 circuit with a reconstruction of its main input from CA3 and a phenomenological model of neuromodulation by acetylcholine. Importantly, the reference circuit model is, by definition, general. It is capable of addressing a range of research questions because its parameters are adjusted only to different experimental setups, not tuned each time to specifically reproduce individual experimental results. For example, to help explain network activity observed in both health and disease, with the model one can block different neurotransmitters or specific groups of synapses, change the proportions of different cell types, modify synaptic strength or short-term plasticity, or alter the properties of ion channels in specific cell types to study their consequences on network dynamics. However, the range of the research questions it can address is necessarily limited by the current extent of the model and its inputs (see later). To demonstrate its general utility, we were able to simulate different scales of circuits and investigate the generation and transmission of neuronal oscillations, with particular emphasis on theta rhythm, for a variety of stimulus conditions."
    },
    {
      "markdown": "![img-10.jpeg](img-10.jpeg)\n\nFig 10. Intermediate frequencies propagate more efficiently through SC. (A) In silico experimental setup. (B) Ratio between the number of CA1 and CA3 spikes as a function of input cell and signal frequencies. We considered all CA1 neurons (left), CA1 PCs (center) and CA1 interneurons (right). (C) Heatmaps representing the computed STTC values as a function of input cell and signal frequencies, for CA3-CA1 and CA1-CA1 neurons. (D) Examples of CA3 and CA1 spike train (cell frequency of 0.4 Hz , signal frequency of 10 Hz ); 100 random CA3 neurons (i.e., SC fibers) and CA1 neurons are selected for clarity. The same neurons are used to compute the STTC and spike-spike correlations (panels D and E). (E) Spike-spike normalized correlation histograms for 4 signal frequencies (cell frequency of 0.4 Hz ) for CA3-CA1 and CA1-CA1 neurons. SC, Schaffer collaterals; STTC, spike time tiling coefficient.\nhttps://doi.org/10.1371/journal.pbio. 3002861 g010\n\n# Previous work and limitations \n\nWhile a full review of the many hippocampal circuit models is beyond the scope of the paper, we focus on the progression in both the size and level of detail of large, multiscale models of the rat hippocampus during the last 3 decades (for a comparison of their key features with the present model, see S2 Table). These biologically realistic models aim to explain the complex dynamics of hippocampal activity, in particular the generation and control of rhythmic responses. However, all these models, including the one reported here, are incomplete descriptions of a hippocampal region or regions because of the paucity or even absence of some types of data necessary to constrain them. Moreover, the results of these models are difficult to compare because (1) there is no commonly agreed-upon set of validations with which to benchmark a circuit model against experimental data; and (2) there are fundamental differences in their composition, organization, and underlying assumptions.\n\nIn terms of model validation, circuit models of isolated CA1 have, ever since the reports of [72], been expected to generate theta oscillations intrinsically (see [22]). Later research by the same lab, however, raises some doubts about this interpretation of the results. In an isolated whole mouse hippocampal preparation, as used by [72], [90] found that inactivating the subiculum abolished theta ( 5 Hz ) activity in CA1 and the remaining 2.5 Hz oscillations in CA1 matched that of intact CA3 (see their S6 Fig). So the theta oscillations in isolated CA1 observed in [72] might be explained if the subiculum was not removed when isolating CA1 from CA3 (see S10 Fig of [72]). Therefore, these later results imply that CA1 may not be able to generate robust theta oscillations intrinsically but instead its oscillations are induced by subiculum and"
    },
    {
      "markdown": "CA3 inputs, which is what we observed here for CA1 circuit model for CA3 input simulations. Yet, while it is clear from the current model that different mechanisms can generate CA1 theta oscillations (degeneracy; for a review of this concept, see [91]), the cell-class specific phasing of spiking of circuit neurons during theta LFP oscillations does not offer a good overall match to in vivo experimental results [77-79,92].\n\nIn terms of model construction, the current model stands out by realistically constraining neurons and their connectivity by the highly curved shape of CA1 rather than by relying on an artificial space as found in other contemporary models. Additionally, it reflects both STP and spontaneous synaptic release, well-established characteristics of central nervous system synapses. In addition, the morphologies and electrical properties of model neurons here are not just copies of the same class exemplars but their properties have been systematically varied to better capture the diverse nature of neuronal circuits and their responses to stimulation. However, compared with [22], some elements are still missing from the current model such as neurogliaform cells, which did not exist in our available data set, and $\\mathrm{GABA}_{B} \\mathrm{R}$ which are not included in our simulations. Yet, neither the current model nor [22] incorporates other established features of CA1 such as dorsal-ventral differences in neuronal and synaptic properties [93] or burst firing of pyramidal neurons [94].\n\nNonetheless, the current model includes the perforant path-associated and trilaminar interneurons, which were absent from all previous models. In addition, we modeled the NMDA synaptic currents observed in both hippocampal pyramidal cells and interneurons (with specific NMDAR conductance, rise and decay time constants for each pathway) that are absent in the model of [22]. Furthermore, the connectivity algorithm used for the current model generates an intrinsic connectome with more realistic high-order statistics than the more prescriptive approach used in the [22] model (see [42] for the analysis). Unlike [24], we did not replicate the topography of the afferent projections, which may play a role in patterning the circuit response, but did model the projections and circuit at a full rather than reduced scale. Overall, further improvement to our model requires additional experimental data.\n\nWhile we incorporated key features distributed among previous models into a single, general model (see S2 Table), it is important to recognize that our aims and approach were different, representing a step change in hippocampal modeling. The intention of the framework was first to curate and integrate community data into the model, preserving provenance for reproducibility, in a way that would allow the addition of new datasets from the large hippocampal community. Re-using these data sets and then making them publicly available through the hippocampushub.eu supports the 3R principles (replace, reduce, refine) for the reduction of animal experiments. Each circuit component and the final model was then systematically validated in an open and transparent way to a degree not previously attempted by other research groups. To increase the realism and utility of simulation experiments, we sought to approximate experimental conditions (e.g., slice thickness and location, bath calcium, magnesium and acetylcholine concentrations, and recording temperature) and to increase the capability to manipulate and record from the model (e.g., enable spontaneous synaptic release, alter connectivity, estimate extracellular LFP signals, and apply a variety of stimuli). In short, the aim was to offer a more realistic yet scalable and sustainable approach to model brain regions at full scale.\n\n# Lessons learned \n\nIn the context of a community effort, the process of curating and integrating available data to reconstruct a brain region and replicating the experimental conditions in silico proved instructive in a number of ways. First, assembling the components to reconstruct a brain region"
    },
    {
      "markdown": "reveals surprising gaps in the available data and knowledge. Notably, for example, while Schaffer collateral input to CA1 has received many decades of attention, especially in terms of longterm plasticity, we found the basic information needed to model this pathway quantitatively, was limited. To address this gap, we devised a multi-step algorithm constrained by the data that were available to parameterize these connections. Second, when data was available it often required further work before it could be used in the model. While an open-source rat hippocampal atlas [39] was crucial to reconstruct CA1, the original volumetric reconstruction was too noisy for our purposes and required additional processing to give smooth layering. This smoothness was necessary to place and orient morphologies accurately in the atlas in relation to the layers. If the morphology was incorrectly placed or oriented, this had a knock-on effect for how the circuit was connected. Similarly, the completeness of morphological reconstructions also affected connectivity. For these reasons, some cell types in our available data set could not be used in the circuit model, sacrificing a small amount of cell type diversity in favor of completeness. Third, setting up simulations to reproduce the desired experimental conditions required careful attention. We offer 2 examples from our research. When reproducing the I-O gain of SC afferent input reported in [56], we initially sampled all neurons in the model slice to plot to the I-O curve. However, the result was poor. We later resolved this by reproducing how the neurons were sampled in the experiments with which we could closely match the empirical curve. When reproducing MS-induced theta oscillations, we initially simulated under default conditions of extracellular calcium concentration at 2 mM , resulting in theta oscillations that occurred episodically and only for a restricted parameter regime. However, when we lowered the extracellular calcium to in vivo levels ( 1 mM ), sparser activity led to more robust and stable theta oscillations.\n\n# A community-based modeling approach \n\nThe model was built and simulations run through the cooperation of several laboratories each with different expertise. Since we could not access a standardized core set of data made for the purpose of modeling as done previously [27-29], instead, we curated and integrated data from collaborating labs which followed different protocols. The majority of single neuron morphologies and recordings, for example, came from University College London (UCL) [76,95-102]. From these data, single neuron models were created between the Blue Brain Project (BBP) and Italian National Research Council (CNR) [35] and these were then validated by a computational lab at Institute of Experimental Medicine, Budapest (KOKI) [103]. Similarly, physiological data from paired recordings that characterized individual synaptic pathways were provided by an experimental lab in KOKI and then curated and integrated together with BBP [34]. Subsequently, BBP used these single neuron and synapse models to build and share the circuit model so computational labs at BBP, CNR, and KOKI could simulate various hippocampal use cases, only some of which have been presented here. Combining the framework of [27] with community data and collaboration resulted in the generalization and improvement of data curation and integration methods for more varied data, improvements in tools like BluePyOpt for optimizing neurons, and the development of a new tools such as HippoUnit to systematically validate and compare different single neuron models.\n\nThis approach offers important features that make an attractive case for adoption by the wider hippocampus community. First, anchoring a circuit model in the volumetric space of a brain region atlas makes mapping experimental data for data integration, validation, and prediction easier than for more abstract spaces and permits investigations at different scales, e.g., a brain slice cut at an arbitrary angle. The Allen Brain Atlas has demonstrated the advantages of registering community experimental data in a common reference atlas [104]. Extending this"
    },
    {
      "markdown": "principle, a common framework appears advantageous for modeling as well. Second, the model components, validations, and circuit are openly available through a dedicated portal (hippocampushub.eu) to maximize transparency and reproducibility. We allow the community to examine how the reference circuit model was built, validated, simulated, and analyzed. We conceived the model to be adopted by the community, extended and improved. Third, while the traditional approach of constructing circuits for a specific use case has short-term advantages for demonstrating proof-of-concept, in the long-term a community reference model must be valid across a range of use cases.\n\nTo illustrate its utility, we suggest how the circuit model could be developed by the community to help address key scientific questions concerning structure and function of hippocampus. An example use case under in vitro-like conditions could be to use slice circuit models to study network responses to different stimuli based on observed difference in neuronal and synaptic properties between dorsal and ventral CA1 [93]. Under in vivo-like conditions, the full-scale circuit model could be employed to investigate the factors necessary for the emergence of traveling and standing wave phenomena reported from CA1 LFPs [105]. To increase the level of biological accuracy at the cellular level, for example, a new class of neurons might be added to the circuit (for practical steps required, see S1 Appendix). To achieve greater accuracy at the circuit level, particularly in investigating place cells, significant additions would be necessary to match the current level of biological accuracy in the model. In particular, the anatomy and function of the perforant pathway (PP) would need to be reconstructed using available empirical data as we did here for the SC pathway. This would involve understanding quantitatively the synaptic connectivity and unitary monosynaptic EPSPs from individual PP axons onto CA1 neurons, ideally from single neuron paired recordings. Additionally, the simulation patterns of these PP and SC projection axons would need to reflect the activity of EC and CA3 neurons during rat locomotion to activate place cells realistically. Finally, to model the formation and remapping of place cells, model synaptic connections would need to be endowed with long-term plasticity (e.g., [106]). While the level of effort required is significant, the potential benefits of creating a model-experiment loop, where experimental data are incorporated in the model (experiments to model) and model results used to generate experimentally testable predictions (model to experiments) should not be underestimated in minimizing the cost in terms of animals and materials.\n\n## Methods\n\n## Experimental procedures\n\nIn this study, we used 2 data sets for single neuron morphological reconstructions and electrophysiological recordings from the region CA1: Sprague Dawley rat and Wistar rat. Both data sets also include the reconstruction of the layers that were used to estimate the layer thicknesses (see section Layers) and guide the cell placement (see section Soma placement). Note that, while the Wistar rat data set also includes electrophysiological recordings, we did not use them for this model. The experimental procedures have been previously described in [35], but are summarized below.\n\n## Sprague Dawley rat data set\n\nProcedures involving animal care and use were approved by the University of London or University College London ethical committees and by the British Home Office with regard to the Animal Scientific Procedures Act 1986 (PPL 80/2131, 80/2598). Hippocampal slices were obtained from young adult rats (Sprague Dawley, 90 to 180 g ) as previously described [76,95102]. Briefly, following deep anesthesia with euthatal solution, young adult rats (Sprague"
    },
    {
      "markdown": "Dawley, 90 to 180 g ) were perfused transcardially with ice-cold modified artificial cerebrospinal fluid containing in mM : 248 sucrose, $25.5 \\mathrm{NaHcO}_{3}, 3.3 \\mathrm{KCl}, 1.2 \\mathrm{KH}_{2} \\mathrm{PO}_{4}, 1 \\mathrm{MgSO}_{4}, 2.5$ $\\mathrm{CaCl}_{2}, 15$ D-glucose, equilibrated with $95 \\% \\mathrm{O}_{2} / 5 \\% \\mathrm{CO}_{2} ; 450$ to $500 \\mu \\mathrm{~m}$ coronal sections were cut, transferred to an interface recording chamber and maintained at $34-36^{\\circ} \\mathrm{C}$ in modified ACSF solution for 1 h and then in standard ASCF (in mM: $124 \\mathrm{NaCl}, 25.5 \\mathrm{NaHCO}_{3}, 3.3 \\mathrm{KCl}$, $1.2 \\mathrm{KH}_{2} \\mathrm{PO}_{4}, 1 \\mathrm{MgSO}_{4}, 2.5 \\mathrm{CaCl}_{2}$, and 15 D -glucose, equilibrated with $95 \\% \\mathrm{O}_{2} / 5 \\% \\mathrm{CO}_{2}$ ) for another hour prior to starting electrophysiological recordings. Single intracellular recordings were made using sharp microelectrodes (tip resistance, 90 to 190 M 2 ) filled with $2 \\%$ biocytin in $2 \\mathrm{M} \\mathrm{KMeSO}_{4}$ under current-clamp (Axoprobe; Molecular Devices, Palo Alto, California, United States of America). Electrophysiological characteristics of the recorded neurons were obtained from voltage responses to 400 ms current pulses between -1 and +0.8 nA and recorded with pClamp software (Axon Instruments, USA).\n\nFollowing recording and biocytin filling, slices of 450 to $500 \\mu \\mathrm{~m}$ were fixed overnight [ $4 \\%$ paraformaldehyde (PFA), $0.2 \\%$ saturated picric acid solution, $0.025 \\%$ glutaraldehyde solution in 0.1 M phosphate buffer] as previously described [97,107]. Slices were then cut in 50 to 60 $\\mu \\mathrm{m}$ sections, cryoprotected with sucrose, freeze-thawed, incubated in $1 \\% \\mathrm{H}_{2} \\mathrm{O}_{2}$ and then in $1 \\%$ sodium borohydride ( NaBH 4 ). Slices were incubated overnight in ABC (Vector Laboratories) and then in DAB ( $3,3^{\\prime}$ diaminobenzidine, Sigma) to reveal the morphology of the recorded neurons. Following washes, sections were postfixed in osmium tetroxide $\\left(\\mathrm{O}_{6} \\mathrm{O}_{4}\\right)$, dehydrated, cleared with propylene oxide, mounted on slides (Durcupan epoxy resin, Sigma), and cured for 48 h at $56^{\\circ} \\mathrm{C}$. For immunofluorescence staining, slices were incubated in $10 \\%$ normal goat serum after incubation with $\\mathrm{NaBH}_{4}$. Sections were then incubated overnight in a primary antibody solution containing mouse anti-PV (Sigma), rabbit anti-PV [108] or mouse anti-gastrin/ CCK (CURE, UCLA) made up in ABC and then in a solution of secondary antibodies (Avi-din-AMCA, FITC and anti-rabbit Texas Red) for 3 h . Following fluorescence visualization, slices were incubated in $\\mathrm{ABC}, \\mathrm{DAB}$, and $\\mathrm{OsO}_{4}$ prior to dehydration and mounting as described above. All neurons were then reconstructed in 3D using a Neurolucida software (MBF Bioscience) and a $100 \\times$ objective as previously described [107].\n\n# Wistar rat data set \n\nThe project was approved by the Swiss Cantonal Veterinary Office following its ethical review by the State Committee for Animal Experimentation. All procedures were conducted in conformity with the Swiss Welfare Act and the Swiss National Institutional Guidelines on Animal Experimentation for the ethical use of animals (license VD3389). Hippocampal slices were obtained from young adult rats (Wistar, postnatal 14 to 23 days) as previously described [27,35]. In brief, ex vivo coronal preparations ( $300 \\mu \\mathrm{~m}$ thick) were cut in ice-cold aCSF (artificial cerebrospinal fluid) with low $\\mathrm{Ca}^{2+}$ and high $\\mathrm{Mg}^{2+}$. The intracellular pipette solution contained (in mM) 110 potassium gluconate, $10 \\mathrm{KCl}, 4$ ATP-Mg, 10 phosphocreatine, 0.3 GTP, 10 HEPES and 13 biocytin, adjusted to $290 \\pm 300 \\mathrm{mOsm} / \\mathrm{Lt}$ with D-mannitol ( $2 \\pm 35 \\mathrm{mM}$ ) at pH 7.3. Chemicals were from Sigma Aldrich (Stenheim, Germany) or Merck (Darmstadt, Germany). A few somatic whole cell recordings (not used for this model) were performed with Axopatch 200B amplifiers in current clamp mode at $34 \\pm 1^{\\circ} \\mathrm{C}$ bath temperature.\n\nThe 3D reconstructions of biocytin-stained cell morphologies were obtained from wholecell patch-clamp experiments on $300 \\mu \\mathrm{~m}$ thick brain slices, following experimental and postprocessing procedures as previously described [109]. The neurons that were chosen for 3D reconstruction were high contrast, completely stained, and had few cut arbors. Reconstruction used the Neurolucida system (MicroBrightField, USA) and a bright-field light microscope (DM-6B, Olympus, Germany) at a magnification of 100× (oil immersion objective, 1.4 to 0.7"
    },
    {
      "markdown": "NA). The finest line traced at the $100 \\times$ magnification with the Neurolucida program was $0.15 \\mu \\mathrm{~m}$. The slice shrinkage due to the staining procedure was approximately $25 \\%$ in thickness (Z-axis). Only the shrinkage of thickness was corrected at the time of reconstruction.\n\n# Morphological classification \n\nWe classified the morphologies into one of 12 different morphological types (m-types) based on the layer containing their somata and their morphological features. For the classification, we adopted 3 main assumptions. (1) Several subtypes of PCs have been described [108,110116], but for simplicity we consider the pyramidal cells as a uniform class (SP_PC or simply PC). (2) SP_PVBC and SP_CCKBC were classified as 2 separate m-types. The 2 types of basket cells can be distinguished by biochemical markers and electrical properties, and they show different densities and connectivity [5]. On the contrary, there is no strong evidence for differences in their morphologies and the small number of examples in our possession (3 SP_PVBCs, 1 SP_CCKBCs) prevented us from conducting any systematic classification. While we could have pulled the 2 cell types into one m-type, we kept them separated for the sake of simplicity. (3) We created supersets of m-types based on their principal biochemical marker. In particular, we defined PV+ cells as SP_PVBC, SP_BS, SP_AA, CCK+ cells as SP_CCKBC, SR_SCA, SLM_PPA and SOM+ (somatostatin) cells as SO_OLM, SO_BS, SO_BP, SO_Tri. When the layer is not specified (e.g., BS), we meant all the neurons of this type regardless their soma location.\n\n## Morphology curation\n\nWe curated the morphological reconstructions extensively prior to insertion in the network model. First, we translated the reconstructions to have their somas centered at coordinates $(0,0,0)$. We reoriented the reconstructions so that their $x, y$, and $z$ axes coincided respectively with the transverse, radial, and longitudinal axes they followed in the tissue. We considered the cells to be substantially complete, with only a few cuts, so we have not applied any corrections for cuts [27]. The only exception is the PC axon. One particular reconstruction has a relatively long axon $(3,646 \\mu \\mathrm{~m})$ that spans $1,325 \\mu \\mathrm{~m}$ along the transverse axis. We assumed this axon to be relatively complete within the CA1 and we used it as a prototype for all the PCs. Validation of the number of synapses per connection, bouton density, and connection probability showed that this assumption is reasonable (see section Building CA1). A subsequent cloning procedure (see section Morphology library) guaranteed that all the PC axons are unique. We removed 2 pyramidal cells due to the complete absence of an axon since at least the axon initial segment (AIS) needs to be present to create electrical models.\n\nWe applied a series of corrections as described in [27]. In brief, to comply with the NEURON and CoreNEURON standards, we repaired the reconstructed morphologies using NeuroR [117] (Table 1). In particular, we used this tool to remove unifurcations of dendrites, fix neurites whose type changes along its main branch, fix invalid formats of soma, and remove segments with close to zero length. We used this tool also to correct tissue shrinkage. The correction increased the neurite reach approximately $25 \\%$ along the z-axis and approximately $10 \\%$ along the x - and y -axes.\n\n## Morphology library\n\nTo produce morphology variants that fit well in different locations of the space, we applied scaling $\\pm 15 \\%$ of the original reconstructions. This range was a good compromise between the need to change the size but yet to not introduce too much distortion [27]. To increase morphological diversity, we applied a cloning procedure as described in [27]. Some clones showed a"
    },
    {
      "markdown": "Table 1. List of software used.\n\n| Software name | Source | Identifier |\n| :--: | :--: | :--: |\n| atlas-direction-vectors | BBP/EPFL software package | https://github.com/BlueBrain/atlas-direction-vectors |\n| bbp-workflow | BBP/EPFL software package | https://github.com/BlueBrain/bbp-workflow |\n| BluePySNAP | BBP/EPFL software package | https://github.com/BlueBrain/snap |\n| BluePyEfe | BBP/EPFL software package | https://github.com/BlueBrain/BluePyEfe |\n| BluePyOpt | BBP/EPFL software package | https://github.com/BlueBrain/BluePyOpt |\n| BluePyMM | BBP/EPFL software package | https://github.com/BlueBrain/BluePyMM |\n| Brainbuilder | BBP/EPFL software package | https://github.com/BlueBrain/brainbuilder |\n| Brayns | BBP/EPFL software package | https://github.com/BlueBrain/Brayns |\n| circuit-build | BBP/EPFL software package | not yet open source |\n| CoreNEURON | BBP/EPFL software package | https://github.com/BlueBrain/CoreNeuron |\n| eFEL | BBP/EPFL software package | https://github.com/BlueBrain/eFEL |\n| Elephant | Elephant authors and contributors | https://doi.org/10.5281/zenodo.1186602 |\n| EMSim | BBP/EPFL software package | https://github.com/BlueBrain/EMSim |\n| Hippounit | KOKI software package | https://github.com/KaliLab/hippounit |\n| ITK-SNAP | University of Pennsylvania | http://www.itksnap.org/ |\n| morphology-workflows | BBP/EPFL software package | https://github.com/BlueBrain/morphology-workflows |\n| mtspec | pypi python package | https://pypi.org/project/mtspec/ |\n| neo | The NeuralEnsemble Initiative | https://github.com/NeuralEnsemble/python-neo |\n| Neurodamus | BBP/EPFL software package | https://github.com/BlueBrain/neurodamus |\n| NeuroMorphoVis | BBP/EPFL software package | https://github.com/BlueBrain/NeuroMorphoVis |\n| NeuroM | BBP/EPFL software package | https://github.com/BlueBrain/NeuroM |\n| NeuroR | BBP/EPFL software package | https://github.com/BlueBrain/NeuroR |\n| projectionizer | BBP/EPFL software package | https://github.com/BlueBrain/projectionizer |\n| psp-validation | BBP/EPFL software package | https://github.com/BlueBrain/psp-validation |\n| regiodesics | BBP/EPFL software package | https://github.com/BlueBrain/regiodesics |\n| TMD | BBP/EPFL software package | https://github.com/BlueBrain/TMD |\n| voxcell | BBP/EPFL software package | https://github.com/BlueBrain/voxcell |\n\nhttps://doi.org/10.1371/journal.pbio.3002861.6001\nwrong distribution of axons and dendrites, and we removed them. In particular, we annotated how different parts of the morphology were positioned within the layers (see section Layers). We used these annotations to guide the cell placement, but it was also useful to discard cells that were too distorted by cloning and had an incorrect distribution of neurons within the layers. Clones were further validated by visual inspections. For OLM cells, a scaling of $\\pm 15 \\%$ was not sufficient to make sure that the axon correctly targeted SLM in all dorso-ventral positions. In this case, we introduced a synthetic axon. In the reconstruction of OLM cell, a chunk of $60 \\mu \\mathrm{~m}$ axon, which is placed at 85 to $145 \\mu \\mathrm{~m}$ from the soma, falls in SR and it is relatively simple. To produce morphologies with about $90 \\%$ to $150 \\%$ (step of $5 \\%$ ) of the height of the original morphology, we removed the aforementioned chunk of $60 \\mu \\mathrm{~m}$ axon ( $93 \\%$ ), only $45 \\mu \\mathrm{~m}$ of it ( $95 \\%$ ), or added a multiple of $45 \\mu \\mathrm{~m}$ (corresponding to a step of $5 \\%$ ) synthetic axon within SR until we reached a $150 \\%$ scaling.\n\nAfter we corrected the orientation of the initial set of reconstructions, the cloning procedure changed the branch lengths and rotations, which may have resulted in a change in the main orientation of the cells. Based on visual inspection, the effect on short neurites was negligible. In the case of PCs, the axon is relatively longer and has a clear orientation [118]. In this case, the cloning may significantly alter the orientation of the axon, and this may result in a wrong placement in the circuit (see section Soma placement). To avoid this problem, we"
    },
    {
      "markdown": "renormalized the orientation of the cloned PCs. In particular, we used principal component analysis (PCA) to first determine the principal axis of all axonal points in each cloned morphology. Next, we used the direction of the principal axis to rotate the caudal portion of the arbor onto the x -axis so all pyramidal axon arbors were aligned in the same direction. Finally, to remove an unrealistic degree of variability, we filtered out cloned morphology outliers whose width (z-axis range) was 3.3 times greater than that of the original pyramidal axon arbor from which they were derived. This filtering step rejected about $14 \\%$ of all pyramidal cell cloned morphologies.\n\n# Morphology library validation \n\nNeuronal morphologies were validated at the end of the processing stage (cloning) by comparison of their morphological properties, as well as their topological profiles. Around 100 morphological features from dendritic and axonal neurites were extracted using the NeuroM package [119]. The median over visible spread (MVS) statistical score, defined as the ratio of the absolute value of the difference between the medians of the feature $(\\bar{F})$ divided by the overall visible spread (OVS), was computed according to the following formula:\n\n$$\nM V S(F)=\\frac{\\left|\\bar{F}_{P_{r}}-\\bar{F}_{P_{r}}\\right|}{O V S\\left(F_{P_{r}}, F_{P_{r}}\\right)}\n$$\n\nto identify the difference between populations of reconstructed $P_{r}$ and cloned $P_{r}$ neurons for each feature $F$. This score is close to zero for similar populations and increases as the difference between the populations increases. Scores below 0.3 indicate good agreement between the 2 populations as their differences are contained within 3 standard deviations (STD). Note that this measurement depends on the sample size, due to the computation of the OVS, which remains small if the sample size is small and therefore the MVS score increases accordingly.\n\nIn addition to the traditional morphometrics, the topological profiles of the original reconstructions were compared to those of the processed morphologies (repaired and cloned). The TMD encodes the start and the end radial distances of each branch from the soma surface [120]. The pairs of distances (start, end) are represented in a 2D plane, a representation known as the persistence diagram of the neurons (S6 Fig). The Gaussian kernels of these points are averaged to generate the persistence images (S7 and S8 Figs). The persistence images of 2 populations can be subtracted to study the precise differences between data sets. Note that the robustness of average persistence images depends on the sample size of the population, when only few (less than 3) cells are available these images represent a small subset of the biological population and are therefore not quantitatively reliable.\n\n## Electrical type classification\n\nWe classified the cells into different electrical types (e-types) based on their firing patterns as defined by the Petilla nomenclature [33]. Some of the firing patterns (i.e., irregular patterns) were too rare and we excluded them. For SP_CCKBC we do not have traces, and we considered them to be classical accommodating (cAC) [96].\n\n## Morpho-electrical compositions\n\nThe 154 recordings were recorded from different m-types, and we observed that each m-type can show one or more firing patterns with different probabilities. We used this information to derive the morpho-electrical type (me-type) composition (S4 Table)."
    },
    {
      "markdown": "# Ion channels \n\nWe considered a set of active membrane properties which included a voltage-gated transient sodium current, 4 types of potassium current (DR-, A-, M-, and D-type), 3 calcium channels (CaN, CaL, and CaT), a nonspecific hyperpolarization-activated cation current (Ih), 2 Ca dependent potassium channels ( KCa and Cagk), and a simple $\\mathrm{Ca}^{2+}$-extrusion mechanism with a 100 ms time constant. We based channels' kinetics on previously implemented cell models of hippocampal neurons [121-124].\n\n## Single-neuron modeling\n\nSingle-cell models are described in previous publications [34,35,125]. In brief, we optimized cell parameters to match electrophysiological features rather than the traces directly. We extracted features using the open-source Electrophys Feature Extraction Library (eFEL, Table 1) or the Blue Brain Python E-feature extraction (BluePyEfe, Table 1). Initial optimizations considered only features from somatic recordings [35], while a subsequent refinement included also the amplitude of the back-propagating action potential (in the apical trunk, 150 and $250 \\mu \\mathrm{~m}$ from the soma) for PCs [34].\n\nWe assumed channels were uniformly distributed in all dendritic compartments except $K_{A}$ and $I_{b}$, which in pyramidal cells are known to increase with distance from the soma [126,127]. Pyramidal cells include $K_{M}$ in the soma and axon [128], $K_{A}$ with different kinetics in dendrites, soma and axon [121,129], $K_{M}$ with a different kinetics in the soma and the axon, Na and $K_{D R}$, whereas they do not include $K_{D}$ since the delayed spiking is not a feature observed in PCs. Given the limited knowledge of the currents in interneurons, we applied the same currents of pyramidal cells with the following exceptions. Dendritic sodium channel densities decay exponentially with distance from the soma (with a length constant of $50 \\mu \\mathrm{~m}$ ) based on [130]. We included $K_{D}$ since some interneurons show delayed firing. $K_{A}$ has the same kinetics in somas and dendrites because there is no experimental evidence of a different $K_{A}$ kinetics in the dendrites of interneurons. We distinguished 2 types of $K_{A}$ for proximal and distal dendrites [121]. For both pyramidal cells and interneurons, we optimized channel peak conductance independently in the different regions of a neuron (soma, axon, and dendrites).\n\nWe performed a multi-objective evolutionary optimization using the open source Blue Brain python optimization library (BluePyOpt, Table 1) [131] to obtain 39 single-cell models. From this set, we excluded 3 models because their me-types are not used in the network model (cAC_SP_Ivy, cAC_SP_PVBC, cNAC_SR_SCA).\n\n## Single neuron model validations\n\nWe used HippoUnit [103] (Table 1) to validate the electrical models of pyramidal neurons, specifically considering the attenuation of PSP and BPAP.\n\n## PSP attenuation\n\nThe PSP attenuation test evaluates how much PSP amplitude attenuates as it propagates from different dendritic locations to the soma. To get the behavior from the model, EPSC-like currents (i.e., double exponentials with rise time constant of 0.1 ms , decay time constant of 3 ms , and peak amplitude of 30 pA ) were injected into the apical trunk of PCs at varying distances from the soma ( $100,200,300 \\pm 50 \\mu \\mathrm{~m}$ ), and PSP amplitudes were simultaneously measured at the local site of the injection and in the soma. Finally, the experimental and model data points were fitted using a simple exponential function. The space constants resulting from the fitting were then reported and compared with experimentally observed data in [37]."
    },
    {
      "markdown": "# BPAP attenuation \n\nThe BPAP test evaluates the strength of AP back-propagation in the apical trunk at locations of different distances from the soma. The AP is triggered by a step-current of 1 s with an amplitude for which the soma fires at approximately 15 Hz . The values were then averaged over distances of $50,150,250,350 \\pm 20 \\mu \\mathrm{~m}$ from the soma. We measured the amplitudes of the first AP at the 4 different dendritic locations and compared them with experimentally observed data in [36].\n\n## Library of neuron models\n\nOptimizing all the neurons in the morphology library is computationally expensive. Following [27], we minimized the problem by using Blue Brain Python Cell Model Management (BluePyMM, Table 1) which combines the morphology library with initial single-cell models to produce a library of cell models. The procedure accepts a new combination if the model and experimental features are within 5 STD of the experimental feature. If at least 1 feature is greater than this range, then the new combination is excluded. This strategy also has the advantage of increasing the model variability within the experimental data. In the case of bAC-SLM_PPA, the threshold for accepting new combinations had to be relaxed to 12 STD to obtain some valid models.\n\n## Rheobase estimation\n\nFor all the single-cell model combinations, we estimated their rheobase with a bisection search until an accuracy of e-3 was reached. The spikes were recorded at the AIS, and the upper bound from the last step of the search was used, to ensure cells spiked in the axon at rheobase.\n\n## Atlas\n\nVolume. We based our annotated volume on a publicly available atlas of the CA1 region [39] (http://cng.gmu.edu/hippocampus3d/). From the original atlas, we took all voxels labeled as CA1 without maintaining their subdivisions in CA1a, CA1b, and CA1c or the 4 layers (S10A Fig). The original file was converted from a csv to a nrrd format using voxcell (Table 1).\n\nWe undertook a series of post-processing steps to augment the atlas with a coordinate system and vector fields that followed the 3 hippocampal axes (longitudinal, transverse, radial). First, a substantial smoothing operation was necessary to render the surfaces within the CA1 regular enough for subsequent manipulations. To obtain smoother surfaces, we applied a Gaussian filter together with a morphological closing filter. A few manual checks were needed to ensure isolated voxels were removed and holes from missing tissue closed. The resulting volume has a minor difference in voxel counts compared with the original atlas ( $-3.7 \\%$ ) (S10B Fig).\n\nWe created a mesh for the boundary surface of the CA1 using Ultraliser (Table 1) and separated it into an upper and lower shell (S10C Fig). In practice, the operation of separating the mesh into 2 portions is challenging and we were not able to automate it. The curved structure of the hippocampus makes automatic solutions appear incorrect upon visual inspection, particularly around the ridges. Taking the results into account, we used an OpenGL 3D graphical user interface tool (atlas-direction-vectors, see Table 1) that allows one to paint voxels on the surface of the atlas in different colors. It enabled us to manually correct the voxel selection until the shell division appeared satisfactory. Two surface meshes were then derived from the selected voxel masks.\n\nWe generated a polygonal centerline along the innermost voxels of the CA1 from the dorsal to the ventral extremity (S10D Fig). In detail, this process started by computing the distance"
    },
    {
      "markdown": "transform of the input volume by assigning each voxel the distance from its closest neighbor outside of the volume. The 2 extremity points were used as entry and exit locations to build a stochastic chain of points following the local maxima of the distance transform. A further step generated a graph of these possible points using proximity conditions and determined the overall shortest path between the extremities using a weighted Dijkstra algorithm [132]. The resulting skeleton of the centerline was then converted into a Bézier curve [133] and its continuous derivative was used to orient a series of planes. These planes are oriented perpendicularly to the curve and cut the volume of the hippocampus in slices at regular intervals (S10E Fig).\n\nCoordinates system. To utilize the 3D volume fully, we created a set of parametric coordinates ranging from 0 to 1 and named them $l, t, r$ as they follow the longitudinal, transverse, and radial axes of the hippocampus (S10F Fig). The longitudinal coordinate was assigned first using the derivative of the centerline to sample the volume with many cross-section planes and assigning each CA1 voxel the $[0,1]$ value of the plane closest to it.\n\nThe transverse coordinate was obtained by considering the intersection between each of the cross-section planes and the meshes assigned previously as the upper and lower shells of the volume. Each plane cuts the meshes creating 2 lines of points which were fitted to spline functions and re-sampled to yield the same number of points each having a $[0,1] u$ coordinate. Connecting the upper to the lower line points resulted in a field of vectors that represent the natural orientation of pyramidal neurons in CA1. The transverse coordinate $t$ was assigned from the $u$ value of the spline points to all voxels found on the plane according to which was their closest vector (i.e., the line segment joining the upper usp $(u)$ and lower $l s p(u)$ line points with the same $u$ ).\n\nThe radial coordinate was assigned following the previous step and represents the relative $[0,1]$ location of each voxel of the plane along the segment connecting the usp $(u)$ and $l s p(u)$ points. It is defined as the ratio:\n\n$$\n\\frac{\\|u s s(p), v o x e l\\|}{\\|u s s(p), l s s(p)\\|}\n$$\n\nIn summary, all voxels lying on the same $l$ plane are assigned a $t$ coordinate from the upper and lower splines and later those voxels on the same $t$ segment are assigned a relative $r$ position along it. Taken together, these 3 coordinates provide a coherent system to slice and parse the volume which is more robust to surface irregularities compared to other methods. Finally, for each voxel we re-computed its direction vector from the partial derivative of the $(l, t, r)$ coordinates with respect to $r$ to ensure perfect correspondence between the vector field and coordinate space (S10G Fig).\n\nLayers. Having achieved the necessary smoothing and orientations over the entire volume, we reintroduced the distinction into layers (S10H Fig) that are used to constrain cell density and the placement of specific portions of neural morphologies such as the axon and the apical dendritic tuft (S11 Fig). For this reason, we used a combined approach to determine layer position: extracting thicknesses from morphology reconstructions and comparing the final layer volumes with voxel counts from the original atlas. During morphology reconstruction, we traced layer thicknesses from 23 images of pyramidal cells in CA1 slices and averaged them: SLM: $146 \\pm 27 \\mu \\mathrm{~m}$, SR: $279 \\pm 40 \\mu \\mathrm{~m}$, SP: $59 \\pm 15 \\mu \\mathrm{~m}$, SO: $168 \\pm 30 \\mu \\mathrm{~m}$.\n\nThe available morphological reconstructions came from the dorsal CA1, and thus these layer thicknesses reflect the dorsal portion rather than the entire extent of the region. To reintroduce layer labels back into the atlas, we used the radial coordinate computed above to assign a uniform proportion of voxels to each layer (SLM: 0.224, SR: 0.42791, SP: 0.090, SO: 0.258). This assumption returns the same relative layer thickness throughout the volume,"
    },
    {
      "markdown": "automatically compensating for the different CA1 shape in each location thanks to the $[0,1]$ parametric range. As a final step, we computed the total volumes for each layer (SLM: 3.2143, SR: 6.8421, SP: $1.5789, \\mathrm{SO}: 4.8178 \\mathrm{~mm}^{3}$ ).\n\n# Cell composition \n\nWe started by fixing the PC density in SP to $264 \\pm 32.6 \\times 10^{3} \\mathrm{~mm}^{3}$ [134]. By combining the PC density and SP volume as extracted from the atlas ( $1.5789 \\mathrm{~mm}^{3}$ ), we estimated the total number of PCs as 416,842 . To estimate the number of cells or cell densities for interneurons, we used the ratio between PCs and the different interneurons as predicted by [5] with several assumptions. In some cases, a cell type has been described as present in several layers. If we only have reconstructions of cells from one layer, we consider all the expected cells to be placed in this layer. In the case of bistratified (BS) cells, we have reconstructions from SO and SP, but [5] also described a small percentage of cells in SR. In this case, we considered the cells from SR to be placed in SP; [5] gave a rough estimation of 1,400 cells for trilaminar cells and radia-tum-retrohippocampal cells together in SO. Without any other information, we considered these 2 cell types to have the same proportion, so we estimated the number of trilaminar cells as 700 . We ignored the m-types for which we do not have at least 1 reconstruction. The lack of some cell types led to a smaller number of interneurons. To maintain the same E/I ratio of 89:11 [5], we increased the number of interneurons accordingly. The resulting cell composition counts and densities are shown in S3 Table.\n\n## Cell placement\n\nSoma placement. We expanded the basic algorithm of [27] to take into account the more complex volume of the atlas and the particular constraints of the hippocampus. For each metype, the cell positions are created given cell density volumetric data (using uniform distribution). The total cell count is calculated based on cell density values and the volume. Each voxel is populated with the desired count of cells, weighted by the contribution of that voxel to the total density so that the total count of cells is reached. For SR_SCA and SLM_PPA, we could not select morphologies for all the potential positions within the corresponding layers. For this reason, the soma placement was restricted to 2 narrow subvolumes within the layers. In the case of SCA, we placed the soma in the middle of SR $\\pm 5 \\%$ of the layer thickness. In the case of PPA, we placed the cells in the lower part of the layer, from $2 \\%$ to $10 \\%$ of the layer.\n\nCell orientation. Once we decided the soma positions, we oriented the neuronal morphologies to follow the curvature of the hippocampus and other additional constraints. For all the cells, we aligned their $y$-axis with the radial axis of the hippocampus, and this allowed us to compute the placement scores and select the morphologies that best fit the space. Cells may show a preferential orientation around the radial axis. For interneurons, the experimental evidence for a specific orientation in the transverse-longitudinal plane is scarce, and we applied a random rotation around the radial axis to avoid any bias in the orientation. On the contrary, literature has reported a particular orientation for pyramidal cell axons. Pyramidal cells normally have 2 main branches, roughly parallel to the transverse axis, one towards the subiculum and one towards the CA3. There is also a thinner branch that is roughly parallel to the longitudinal axis $[118,135]$. To take this into account, we rotated the pyramidal cells so that their axons were parallel to the transverse axis and the most complex branch points closer to subiculum.\n\nMorphology selection. Once we identified the cell positions, we selected the morphologies that most closely matched a set of rules to ensure correct neurite targeting. We distinguished 2 types of rules: strict and optional ones (see later in this section). Optional rules are shown in S6 Table, while we used only one strict rule, i.e., dendrites and axons should be below the top of SLM."
    },
    {
      "markdown": "For each soma position, we have a candidate pool of morphologies to be selected. The candidate pool is computed as follows. For each soma position, we consider the radial axis passing through it and compute the relative position of the soma and the layer boundaries. For each morphology, we associate a score $\\hat{S}$ that describes how well the rules are matched. If $\\hat{S}=1$ we have a perfect match, $\\hat{S}=0$ the rules are not matched and the morphology is excluded from the pool. The score combines a score for \"optional\" rules $\\hat{I}$ and \"strict\" rules $\\hat{L}$.\n\n$$\n\\hat{S}=\\hat{I} \\bullet \\hat{L}\n$$\n\n$\\hat{I}$ combined all the scores from the $n$ \"optional\" rules $I_{j}$ as follows:\n\n$$\n\\hat{I}=\\left(\\frac{\\sum_{j} I_{j}^{-1}}{n}\\right)^{-1}\n$$\n\nThe use of a harmonic mean allows us to penalize low scores for a particular rule heavier than a simple mean, but still \"to give it a chance\" if other interval scores are high. If some optional score is close to zero $(<+0.001)$, the aggregated optional score would be zero. If there are no optional scores or if optional scores are ignored $\\hat{I}=1$.\n\nEach rule $I_{j}$ is computed as follows:\n\n$$\nI=\\max \\left(\\frac{\\min \\left(a^{1}, r^{1}\\right)-\\max \\left(a^{1}, r^{1}\\right)}{\\max \\left(a^{1}-a^{1}, r^{1}-r^{1}\\right)}, 0\\right)\n$$\n\nWhere $\\left(a^{1}, a^{1}\\right)$ is the interval of the dendrites, axon or dendritic tuft (when applicable) corresponding to the rules. It corresponds to the interval as defined above that needs to be shifted by the soma position $y_{0}$ of the morphology in the circuit.\n\n$$\n\\left(a^{1}, a^{1}\\right)=\\left(a_{0}^{1}, a_{0}^{1}\\right)+y_{0}\n$$\n\n$\\left(r^{1}, r^{1}\\right)$ is the interval of the target region along the radial axis passing through $y_{0}$. This interval corresponds to the rules expressed as relative intervals in the table above, converted to $\\mu \\mathrm{m}$.\n\nThe numerator represents the overlap of the 2 intervals, while the denominator normalizes the overlap by the largest interval among $\\left(a^{1}, a^{1}\\right)$ and $\\left(r^{1}, r^{1}\\right)$. In this way, only a perfect overlap receives a score of 1 , while if one interval is larger than the other, the score is lower than 1 .\n$\\hat{L}$ combines all the scores from the \"strict\" rules $L_{k}$ as follows:\n\n$$\n\\hat{L}=\\min _{k} L_{k}\n$$\n\nIf there are no strict scores $L=1$.\nGiven the multiple constraints described above, $2.6 \\%$ soma positions could not have any associated morphologies, and they were ignored. This resulted in fewer neurons than expected. However, validation of the cell composition and densities reassured us that this discrepancy is not significant. In fact, lower densities occurred mainly at the border of the circuit where the particular distorted shape of the layers makes the cell placement more complicated.\n\n# Circuit sections \n\nWe defined a series of sections of the circuit to be used in analyses and simulations. In particular, we defined nine cylinders equally spanned from position 0.1 to 0.9 along the longitudinal axis, in the middle of the transverse axis ( 0.5 ) and with a radius of $300 \\mu \\mathrm{~m}$. In addition, we defined 47 consecutive nonoverlapping transverse slices of thickness of $300 \\mu \\mathrm{~m}$."
    },
    {
      "markdown": "# Synapses \n\nLocal synapse anatomy. To derive the connectome, we adapted the algorithm described in [40]. The first part of the algorithm finds all potential synapses (appositions or touches) among cells based on colocalization of presynaptic axon and postsynaptic cells. We allowed all the possible connections between m-types with the exception of AA cells that can form contacts only with PC. We allow synapses to occur on soma and dendrites, with the following 2 exceptions: PC-PC connections only occur on dendrites [43] and AA cells make synapses only on AIS of PCs [136]. Initially, SCA, Ivy, and BS were found to make too many synapses on the PC soma compared to the data reported in literature [76,79,136,137]. Since the number of expected synapses on the soma is relatively low, and since the tool does not allow us to prune synapses on specific compartments, we decided not to allow SCA, Ivy, and BS to make synapses on PC somas.\n\nAn apposition occurs when the presynaptic axon is within a threshold distance (maximum touch distance) from the postsynaptic cell. In the somatosensory cortex microcircuit, this distance was set to $2.5 \\mu \\mathrm{~m}$ and $0.5 \\mu \\mathrm{~m}$ for synapses on PCs and INTs, respectively [27]. However, when we applied the same thresholds to the hippocampus, we could not match some of the experimental data. In particular, compared to experimental data there were too many connections among PCs and too few between PCs and INTs [138]. Using a grid search approach, we found that maximum touch distances of $1.0 \\mu \\mathrm{~m}$ and $6.0 \\mu \\mathrm{~m}$ for synapses on PCs and INTs respectively represent the minimum values that guarantee a sufficient number of synapses to match experimental data [138] and a certain room for the subsequent pruning step.\n\nThe second part of the algorithm discards synapses (pruning) in order to match experimental data on bouton densities (mean and standard deviation) and numbers of synapses per connection (mean). As experimental data were available for only a few pathways, we had to make additional assumptions for the uncharacterized pathways. According to [40], the number of appositions per connection can be used to predict the number of synapses per connection. We plotted the number of appositions as found by the model and the number of synapses for characterized pathways, and found that we can describe a good relationship among the 2 by splitting the data points into 2 groups (I-I connections and the rest) and fitting them separately ( $y=0.1096 x$ for I-I, $R=0.401, p=0.325 ; y=1.1690 x$ for the rest, $R=0.267, p=0.828$ ) (S13 Fig). For mean bouton density, we applied an average bouton density from characterized pathways to uncharacterized ones. Finally, the standard deviation of bouton density is estimated from the mean bouton density for the given pathway and the coefficient of variation (CV) estimated from a well-characterized pathway which we can generalize to all the other pathways. For somatosensory cortex, [40] used a CV of 0.32 . For the hippocampus, the best source is [139], which reported that the 64 PV postsynaptic cells receive 99 boutons from PVBC. They also reported that 51 neurons received 1 synapse, while 13 neurons received from 2 to 4 synapses, for a total of 99 to $51=48$ synapses. So, the 13 neurons have on average $48 / 13=3.69$ synapses per connection. We estimated the standard deviation to be 1.08 by considering 51 neurons with 1 synapse, and 13 neurons with 3.69 synapses. The resulting coefficient of variation is then $1.08 / 1.55=0.70$. We scanned several CVs between these 2 extremes and checked how well the resulting connectomes matched experimental data on several parameters. We obtained the best results with a CV of 0.50 , and we applied it to all the pathways.\n\nAs reported in [40], a bouton may form synapses onto 2 different postsynaptic neurons and we need to take this into account to better use data on bouton density to constrain the connectome. We used the value of 1.15 for synapses per bouton.\n\nLocal synapse physiology. The methodology for the design of the synapse models, the extraction of the parameters, and their implementation is described in detail in [34] with the"
    },
    {
      "markdown": "only exception of increasing the sample size of the number of pairs (i.e., 10,000 pre-post neurons) to increase the robustness of the calibration (see below). In brief, synapses were modeled with a stochastic version of the Tsodyks-Markram model [23,140,141], featuring multivesicular release [142]. We used sparse data from the literature (S13 and S14 Tables) to parameterize the model in a pathway-specific manner. We aimed at characterizing the physiological properties of synapses like PSC rise and decay time constants, receptor ratios (NMDA/AMPA), and STP profiles, which can be directly input into the model after some corrections (e.g., for calcium concentration, temperature, and liquid junction potential). We set the synaptic reversal potential $\\left(E_{\\text {rev }}\\right)$ to 0 mV for AMPA and NMDA receptors, and to -80 mV for $G A B A_{A}$ receptors; $\\tau_{\\text {rise }}=0.2 \\mathrm{~ms}$ for AMPA and $G A B A_{A}$ and 2.93 ms for NMDA receptors [76,143-149].\n\nWe sampled 10,000 connected pairs from the circuit and replicated paired recordings in silico to calibrate $\\mathrm{N}_{R R P}$ (the number of vesicles in the release-ready pool) and peak synaptic conductance to match in vitro PSC CVs and PSP amplitudes, respectively ([34,142]). Because of the sparsity of experimental data, at the end of this exercise, we only had 6 and 14 pathways (out of 130) with calibrated $\\mathrm{N}_{R R P} \\mathrm{~s}$ and synaptic peak conductances, respectively. For the uncharacterized pathways, we had to generalize the values found.\n\nAs in a previous study, the release probability of the synapses scales nonlinearly with the extracellular calcium concentration, enriching their dynamical regime even further [27]. The scaling of the release probability is made using a Hill function with 3 possible coefficients (steep, intermediate, and shallow). NMDA/AMPA receptor ratios are pathway dependent. Physiological evidence about release probability scaling and NMDA/AMPA ratios exists only for a minimal number of pathways. Thus, as the last step, we grouped the characterized pathways into 22 classes based on neurochemical markers, STP profiles, and peak synaptic conductances and used class average values predicatively for the remaining uncharacterized pathways.\n\n# Schaffer collaterals (SC) \n\nSC synapse anatomy. In the case of Schaffer collaterals, we did not model presynaptic CA3 pyramidal cells, and their axons, but directly the synapses on the postsynaptic neurons. For this reason, we followed an approach different from the one used for CA1 internal synapses, and we used the tool Projectionizer (Table 1), already adopted to model thalamo-cortical and cortical-thalamic projections [27-29]. In brief, the generation of projections was a multistep workflow as described below.\n\nThe number of CA3 PCs was constrained considering the physiological ratios between CA3 PCs and CA1 PCs, as reported by [5], an approach consistent with the rest of the cell composition. Having estimated the number of presynaptic neurons (i.e., 267,238), we determined the number of afferent synapses on CA1 PCs to be 20,878 (the average of the range reported in Table 22 of [5]), and the number of afferent synapses on interneurons to be 12,714 (the average of the range reported in Table 26 of [5]). Details on the experimental data used to constrain SC anatomy are reported in S15 Table.\n\nTo connect CA3 PC axons (i.e., SCs) with CA1 neurons, for each region in CA1, we gathered all the dendrite segment samples in the voxelized atlas. Neuron somas were not considered viable targets. Each region-wise candidate segment pool was then subsampled. Each region was assigned a number of synapses based on the synapse distribution (i.e., SLM: $0.3 \\%$, SR: $67.9 \\%$, SP: $7.1 \\%$, SO: $24.7 \\%$ ) and the total afferent synapses. The drawing from the pool was done with replacement, and sampling was weighted by the segment length not to oversample short segments. The sampled segments were considered as candidates for placing synapses. For each sampled segment, a random synapse position was chosen along the segment. Then, the candidate synapses were randomly assigned to each of the CA3 PCs presynaptic neurons."
    },
    {
      "markdown": "Finally, synaptic physiology parameters were drawn from distributions with specific means and standard deviations (see section SC physiology). To match the average number of SC on PC and INT, the workflow was run separately for SC to PC and SC to INT.\n\nSC physiology. To define the synaptic parameters, we distinguish 2 pathways: SC-PC and SC-INT. In both cases, we used the Tsodyks-Markram model parameters estimated by [53] (S17 and S18 Tables), since we did not have experimental traces to estimate the parameters (as done with the internal synapses). We also set the NMDA/AMPA ratio, rise and decay time constant for NMDAR according to available data (S17 and S18 Tables). The remaining parameters were not available, and we optimized them using two-steps procedure that is schematically reported in S19B Fig. In the first step, we set placeholder values for rise and decay time constant for AMPAR, and optimized maximum synaptic conductance and $\\mathrm{N}_{R R P}$, while in the second step, we optimized the AMPAR time constants. In each step, we aimed to match a set of experimental measures that depend on the considered pathway. We used a grid search and selected the model parameters that minimized a cost function defined as follows:\n\n$$\n\\text { error }=\\sum \\frac{\\left|x_{i}^{\\text {mod }}-x_{i}^{\\text {exp }}\\right|}{x_{i}^{\\text {exp }}}\n$$\n\nWhere $x^{\\text {exp }}$ is the experimental value we want to match, and $x^{\\text {mod }}$ is the value produced by the model. Because of the strong parameter interdependence, after each step, the other step was rerun in order to verify if both held true. The cycle ended when the 2 steps converged toward a satisfactory solution (i.e., model and experiments are not statistically different). As done for the definition of the internal CA1 synaptic parameters, we ran all the steps selecting 10,000 random pairs of pre- and postsynaptic neurons.\n\nDefinition of SC-PC synaptic parameters. To constrain the peak synaptic conductance, $\\mathrm{N}_{R R P}$, rise and decay time of AMPA and NMDA receptors, we aimed to match mean, CV, rise and decay time constant, and half-width of the PSP as reported in [50] (S17 Table). We set up the simulations to best approximate the same experimental conditions ( $2.0 \\mathrm{mM} \\mathrm{Mg}^{2+}$ and 2.0 $\\mathrm{mM} \\mathrm{Ca}^{2+}$ ).\n\nDefinition of SC-INT synaptic parameters. To constrain the peak synaptic conductance and $\\mathrm{N}_{R R P}$, we used [54] as a reference. The authors distinguished between cannabinoid receptor type 1 negative (CB1R-) basket cell (BC) and CB1R+ BC. Each cell type has a very distinctive response to SC stimulation, measured as the ratio between EPSC from SC to BC and the EPSC from SC to PC ( $E P S C_{B C} / E P S C_{P C}$ ) (S18 Table). We considered the CB1R- and CB1R + BC to be representative respectively of all the CB1R- and CB1R+ INTs. We considered CB1R+ INTs to include PPA, CCKBC, and SCA, while CB1R- INTs the rest, according to the molecular marker profiles reported on www.hippocampome.org $[7,8]$.\n\nFollowing this strategy, we treated the 2 populations, CB1R- and CB1R+ INTs, separately, and we optimized the peak synaptic conductance and $\\mathrm{N}_{R R P}$ to match the corresponding EPSC ratio. We set up the simulations to best reproduce the experimental conditions (i.e., 1.3 mM $\\mathrm{Mg}^{2+}, 2.5 \\mathrm{mM} \\mathrm{Ca}^{2+}$, and NMDAR blocked). For each combination of parameters, we simulated 1,000 voltage-clamp experiments (neurons clamped at -85 mV as in the experiments) where we stimulated with a single spike one SC connected to one PC and one interneuron. For each of the 1,000 triplets SC-PC-interneuron, we have simulated 100 trials to have a sufficient number of traces to compute robust statistics of EPSCs. PSC ratios were computed only when there was a PSC in both PC and INT of the triplet. For each triplet, the mean PSC values were computed.\n\nTo optimize rise and decay time constants of AMPAR, we aimed to match the EPSP-IPSP latency as reported by [55] (S17 Table). We set up the simulations to reproduce the same"
    },
    {
      "markdown": "experimental conditions ( $1.3 \\mathrm{mM} \\mathrm{Mg}^{2+}, 2.5 \\mathrm{mM} \\mathrm{Ca}^{2+}$, and NMDAR blocked, with and without inhibition). For the sake of simplicity, we optimized the parameters of PVBC given their important role in feedforward inhibition [54,55] and then generalized the resulting parameters to the other INTs. To identify a feedforward loop SC-PV-PVBC, we proceeded as follows: (1) randomly select 1 PVBC ; (2) select 1 PC connected to the PVBC; (3) select 200 SC fibers that innervate the PVBC. A simultaneous stimulation of 200 SC fibers is necessary to trigger an AP in PVBC; and (4) check whether at least one of these SC fibers also innervates the PC. If this is not the case, we repeat the procedure. We selected 1,000 SC-PC-PVBC triplets. For each triplet, we simulated 35 trials (different seeds). Each trial was 900 ms long, with spikes simultaneously delivered to the 200 SC fibers at 800 ms . We then made an average of the included voltage traces for each triplet and computed the EPSP with and without the inhibition. We derived the IPSP trace by subtracting the trace with inhibition from the trace without inhibition (S19E1 Fig). Traces with EPSP or IPSP failures, without PC or INT spikes, or more than 1 spike were excluded from the analysis. Since some parameter combinations led to few valuable traces and this could bias the result, we included the number of surviving traces in our cost function (Eq 8), where $x^{\\text {mod }}$ becomes the number of usable traces and $x^{\\text {exp }}$ the total number of traces (i.e., 35,000 ).\n\nSC validation. The reconstruction of the SC were validated against the results of [56] on input-output (I-O) characteristics of SC projections in vitro. We set up the simulations to mimic the same experimental conditions (slice of $300 \\mu \\mathrm{~m}, \\mathrm{Ca}^{2+} 2.4 \\mathrm{mM}, \\mathrm{Mg}^{2+} 1.4 \\mathrm{mM}, 32^{\\circ} \\mathrm{C}$ ) (Fig 4A). As in the experiment, we randomly selected 101 SP neurons in the slice. We randomly chose 350 SC inputs to activate simultaneously, evoking an AP at $\\mathrm{t}=1,000 \\mathrm{~ms}$. This input was able to make all the 101 neurons spike corresponding to $100 \\%$ of input/output (Fig 4B). We activated a different percentage of the 350 SC fibers, ranging from $5 \\%$ to $100 \\%$, and quantified the number of spiking neurons. We repeated the protocol by blocking the GABAergic synapses and repeated each condition (with and without GABAR) in 5 different slices. We computed the Pearson correlation coefficient R in control conditions to assess the linearity of IO curve in control condition (with GABAR).\n\n# Cholinergic modulation \n\nTo build a model of the effects of cholinergic release, we began by collecting and curating literature findings from bath application experiments in which ACh, carbachol (CCh), or muscarine were used. We extracted data on their effects on neuron excitability (membrane potential, firing rate, S19 Table), synaptic transmission (PSP, PSC, S20 Table), and network activity (extracellular recordings, S21 Table). We subsequently verified that the other experimental conditions (such as cell type, connection type and mouse versus rat provenance) did not produce further data stratification.\n\nSince for each experiment, data was available for both control and drug-applied conditions, we estimated the relative amount of depolarizing current at different concentrations of ACh. For sub-threshold data, we computed the cell type-specific amount of current causing a change in the resting membrane potential equal to the mean value reported in the experiments. For supra-threshold data, we computed the amount of current needed to increase the firing rate from the baseline frequency to the frequency in ACh conditions.\n\nThe data points show a dose-dependent increase in depolarizing current. To describe this effect, we fitted a Hill function assuming the ACh-induced current at control condition is zero $\\left(R^{2}=0.691, N=28\\right)$.\n\n$$\nI_{\\text {depd }}=\\frac{0.567 A C h^{0.436}}{100^{0.436}+A C h^{0.436}}\n$$"
    },
    {
      "markdown": "where $I_{\\text {depol }}$ is the depolarizing current (in nA ) and ACh is the neuromodulator concentration in $\\mu \\mathrm{m}$ (Fig 5A and 5C). At the synaptic level, the data points show a dose-dependent decrease in the amplitude of the voltage/current response to pre-synaptic stimulation for all pathways analyzed (S20 Table). Since ACh affects synaptic transmission principally at the level of release probability [23,60,61], we used the Tsodyks-Markram model [23,140,141] and introduced scaling factor to make the parameter $U_{S E}$ (neurotransmitter release probability) dependent on ACh concentration with a Hill function fitted to experimental data $\\left(R^{2}=0.667, N=27\\right)$.\n\n$$\nU_{S E}^{A C h}=\\frac{1.0 A C h^{-0.576}}{4.541^{-0.576}+A C h^{-0.576}} U_{S E}\n$$\n\nWhere $U_{S E}$ is the release probability (without ACh ), and $U_{S E}^{A C h}$ is the release probability with the dependency on ACh concentration (Fig 5B and 5D).\n\nAs a control, we verified that the values of PSP or PSC are proportional to $U_{S E}$.\nFor each network simulation, we applied these equations to compute the effect of ACh concentration on cells and synapses. In particular, we inject the same amount of depolarizing current (Eq 9) to all the cells and apply the same $U_{S E}$ scaling factor (Eq 10) to all pathways including Schaffer collaterals. All the simulations shown in Fig 5E-5K were run on the cylinder microcircuit with the extracellular calcium concentration set to 2 mM and a duration of 10 s. To disregard the initial ramping activity, we used the last 9 s of the simulation to compute correlation metrics.\n\n# MOOC circuit \n\nWe built a CA1 microcircuit as part of an MOOC on edx platform (https://www.edx.org/ learn/neuroscience/ecole-polytechnique-federale-de-lausanne-simulating-a-hippocampusmicrocircuit). This microcircuit shared many features with the current full-scale model of CA1, but there are a series of differences which need be considered. (1) The model uses a simplified volume as described in [27]. In particular, we defined an hexagonal prism of side $243 \\mu \\mathrm{~m}$, surrounded by 6 other equivalent prisms to minimize boundary effects. (2) The network consists of 18 K neurons, 20 M internal synapses, and 34 M afferent synapses. (3) Minor differences could also be observed at the level of the connectome and synaptome due to differences in volume, size, and cell orientations.\n\n## Simulation\n\nModel instantiation and execution. For running the hippocampus simulations, the NEURON simulator is used and leverages the CoreNEURON optimized solver for improved efficiency [150]. The model is instantiated using existing scripting methods for NEURON to construct the components of the virtual tissue and add support constructs such as stimuli and reports. Users can use the introspection feature of NEURON to adapt parameters based on certain features and identifiers. Once all components have their final values, the data structures are serialized to disk so that they can be loaded by the CoreNEURON solver into optimized data structures. This results in a 4 to $7 \\times$ reduction in memory utilization by CoreNEURON, allowing larger simulation on the same hardware. The memory layout can better utilize hardware features such as vectorized instructions and can have a 2 to $7 \\times$ improvement to execution time.\n\nSimulation experiments. For simulations in Section Model simulations, spike time, intracellular membrane potential, and extracellular voltage were recorded and analyzed.\n\nCA1 spontaneous synaptic release. The aim of these simulations was to discover whether spontaneous synaptic release in the intrinsic circuit would be sufficient to induce rhythmic"
    },
    {
      "markdown": "activity in CA1. So for these simulations, the stochastic synaptic release was enabled for each model intrinsic synapse and the SC input disconnected for the entire period simulated, typically 10 s . In vitro CA1 spontaneous synaptic release rate mPSPs are generally estimated from recording postsynaptic events (S22 Table), which is the summation of presynaptic release from the many converging axons. To determine what presynaptic rate parameter value to assign to the synapse models, we ran single neuron simulations for a range of mean presynaptic release rates. We verified that the presynaptic rate range produced a postsynaptic rate range that included ranges reported in literature (S20A Fig). We ran circuit simulations using this presynaptic rate range with both in vitro- and in vivo-like calcium concentrations. All other parameters remained constant across simulations.\n\nCA1 random synaptic barrage. The aim of these simulations was to discover whether random synaptic activity of the intrinsic circuit would induce oscillatory activity in CA1. Therefore, in these simulations, SC input was connected while stochastic synaptic release for intrinsic and extrinsic synapses was disabled for the entire period simulated, typically 10 s . SC spike times were generated independently for each input implemented using a Poisson random process with a constant (homogeneous) mean firing rate $(\\mathrm{Hz})$. To match the input firing rate of SC input that was able to generate regular theta activity in their CA1 model, we downloaded and analyzed example afferent input data provided with their Fig 5 of [22]. While [22] quoted 0.65 Hz as the critical input rate of synaptic barrage required to generate theta activity, we found their actual spike data had a much lower rate approximately 0.14 Hz (approximately 64 k spikes, the summation of their \"proximal\" and \"distal\" afferent sources arrived per second from approximately 450 k afferents). To cover this range, we ran simulations with constant random spiking rates of 0.05 to 0.60 Hz and repeated these simulations at in vitro- and in vivo-like calcium levels. All other parameters remained constant across simulations.\n\nCA1 bath concentration of extracellular calcium and potassium ions. The aim of these simulations was to discover whether tonic depolarization of the intrinsic circuit led to the emergence of oscillatory activity in CA1. Hence, stochastic synaptic release was disabled for each model intrinsic synapse and SC input disconnected for the entire period simulated, typically 10 s . We modeled the bath effect of calcium as explained previously and the effect of extracellular potassium ion $\\left(K^{+}\\right)$concentration as an constant current injected into the somatic compartment of each neuron ( $115 \\%$ to $140 \\%$ relative to each neuron's rheobase current) [27]. Simulations for this range of injected currents were repeated for a range of calcium concentrations between in vitro- and in vivo-like levels. All other parameters remained constant across simulations.\n\nCA3 theta oscillatory input. The aim of these simulations was to discover whether regular theta activity delivered via SC input to the intrinsic circuit would induce theta activity in CA1. So for these simulations, SC input was connected while stochastic synaptic release for intrinsic and extrinsic synapses was disabled for the entire period simulated, typically 10 s . SC spike times were generated independently for a subset of input axons (typically 15,000 ) using a Poisson random process with a sinusoidal (inhomogeneous) firing rate $(\\mathrm{Hz})$ using the Elephant software package functions [151]. Here, the individual mean rate of firing (cell frequency, 0.1 to 0.4 Hz ) defines the offset and amplitude that was sinusoidally modulated over time to represent theta-band ( 4 to 10 Hz ) oscillation (signal frequency). Simulations spanning the range of combinations of cell frequency and signal frequency were repeated at in vitroand in vivo-like calcium levels. All other parameters remained constant across simulations.\n\nMedial septum input. In this set of simulations, we aimed to study how MS input can induce theta oscillations in CA1. All the simulations run on the cylinder microcircuit with the extracellular calcium concentration set to 1 mM (in vivo-like level). All the neurons received a background depolarization, expressed as a percentage of the voltage threshold. Since the"
    },
    {
      "markdown": "background depolarization is not completely known during theta oscillation, we tested values from $100 \\%$ (threshold) to $130 \\%$. Above $130 \\%$, we observed non-physiological behaviors of the cells. The sinusoidal hyperpolarizing current injected in PV+ interneurons can be described by 3 parameters: frequency, mean, and amplitude. To reduce the parameter space to be scanned, we considered only the frequency of 8 Hz , an intermediate value in the theta range ( 4 to 12 Hz ). In addition, we set mean $=-$ amplitude. The disinhibition amplitude is unknown and we tested values in a range that produces physiological hyperpolarization in the PV+ interneuron models ( 0.1 to 0.5 nA ). We scanned also different acetycholine concentrations which are biological plausible ( 0 to $5 \\mu \\mathrm{M}$ ). The simulations ran for 20 s and disinhibition started at time 10 s .\n\nPropagation of oscillatory inputs. To examine whether CA3 gamma oscillations propagated to CA1, we aimed to reproduce the in vitro slice experimental results in [89]. During these CCh-induced gamma oscillations, the time course of CA3 spiking activity did not follow a pure sinusoidal waveform, so we had to create a custom inhomogeneous rate function. We did this by first manually reconstructing the probability of discharge of CA3 pyramidal cells over time and then mapped a smoothed version of these values from phase (radians) to time (seconds) coordinates to create a temporal rate function modulated at the reported gamma frequency of 31 Hz . The spike trains were generated from this custom rate function using the Elephant software package [151]. Since the circuit did not model the topography of SC connections to CA1 neurons, it did not constrain how many active SCs project to the simulated slice. Therefore, we ran multiple simulations varying the number of activated SC axons with overall mean rate matching the reported average firing rate of CA3 PCs [89]. To mimic the same experimental conditions, we simulated a slice circuit with extracellular $\\mathrm{Ca}^{2+} 2 \\mathrm{mM}$ and $\\mathrm{Mg}^{2+} 2 \\mathrm{mM}$. The effect of bath application of $10 \\mu \\mathrm{M}$ CCh effect on CA1 neurons was modeled using the approach described earlier (see section Cholinergic modulation). These simulations ran for 5 s , during which stochastic synaptic release for intrinsic and extrinsic synapses was disabled, with SC input applied 2 s to 5 s . All other parameters remained constant across simulations.\n\nIn a final set of simulations, we studied how the CA1 circuit responds to CA3 oscillatory input covering a broad range of frequencies ( 0.5 to 200 Hz ). We simulated an oscillatory input at CA3, with 4 different signal strengths ( $0.1,0.2,0.4$, and 0.8 Hz , as mean firing rate) and spike trains were generated using Elephant [151]. We measured the spiking response of CA1, checking if it was constant regardless of the oscillation frequency of CA3. Then, we computed the correlation between CA3 and CA1 and within CA1 neurons using the metrics explained below in section Correlation, with 10,000 randomly selected cell pairs (CA3-CA1 or CA1-CA1, respectively). All spike train correlation measurements were repeated using standard covariance and cross-correlation functions. All the simulations run on the cylinder microcircuit with the extracellular calcium concentration set to 2 mM and a duration of 6 s . We used 1 s of activity (i.e., from 3 s to 4 s of simulation time) to compute gains and correlation metrics.\n\n## Analysis\n\nSimulations showed an initial transient due to variable initiation and it appeared as an initial high activity of the network. This transient lasted for few ms, but we normally discarded the first $1,000 \\mathrm{~ms}$ in all the simulation analyses to be sure that the parameters converged into a stable regime.\n\nLFP analysis. For all simulations where extracellular voltage was recorded, the LFP analysis was performed in the same way unless otherwise stated. The raw extracellular voltage signal was estimated from multiple locations (channels) in the circuit model to mimic experimental electrode positions of a linear probe (e.g., Fig 2C). Following a standard electrophysiological"
    },
    {
      "markdown": "processing protocol (e.g., [152]), the raw extracellular signal was divided into 2 components using 6th-order Butterworth filtering implemented in the Elephant package (doi:10.5281/ zenodo.1186602; RRID:SCR_003833) [151]: a low-pass filtered signal ( $<400 \\mathrm{~Hz}$ cutoff) referred to as the LFP and a high-pass filtered signal ( $>400 \\mathrm{~Hz}$ ). Here, we analyzed the lowpass filtered LFP signal only. In the case of simulations reproducing the results of [89], LFP was band-pass filtered between 10 and 45 Hz to match their analysis protocol focusing on CA1 low gamma-band oscillations. Typically, the first second of recording was discarded to eliminate onset transient artifacts. The remaining signal was detrended and tested for stationarity before being analyzed further (see section Statistical analysis). For time-frequency analysis, this detrended signal was then downsampled from 2,000 (1,000/0.5 ms) to 400 Hz . The downsampled LFP signal was next filtered into separate frequency bands: delta ( 1 to 3 Hz ), theta ( 4 to 12 Hz ), and gamma ( 30 to 120 Hz ). A multitaper method was used to estimate PSD of the downsampled LFP signal with a frequency resolution of 1.5 Hz ([153], mtspec package: https://pypi.org/project/mtspec/). To estimate the spatiotemporal LFP spectral response, a complex Morlet wavelet transform (CWT) was applied with n_cycles $=7$ for 1 to 150 Hz range in steps of 0.25 Hz using the Elephant package function and reported in decibel ( dB ) units [154]. To identify cross-laminar source-sink relationships, CSD analysis was applied to the theta-band filtered signal across all channels of the virtual electrode using the Elephant package function for KCSD1D method [155].\n\nFor simulations that generated regular theta oscillations, spike-LFP phase coupling and theta waveform analyses were performed. To quantify phase preference of neurons during stable periods of theta oscillations (defined as at least three 2 s periods of theta in [77]), the Hilbert analytic transform of single channel theta-band signal (unless otherwise stated in SP) was calculated to estimate the instantaneous phase using the Elephant package function. The instantaneous phase was used to assign a (theta) phase angle to individual spike times for a period over 2 consecutive theta cycles ( 0 to 720 degree period) with trough of theta cycle set as 0 degrees [77]. For each neuron, the resultant (summed) vector angle for its spike train was used to determine the preferred phase of firing and the vector norm estimated the degree of phase locking (see section Statistical analysis). To quantify waveform asymmetry, we measured the asymmetry index for a low-pass LFP signal filtered in 1 to 80 Hz range [75]. To identify peak and trough locations, we used z-score thresholding, as the Hilbert method yielded too many spurious locations, and from this we computed the duration of rise $\\left(t_{r i s e}\\right)$ and decay $\\left(t_{\\text {decay }}\\right)$ for each oscillation. The asymmetry index per oscillation was calculated from $\\log \\left(t_{r i s e} / t_{\\text {decay }}\\right)$.\n\nCorrelation. To have a quantitative measurement of correlations between spike trains, we mainly used the spike time tiling coefficient (STTC) and the mean spike-spike correlations, computed for a defined number of cell pairs (normally 10,000, for robustness) as the histogram of intervals between all spike times of 2 different cells. For both STTC and spike-spike correlations we used a bin size of 10 ms , considering 1 s of simulated activity.\n\nTo verify the results obtained with the STTC method, we computed with the same input data the correlation using standard covariance and cross-correlation functions. All correlation analyses have been done with the Elephant library [151].\n\n# Statistical analysis \n\nTo calculate the slopes in linear fits to the appositions data, we used least-squares solution from the python toolbox (numpy.linalg.lstsq function).\n\nFor the fitting of experimental data points of cholinergic modulation, we used the nonlinear least squares solution (scipy.optimize.curve_fit function). Values are expressed as $R^{2}$ coefficients."
    },
    {
      "markdown": "For LFP analysis, the augmented Dickey-Fuller (ADF) unit root test was used to determine whether a single channel continuous signal was stationary before analyzing its spectral properties (statsmodels.tsa. stattools.adfuller function). To determine whether single neurons were phase-locked, the Rayleigh Test of randomness of circular data was used to reject the null hypothesis that phase angles of a spike train were uniformly distributed [156]. To compare with empirical results (e.g., [77]), phase analysis results were described by mean $\\pm$ angular deviation in degrees.\n\n# Statistical comparison methodology \n\nOur statistical comparisons between the model and experimental data were guided by the experimental data availability. To streamline the process, we performed statistical comparisons at an aggregate level rather than conducting comparisons for each individual cell type or pathway.\n\nThere are 2 main reasons to perform statistical comparisons at an aggregate level. Firstly, there may be a lack of data available at a granular level, such as for cell composition validation. Secondly, for certain parameters, such as bouton density, because we used a multi-objective optimization approach to match experimental data at an aggregate level, it is more appropriate to validate at an aggregate level as well. For these comparisons, we typically use Pearson's correlation coefficient (scipy. stats.pearsonr). Values are expressed as (Pearson correlation coefficient, $p$-value).\n\nIn cases where we needed to compare a large number of features for a metric, such as in morphology cloning validation, we used similarity scores in addition to correlation analysis. However, in other cases, when only a mean and standard deviation value were available for comparison, as in Schaffer collateral comparison, we used a z-test or $t$ test. Values are expressed as $p$-value.\n\nFinally, if the experimental data had a very small sample size, such as in the case of population synchrony, we did not perform any statistical and we relied only on qualitative assessments.\n\n## Visualization\n\nBrayns. Hippocampus circuit and simulations were visualized using Brayns software and its internally developed web interfaces: WebBrayns and Brayns Circuit Studio (Table 1).\n\nBrayns is a visualization software based on ray tracing techniques. It allows rendering 3D scenes and producing high-quality images and videos. Brayns offers programming interfaces in C++ and Python that make it highly customizable, while its web-based interfaces allow the interactive exploration of the scene and make the platform accessible to a wider community (no programming skills needed). In order to create high-quality, high-resolution visuals, Brayns makes use of different rendering engines, like Intel OSPRay (CPU-based ray tracing library, https://www.ospray.org/) or NVIDIA Optix (GPU-based ray-tracing framework https://developer.nvidia.com/rtx/ray-tracing/optix).\n\nThe capability of Brayns to render large-scale models, like the whole hippocampus circuit, is key to supporting scientific visualization needs and providing insight on scientific aspects that otherwise are very complex to analyze (e.g., signal propagation at circuit level).\n\nThe morphology collage images were also produced with Brayns. A set of clipping planes were used to determine the locations of the slices. For each plane, a second, parallel plane was placed $100 \\mu \\mathrm{~m}$ further from the origin to create a slice of $100 \\mu \\mathrm{~m}$ thickness. Then, for each slice and for each neuron morphological type, a small set of neurons of the chosen morphological type and physically located inside the volume determined by the slice were picked and"
    },
    {
      "markdown": "rendered with Brayns together with the polygonal meshes that define the outline of CA1 layers. The set of neurons displayed in every slice was chosen in a way to maximize its physical distribution within the slice (S11A Fig).\n\nSome of the morphology collage images were post-processed with media design tools (e.g., Adobe Illustrator, Adobe Photoshop) to match the visual style of other figures.\n\nNeuroMorphoVis. NeuroMorphoVis (NMV, see Table 1) was used to visualize single morphologies [157]. NMV is a Blender plug-in that allows the visualization and analysis of neuronal morphology skeletons that are digitally reconstructed. NMV presents many features, including the manual repair of broken morphology skeletons and the creation of accurate meshes that represent the membranes of the morphologies.\n\n# Model and code availability \n\nThe entire model, its components, and the source data can be explored and downloaded from hippocampushub.eu. The entire circuit can be also downloaded from Harvard Dataverse (doi:10.7910/DVN/TN3DUI). Code and input data to reproduce both main and supplementary figures are also available from Harvard Dataverse (doi:10.7910/DVN/UGOQWE).\n\n## List of assumptions\n\n## General.\n\n- This list is not exhaustive. We describe the assumptions that are specific to this work and the ones that could be revised in subsequent refinements.\n- We do not list here the assumptions that are already included in and derive from the adoption of specific other models (e.g., [27]; animal models).\n- Certain assumptions involve the exclusion of specific features. For example, gap junctions, rare cell types, glial cells, vasculature, are excluded from the current datasets and model.\n- In addition to the preceding point, certain limitations were imposed by both data quality and accessibility.\n\n\n## Data.\n\n- Most of the data came from the dorsal CA1. We approximated the entire CA1 using data from dorsal CA1.\n- We mixed data from different labs, experimental conditions, and animal models. We assumed that the inter-data sets variability is less than the intra-individual variability.\n\n\n## Volume.\n\n- We approximated the layer anatomy by dividing the overall CA1 volume into parallel layers with a fixed ratio between their thicknesses. The ratio was taken from the analyses of slice reconstructions from dorsal CA1 of adult rats. We presumed that any potential error introduced by this approximation was comparatively smaller than the inherent noise present in the original atlas.\n\n\n## Morphologies.\n\n- We considered the reconstructed cell morphologies to be fairly complete."
    },
    {
      "markdown": "- One PC reconstruction showed an axon with a length of $3,646 \\mu \\mathrm{~m}$ and an extension of $1,325 \\mu \\mathrm{~m}$ along the transverse axis. We deemed this axon to be relatively complete within the CA1 and therefore used it as a prototype for all the PCs. We presumed that using other axons would introduce a larger problem into connectivity with relatively little gain in diversity.\n- We treated PCs as 1 homogeneous cell type.\n- SP_PVBC and SP_CCKBC were classified as 2 separate classes.\n- We defined PV+ cells as SP_PVBC, SP_BS, SP_AA, CCK+ cells as SP_CCKBC, SR_SCA, SLM_PPA and SOM+ (somatostatin) cells as SO_OLM, SO_BS, SO_BP, SO_Tri.\n- Scaling and cloning compensated for the small sample size [27].\n\n\n# Electrical types. \n\n- We assumed only 4 e-types: classical accommodating (cAC), bursting accommodating (bAC), and classical non-accommodating (cNAC) for interneurons, and classical accommodating for pyramidal cells (cACpyr).\n\n\n## Cell composition.\n\n- For a given cell type, we assumed that all the expected cells in CA1 are located in the layers for which we had the corresponding morphological reconstructions.\n- Trilaminar cells and radiatum-retrohippocampal cells in SO had the same proportion.\n- To compensate for the lack of some inhibitory types, we increased the interneurons to match the expected E/I ratio of 11:89 [5]. In doing so, we assumed that matching E/I ratio was more important that maintaining the expected number of cell types present in the model.\n\n\n## Cell positioning.\n\n- The cell somas could have been located in any point of the layers (random placement).\n- Cells had a principal axis that was parallel to the radial axis and perpendicular to the layers.\n- Lacking precise evidence, we allowed random rotations around the $y$-axis for the interneurons.\n\n\n## Connectome.\n\n- Axo-axonic cells contacted only pyramidal cells.\n- We did not allow SCA, Ivy, and BS to form synapses on PC somas to prevent the number of somatic synapses from far exceeding expected values. In doing so, we assumed that the exclusion of few synapses would result in a smaller error compared to the one generated by a large number of somatic synapses.\n\n\n## Single-cell models.\n\n- The considered electrical features were the ones that described most of the behavior of the cells [35]."
    },
    {
      "markdown": "- We considered channels to be uniformly distributed in all dendritic compartments except KA and Ih.\n- We applied the same currents of pyramidal cells to interneurons with exceptions supported by experimental evidence.\n\n\n# Synapse model. \n\n- Synapses between A and B had the same parameters.\n- Synapses between m-types A and B had parameters extracted from the same distributions (truncated Gaussian).\n- Generalization: the synapse type and dynamics were defined, first of all, by pre- and postsynaptic m-type.\n- The NMDA/AMPA ratio was kept constant through all compartments of a given neuron.\n\n\n## Network.\n\n- The action potential was propagated stereotypically from AIS to synapse with a fixed velocity of $300 \\mathrm{~mm} / \\mathrm{s}$ [27].\n- In slices, neurons preserved their integrity. We did not model cut neurons.\n\n\n## Schaffer collaterals (SC).\n\n- SC synapses were uniformly distributed along the transverse and longitudinal axes.\n- SC synapses could have been placed at all locations on the target neuron (except on the soma), including apical tuft dendrites.\n- While [54] measured EPSC only on basket cells, then divided into cannabinoid receptor type 1 negative (CB1R-) and positive (CB1R+), we applied the experimental measurements to all interneurons, dividing them into 2 categories according to their positivity/negativity to CB1 markers, as reported in https://hippocampome.org/php/markers.php.\n- STP parameters (i.e., $U, D, F$, in the Tsodyks-Markram model [23]) were uniform for all interneurons, and they followed the values identified by [53].\n\n\n## Acetylcholine (ACh).\n\n- The dose-response curves for cholinergic modulation was homogeneous for all cell and synapse types.\n- The dose-response was well described using the Hill equation.\n- ACh, CCh, and muscarine had the same effects on neuronal excitability and synaptic transmission.\n- The change in membrane excitability caused by ACh was assumed to be equivalent to a tonic current injection at the soma.\n- Perisynaptic effects of volumetric transmission (i.e., non-synaptic release) of ACh was neglected."
    },
    {
      "markdown": "# Software used \n\nTable 1 lists the software used in the paper.\n\n## Supporting information\n\nS1 Appendix. Example of model improvement: steps to add a new cell type to the model. (PDF)\n\nS1 Fig. Workflow for creating new single-cell models. Black rectangles represent the different building blocks, and the blue labels are the processes between blocks.\n(PDF)\nS2 Fig. Workflow for adding new single-cell models to the network model. Black rectangles represent the different building blocks, the green boxes are the configuration files, and the blue labels are the processes between blocks.\n(PDF)\nS3 Fig. Scientific publications on hippocampus progressively increase. Counts per year of the number of publications based on a Pubmed search for \"hippocampus-cornu Ammonis-CA1-CA2-CA3\" from 1900-present indicates the large size of the neuroscientific community researching hippocampus.\n(PDF)\nS4 Fig. Circuit building workflow. Simplified workflow of the circuit building. Boxes represent the different building blocks, while blue labels are the operations between blocks. (PDF)\n\nS5 Fig. Validation of cloning. Validations of cloning methods with a similarity metric (differences between median values divided by variance). (A) The mean scores for 21 unique morphometrics averaged across m-types shown for basal and apical dendrites, and axons in each row. (B) The same scoring grouped by m-types instead of metrics for basal and apical dendrites. Since inhibitory neurons did not have apical dendrites, we show its score only for pyramidal cells. (C) Similar to B, but calculated for axons. Excitatory and inhibitory axons are grouped separately.\n(PDF)\nS6 Fig. Increasing morphological diversity. (A) Persistence diagrams of original (blue), repaired (green), and cloned (red) dendrites. Persistence diagrams encode the start (y-axis) and end ( $x$-axis) radial distances of all dendritic trees in the respective populations of neurons. (B) Persistence diagrams of normalized radial distances (to one) from original (blue), repaired (green), and cloned (red) dendrites. (C) Persistence images are the Gaussian averages of the respective persistence diagrams (B) from original (top), repaired (middle) and cloned (bottom) dendrites. Calculations are computed for the all cell groups. For more detailed analyses, see 57 and 58 Figs.\n(PDF)\nS7 Fig. Persistent images for the basal and apical dendrites of each m-type. (A) Persistent images averaged across each m-type for original morphologies and for their cloned counterparts with respect to the basal dendrites, and (B) their differences. (C) The same process applied for apical dendrites which was only present in the excitatory cell group (e.g., pyramidal cells). Note that the radial distance is synonymous with Euclidean distance and should not be mixed with hippocampal radial axis.\n(PDF)"
    },
    {
      "markdown": "S8 Fig. Persistent images for the axons of each m-type. Persistent images averaged across each cell type for (A) original axons, (B) cloned versions, and (C) their difference. (PDF)\n\nS9 Fig. Validation of single-cell models. (A) Graphical illustration of the back-propagating action potential protocol. In a pyramidal cell model, the soma is stimulated to elicit an AP, which is then measured at different distances from the soma. (B) In silico measurements (black dots) are reported and compared with experimental data from Golding and colleagues (red dots and whiskers, indicating mean and standard deviation). (C) Graphical illustration of the postsynaptic potential attenuation protocol. Dendrites on the apical trunk of a pyramidal cell are stimulated with bi-exponential currents; then, PSP's amplitudes are measured as it travels toward the soma. (D) In silico measurements of PSP attenuation (black dots) are expressed as a ratio between the PSP measured in the dendrite and the one measured in the soma. Pyramidal cell models are compared with experimental data from Magee and Cook. The 2 distributions have been fitted with exponential equations, resulting in the following space constants: $\\tau$ model $=155.6 \\mu \\mathrm{~m}$ and $\\tau$ experiment $=235.2 \\mu \\mathrm{~m}$.\n(PDF)\nS10 Fig. CA1 atlas overview. (A) Original atlas. (B) Smoothed atlas. (C) Upper and lower shells. (D) Centerline through the volume. (E) Planes normal to the centerline. (F) Longitudinal, transverse, and radial coordinates. (G) Orientation vectors. (H) Layer assignment. (PDF)\n\nS11 Fig. Cell placement. A pyramidal cell (PC) is used to illustrate the cell placement in CA1 volume. (A) We set a density profile for each cell type. In the case of PC, we set an uniform density in stratum pyramidal (SP). (B) We randomly identify soma positions matching the given cell density. (C) For each soma position, we assign a morphology and orient it using the vector fields. For PC, we align the main axis of the dendrites with a vector (red arrow) parallel to the radial axis, while we align the axon to a vector (green arrow) parallel to the transverse axis. Furthermore, the more complex branch of the axon points to the Subiculum. (D) We select a morphology that respects a set of rules. In the case of PC, we specify 2 rules regarding the dendrites.\n(PDF)\nS12 Fig. Validation of cell placement. (A) Validation of the cell placement. A subset of cells from each m-type is displayed within each of the 100 slices of $100 \\mu \\mathrm{~m}$ thickness equally spanned along the longitudinal axis. (B) Cell composition is sampled in different subvolumes ( 9 cylinders of $300 \\mu \\mathrm{~m}$ of radius equally spanned along the longitudinal axis) and compared with desired composition from Bezaire and Soltesz ( $\\mathrm{R}=0.999998, p<0.0001$ ). (C) Total cell density in CA1, in the layers SLM + SR, SP, pyramidal cell density in SP, total cell density in SO. Neuron density validation is intrinsic (PC in SP) and extrinsic (the rest). The density is sampled in different subvolumes ( 9 cylinders of $300 \\mu \\mathrm{~m}$ of radius equally spanned along the longitudinal axis). Experimental values can be found in S5 Table.\n(PDF)\nS13 Fig. Prediction of the number of synapses per connection from the number of oppositions per connection. We compare the available data on the number of synapses per connection of a given pathway to the corresponding number of appositions per connection. Data can be grouped in 2 sets and fit separately (purple line $y=0.1096 x$ for I-I, red line $y=1.1690 x$ for the rest). The fitting lines can be used to predict how much the appositions should be pruned"
    },
    {
      "markdown": "to match or predict synapses per connection. Experimental values can be found in S9 Table. E: excitatory neuron, I: inhibitory neuron.\n(PDF)\nS14 Fig. Bouton density and synapses per connection. (A) Mean and STD of bouton density values per individual m-type. (B) Mean synapses per connection for each m-type pair. Experimental values are given in square brackets. (C) Comparisons of mean and STD of synapses per connection for experimental data points and corresponding values in the model. Experimental values in panels A and C can be found respectively in S7 and S9 Tables.\n(PDF)\nS15 Fig. Connection probability. (A) Connection probability with respect to the intersomatic distance within and between Excitatory (E) and Inhibitory (I) groups. (B) Mean connection probability for each type pair. Non-existing connections are left blank and experimental observations are shown with square brackets. (C) Comparison of experimental and model connection probabilities within E/I group pairs. Only pairs of neurons with a maximum intersomatic distance of $500 \\mu \\mathrm{~m}$ were considered. Experimental values can be found in S8 Table. (PDF)\n\nS16 Fig. Convergence on neurons and neuron groups. (A) Indegree distribution for neurons in this model. The inset shows the distribution on logarithmic scale. (B) Number of synapses made on an average postsynaptic cell from each afferent m-type group. Colorbar in log-normal scale. (C) Mean and STD of synapses made onto an average neuron for each m-type. (D) Number of synapses made onto each neurite type for excitatory and inhibitory classes (Megias and colleagues).\n(PDF)\nS17 Fig. Divergence of neurons and neuron groups. (A) Outdegree distribution for neurons in this model. The inset shows the distribution on logarithmic scale. (B) Number of synapses made by an average neuron from presynaptic m-type to postsynaptic group. (C) Comparison of divergence per m-type with the available experimental values. (D) Prediction of synapse divergence broken down into efferent synaptic group. SO_Tri divergence differs significantly from the experimental data. This could be explained by a morphological reconstruction which is not representative of the entire class or other factors that favor the connections between SO_Tri and interneurons beyond chance. (E) Percentage of synapses made onto individual layers or outside the CA1 mesh. For SR_SCA, the discrepancy between model and experiment can be explain by different morphological subtypes used in the 2 cases. In the experiment of Pawelzik and colleagues, the morphology is well confined in SR, while in the morphology used in the model also invades SP and SO. For D and E, hatched bars indicate the experimental values. Experimental values in panels C-E can be found respectively in S11 and S12 Tables. (PDF)\n\nS18 Fig. Prediction and validation of synapses. (A) Example of in silico paired recording experiment between a PC (purple morphology) and a PVBC (light blue morphology), synapses between PC axon and PVBC dendrites in SO are depicted as yellow spheres. The presynaptic neuron is stimulated with a step current to elicit an action potential. Somatic recordings of EPSP and EPSC are depicted on the right. Each gray line represents one of the 35 trials, while the average response is shown in light blue. (B) Prediction of the PSP amplitudes (B) and PSC CVs (C) for the 130 possible pathways. (C) The combinations with bold borders indicate pathways that have been validated (panels C and D). Validation of PSP amplitudes (C) and PSC CVs (D). Dots represent mean values and whiskers the standard deviation of experimental"
    },
    {
      "markdown": "(horizontal, in red) and model (vertical, in black) data. The dashed gray line indicates the diagonal (i.e., the target). Experimental values can be found in Ecker and colleagues. (PDF)\n\nS19 Fig. Schaffer collaterals anatomy and physiology. (A) The distribution of the number of synapses per connection ( $1.0 \\pm 0.2$ synapses/connection), the $y$-axis has a logarithmic scale. (B) The distribution of efferent synapses made by a single SC ( $34,135 \\pm 185$ synapses). (C) Scheme of the workflow used for the fitting of $\\mathrm{SC} \\rightarrow \\mathrm{PC}$ and $\\mathrm{SC} \\rightarrow$ INT synapses. On the right, targets that are used for the 2 steps for the fitting of $\\mathrm{SC} \\rightarrow \\mathrm{PC}$ and $\\mathrm{SC} \\rightarrow$ INT. (D) Fitting results of SC $\\rightarrow$ PC synapses. Each plot reports the distribution of one PSP feature (rise time, tau decay, and half-width in D1, D2, and D3, respectively) computed over the 10,000 pairs of pre and postsynaptic neurons. On top, experimental (in red) and model (in black) mean and standard deviation values are reported with a dot and a bar, respectively. (E) Fitting results of SC $\\rightarrow$ INT synapses. E1 shows the average PC EPSPs in control conditions (black line) and when gabazine is applied (no GABA, gray line). The difference between the 2 is the IPSP induced by the feedforward inhibition (blue line). The inset shows the EPSP-IPSP latency, which is the difference between the onset of the IPSP and of the EPSP. E2. The EPSP-IPSP latency distribution of the 1,000 randomly selected PCs. Experimental values for panels D and E2 can be found respectively in S17 and S18 Tables.\n(PDF)\nS20 Fig. Spontaneous synaptic release alone did not generate sustained theta oscillations in the CA1 model. (A) Relationship between spontanteous presynaptic release and postsynaptic events rates for pyramidal cells EPSPs (left) and IPSPs (right). (B) Relationship between calcium level and spontaneous presynaptic release rate for stratum pyramidale LFP responses peak frequency (left) and theta band power (right) shows weak theta power across all simulation experiments. (C-H) Example: 0.001 Hz presynaptic spontaneous release rate (cylinder circuit). (C-E) 2 mM calcium. (C) LFP and theta-band filtered LFP extracellular recordings from stratum pyramidale show irregular activity. (D) PSD shows multiple noisy peaks $1-20 \\mathrm{~Hz}$ with the highest peak just below theta range. (E) Morlet complex wavelet spectrogram shows intermittent episodes of theta-band activity but these were associated with wide-range frequency response. (F-H) 1 mM calcium. (F) LFP and theta-band filtered LFP extracellular recordings show irregular activity but much smaller amplitude than for 2 mM calcium. (G) PSD shows multiple noisy peaks across a wider frequency range several orders of magnitude less than for 2 mM although the highest peak is just within theta-band. (H) Wavelet spectrogram shows a slightly more sustained period of theta and delta-band ( $1-3 \\mathrm{~Hz}$ ) activity but with more irregular, higher frequency events than 2 mM calcium.\n(PDF)\nS21 Fig. Extrinsic random synaptic activity at low levels generated noisy beta but not theta oscillatory activity in the CA1 model. For each panel: LFP and theta filtered LFP traces (far left), PSD (middle left), wavelet spectrogram (middle right), CSD (far right) (A). Poisson rate 0.05 Hz . PSD shows broad and noisy peak power located in beta frequency band (13-25 Hz) (B). Poisson rate 0.10 Hz . (C). Poisson rate 0.60 Hz . PSD shows little power within theta and beta band.\n(PDF)\nS22 Fig. Extrinsic random synaptic activity fails to induce oscillatory spiking response in the CA1 circuit. (A) Sample histograms of CA3 input spike time input (top) and output poststimulus response of CA1 pyramidal and interneurons for a range of CA3 Poisson rates. (B) Spiking input-output relationship between CA3 input spike rate and mean output spiking"
    },
    {
      "markdown": "rates of pyramidal cells (left) and interneuron types (right). (C) Pyramidal cell cross-correlation histograms ( CCH ) for different CA3 input spike rates both lack evidence of oscillatory response to randomly timed extrinsic afferent EPSPs.\n(PDF)\nS23 Fig. Tonic depolarisation induces spiking oscillations at $\\mathbf{2} \\mathbf{m M}$ but not $\\mathbf{1} \\mathbf{m M}$ calcium for a narrow percentage of relative rheobase across circuit scales. (A) At 120\\% rheobase, for 1 mM calcium sparse and uncoordinated spiking but at oscillatory peaks occur at 2 mM in pyramidal cell cross-correlation histograms ( CCH ) in all sizes of circuit. (B) For 2 mM calcium, increasing level of tonic depolarization degrades the strength of oscillation for all sizes of circuit suggesting the resonance effect is limited to a narrow range of tonic depolarization. (PDF)\n\nS24 Fig. Tonic depolarisation generates theta-band oscillations across circuit scales at 2 mM extracellular calcium concentration. Example: 2 mM calcium, 120\\% rheobase depolarization (recording electrode in SP). For each panel: LFP and theta filtered LFP traces (far left), PSD (middle left), Wavelet Spectrogram (middle right), CSD (far right). (A) Cylinder circuit. (B) Slice circuit. (C) Full circuit.\n(PDF)\nS25 Fig. LFP theta waves are highly asymmetric for an extrinsic excitatory oscillatory stimulus. Top panel: 1 s example traces of $1-80 \\mathrm{~Hz}$ filtered LFP from stratum pyramidal SP (3) electrode with estimated locations of theta peaks and troughs shown. Bottom panel: estimated rise times (trough to peak time) (far left), estimated decay times (peak to trough time) (middle left), calculated theta wave asymmetry index (middle right), and scatter plot of rise and decay times ( $n=71$ total waves). Example: 8 Hz signal frequency, 0.4 Hz cell frequency, 2 mM calcium, full circuit.\n(PDF)\nS26 Fig. Population synchrony of pyramidal cells does not match experimental theta trough (\"theta-\") and fast-spiking interneurons recruitment lower than experimental levels although better for SP_AA than SP_PVBC independent of circuit scale. Example: 2 mM calcium, 0.4 Hz cell frequency, and 8 Hz modulation frequency.\n(PDF)\nS27 Fig. LFP theta waves are nearly symmetric for an extrinsic inhibitory oscillatory stimulus. Top panel: 1 s example traces of $1-80 \\mathrm{~Hz}$ filtered LFP from str pyramidal $\\operatorname{SP}(3)$ electrode with estimated locations of theta peaks and troughs shown. Bottom panel: estimated rise times (trough to peak time) (far left), estimated decay times (peak to trough time) (middle left), calculated theta wave asymmetry index (middle right), and scatter plot of rise and decay times ( $n=79$ total waves). Example: 8 Hz signal frequency, $1 \\mu \\mathrm{M}$ ACh, depolarisation $=120 \\%, 2 \\mathrm{mM}$ calcium, cylinder circuit.\n(PDF)\nS28 Fig. Population synchrony of pyramidal cells matches experimental theta trough (\"theta-\") and fast-spiking interneurons SP_AA and SP_PVBC experimental matches theta peak (\"theta+\") for increased stimulus amplitudes. Example: 120\\% depolarisation, $1 \\mu \\mathrm{M}$ ACh.\n(PDF)\nS29 Fig. Propagation of gamma oscillation from CA3 to CA1. Gamma oscillation (31 Hz) robustly propagates to CA1 when there is a sufficient amount of SC input. (A) Shows wavelet"
    },
    {
      "markdown": "spectrograms of LFPs recorded in simulations where CA1 neurons were driven by oscillating input via different numbers of Schaffer collaterals, but no CCh was applied. (B) Shows the wavelet spectrograms of the same simulations, but with simulating the effect of $10 \\mu \\mathrm{M}$ CCh. A wide range of the number of SC inputs is able to induce strong gamma oscillation in CA1 both in the case of CCh application and without CCh , but CCh seems to increase the number of inputs needed for stable gamma oscillation, probably due to its weakening effect on synapses. (PDF)\n\nS1 Table. List of abbreviations and acronyms.\n(PDF)\nS2 Table. Key feature comparison of realistic large-scale hippocampal network models with multicompartmental HH model neurons. For reasons of space, this is a non-exhaustive list of features.\n(PDF)\nS3 Table. Cell composition, counts, and densities. Values were obtained combining multiple data sets. See section Cell composition of Methods for details.\n(PDF)\nS4 Table. Morpho-electrical composition. Percentage of electrical types (e-types) for each morphological type (m-type). Last column indicates the number of traces used to estimate the percentages. See section Morpho-electrical compositions of Methods for more details. BS indicates both SP_BS and SO_BS.\n(PDF)\nS5 Table. Neuron density validation.\n(PDF)\nS6 Table. Placement \"optional\" rules.\n(PDF)\nS7 Table. Bouton density.\n(PDF)\nS8 Table. Connection probabilities per m-type pair and other related parameters. (PDF)\n\nS9 Table. Number of synapses per connection.\n(PDF)\nS10 Table. Experimentally available data for divergence of synapses per m-type. (PDF)\n\nS11 Table. Available data on the divergence of synapses for different m-types to excitatory and inhibitory groups within CA1.\n(PDF)\nS12 Table. Laminar distribution. Data for SO_Tri comes from the Sprague Dawley rat data set (see section Experimental procedures).\n(PDF)\nS13 Table. Presynaptic dynamics parameters.\n(PDF)"
    },
    {
      "markdown": "S14 Table. Postsynaptic dynamics parameters.\n(PDF)\nS15 Table. Schaffer collaterals anatomy experimental data. N.: number of animals, n.: number of synapses.\n(PDF)\nS16 Table. Schaffer collaterals layer profile. N.: number of animals.\n(PDF)\nS17 Table. Schaffer collaterals physiology experimental data for SC $\\rightarrow$ Exc synapses. UoM: Units of Measurement, R.: region, n.: number of cells.\n(PDF)\nS18 Table. Schaffer collaterals physiology experimental data for SC $\\rightarrow$ Inh synapses. UoM: Units of Measurement, R.: region, n.: number of cells.\n(PDF)\nS19 Table. Curated data set on neuronal excitability changes caused by cholinergic modulation.\n(PDF)\nS20 Table. Curated data set on synaptic transmission changes caused by cholinergic modulation.\n(PDF)\nS21 Table. Network effects of ACh.\n(PDF)\nS22 Table. Summary of estimated rates of spontaneous synaptic release in rat CA1. TTX used to inactivate fast sodium channels in all experiments except Hajos and Mody. D: Days, M: Months.\n(PDF)\nS23 Table. Phase tuning of rat CA1 m-types.\n(PDF)\nS24 Table. Long-term discharge rates of rat CA1 neurons in vivo during theta periods. (PDF)\n\nS25 Table. Resources and simulators used in validating the current CA1 model. cav: cal-cium-voltage scan. osc control: oscillatory, ms: medial septum, SC: Schaffer collateral, N: Neuron, CN: CoreNeuron.\n(PDF)\n\n# Acknowledgments \n\nThe authors would like to thank all the people involved in the rat CA1 hippocampus project over the last years, in particular Attila Gulyás, Luc Guyot, and Arseny Povolotsky. We would also like to thank those who offered valuable advice or data: Giorgio Ascoli, Norbert Hájos, Jesse Jackson, Corette Wierenga, and Sylvain Williams. Experimentalists who generated data for this project or who recorded, dye-filled and/or reconstructed neurons: A.B. Ali, A.P Bannister, R. Begum, N. Botcher, J. Deuchars, K. Eastlake, D. I. Hughes, M. Ilia, J. Kerkhoff, S. Kirchhecker, H. Pawelzik, and H. Trigg. D.C. West designed data collection and analysis software. We thank those who worked on the Explore feature of the Hippocampus hub: Anil"
    },
    {
      "markdown": "Tuncel, Pavlo Getta, Caitlin Monney, Stefano Antonel, Alexander Dietz, and Liviu Soltuzu. Finally, we are indebted to Karin Holm for copy editing, and publication advice and support.\n\n# Author Contributions \n\nConceptualization: Armando Romani, Michele Migliore, Szabolcs Káli, Henry Markram.\nData curation: Armando Romani, Alberto Antonietti, Davide Bella, Julian Budd, Kerem Kurban, Thomas Delemontex, Joanne Falck, Lida Kanari, Anna-Kristin Kaufmann, Sigrun Lange, Huanxiang Lu, Ying Shi, Mohameth François Sy, Audrey Mercer, Alex M. Thomson.\n\nFormal analysis: Armando Romani, Alberto Antonietti, Davide Bella, Julian Budd, Elisabetta Giacalone, Kerem Kurban, Sára Sáray, Alexis Arnaudon, Cristina Colangelo, Thomas Delemontex, András Ecker, Lida Kanari.\n\nFunding acquisition: Tamás F. Freund, Audrey Mercer, Alex M. Thomson, Michele Migliore, Szabolcs Káli, Henry Markram.\n\nInvestigation: Armando Romani, Alberto Antonietti, Davide Bella, Julian Budd, Elisabetta Giacalone, Kerem Kurban, Sára Sáray, Carmen Alina Lupascu, Rosanna Migliore, Michael W. Reimann, Werner Van Geit, Liesbeth Vanherpe.\n\nMethodology: Armando Romani, Alberto Antonietti, Julian Budd, Henry Markram.\nResources: Henry Markram.\nSoftware: Armando Romani, Alberto Antonietti, Julian Budd, Kerem Kurban, Thomas Delemontex, Michael Gevaert, Juan B. Hernando, Joni Herttuainen, Genrich Ivaska, James Gonzalo King, Pramod Kumbhar, Huanxiang Lu, Juan Luis Riquelme, Vishal Sood, Werner Van Geit, Liesbeth Vanherpe.\n\nSupervision: Armando Romani, Jean-Denis Courcol, James Gonzalo King, Judit Planas, Srikanth Ramaswamy, Michael W. Reimann, Mohameth François Sy, Werner Van Geit, Tamás F. Freund, Audrey Mercer, Eilif Muller, Felix Schürmann, Alex M. Thomson, Michele Migliore, Szabolcs Káli, Henry Markram.\n\nValidation: Armando Romani, Alberto Antonietti, Davide Bella, Julian Budd, Elisabetta Giacalone, Kerem Kurban, Sára Sáray, Cristina Colangelo, András Ecker, Lida Kanari, Pranav Rai.\n\nVisualization: Armando Romani, Alberto Antonietti, Davide Bella, Julian Budd, Kerem Kurban, Marwan Abdellah, Elvis Boci, Cyrille Favreau, Juan B. Hernando, Fabien Petitjean, Judit Planas, Nadir Román Guerrero, Henry Markram.\n\nWriting - original draft: Armando Romani, Alberto Antonietti, Davide Bella, Julian Budd, Elisabetta Giacalone, Kerem Kurban, Sára Sáray, Cristina Colangelo, Lida Kanari, Nadir Román Guerrero, Henry Markram.\n\nWriting - review \\& editing: Armando Romani, Alberto Antonietti, Davide Bella, Julian Budd, András Ecker, Sigrun Lange, Audrey Mercer, Alex M. Thomson, Michele Migliore, Szabolcs Káli, Henry Markram.\n\n## References\n\n1. O'Keefe J, Dostrovsky J. The hippocampus as a spatial map. Preliminary evidence from unit activity in the freely-moving rat. Brain Res. 1971; 34(1):171-175. https://doi.org/10.1016/0006-8993(71)90358-1 PMID: 5124915"
    },
    {
      "markdown": "2. Morris RG, Garrud P, Rawlins JN, O'Keefe J. Place navigation impaired in rats with hippocampal lesions. Nature. 1982; 297(5868):681-683. https://doi.org/10.1038/297681a0 PMID: 7088155\n3. Amaral DG, Witter MP. The three-dimensional organization of the hippocampal formation: a review of anatomical data. Neuroscience. 1989; 31(3):571-591. https://doi.org/10.1016/0306-4522(89)90424-7 PMID: 2687721\n4. Soltesz I, Losonczy A. CA1 pyramidal cell diversity enabling parallel information processing in the hippocampus. Nat Neurosci. 2018; 21(4):484-493. https://doi.org/10.1038/s41593-018-0118-0 PMID: 29593317\n5. Bezaire MJ, Soltesz I. Quantitative assessment of CA1 local circuits: Knowledge base for interneuronpyramidal cell connectivity. 2013; 23(9):751-785. https://doi.org/10.1002/hipo.22141 PMID: 23674373\n6. Pelkey KA, Chittajallu R, Craig MT, Tricoire L, Wester JC, McBain CJ. Hippocampal GABAergic Inhibitory Interneurons. Physiol Rev. 2017; 97(4):1619-1747. https://doi.org/10.1152/physrev.00007.2017 PMID: 28954853\n7. Wheeler DW, White CM, Rees CL, Komendantov AO, Hamilton DJ, Ascoli GA. Hippocampome.org: a knowledge base of neuron types in the rodent hippocampus. Elife. 2015; 4:e09960. https://doi.org/10. 7554/eLife.09960 PMID: 26402459\n8. Sanchez-Aguilera A, Wheeler DW, Jurado-Parras T, Valero M, Nokia MS, Cid E, et al. An update to Hippocampome.org by integrating single-cell phenotypes with circuit function in vivo. PLoS Biol. 2021; 19(5):e3001213. https://doi.org/10.1371/journal.pbio.3001213 PMID: 33956790\n9. Fan X, Markram H. A Brief History of Simulation Neuroscience. Front Neuroinform. 2019; 13:32. https://doi.org/10.3389/fninf.2019.00032 PMID: 31133838\n10. Hood L, Rowen L. The human genome project: big science transforms biology and medicine. Genome Med. 2013; 5(9):79. https://doi.org/10.1186/gm483 PMID: 24040834\n11. Rockström J, Steffen W, Noone K, Persson A, Chapin FS, Lambin EF, et al. A safe operating space for humanity. Nature. 2009; 461(7263):472-475. https://doi.org/10.1038/461472a PMID: 19779433\n12. Aad G, Abbott B. Combined Measurement of the Higgs Boson Mass in pp Collisions at $\\sqrt{s}=7$ and 8 TeV with the ATLAS and CMS Experiments. Phys Rev Lett. 2015; 114(19). https://doi.org/10.1103/ physrevlett.114.191803\n13. Szigeti B, Gleeson P, Vella M, Khayrulin S, Palyanov A, Hokanson J, et al. OpenWorm: an open-science approach to modeling Caenorhabditis elegans. Front Comput Neurosci. 2014; 8:137. https://doi. org/10.3389/fncom.2014.00137 PMID: 25404913\n14. Gerkin RC, Jarvis RJ, Crook SM. Towards systematic, data-driven validation of a collaborative, multiscale model of Caenorhabditis elegans. Philos Trans R Soc Lond B Biol Sci. 2018; 373(1758). https:// doi.org/10.1098/rstb.2017.0381 PMID: 30201844\n15. Sutton NM, Ascoli GA. Spiking neural networks and hippocampal function: A web-accessible survey of simulations, modeling methods, and underlying theories. Cogn Syst Res. 2021; 70:80-92. https://doi. org/10.1016/j.cogsys.2021.07.008 PMID: 34504394\n16. Hasselmo ME, Alexander AS, Dannenberg H, Newman EL. Overview of computational models of hippocampus and related structures: Introduction to the special issue. Hippocampus. 2020; 30(4):295301. https://doi.org/10.1002/hipo.23201 PMID: 32119171\n17. Traub RD, Miles R, Wong RS. Large scale simulations of the hippocampus. IEEE Eng Med Biol Mag. 1988; 7(4):31-38. https://doi.org/10.1109/51.20378 PMID: 18244079\n18. Traub RD, Miles R. Neuronal Networks of the Hippocampus. Cambridge University Press; 1991. https://doi.org/10.1017/Fobo9780511895401\n19. Traub RD, Miles R, Buzsáki G. Computer simulation of carbachol-driven rhythmic population oscillations in the CA3 region of the in vitro rat hippocampus. J Physiol. 1992. https://doi.org/10.1113/ jphysiol.1992.sp019184 PMID: 1403830\n20. Traub RD, Bibbig A, Fisahn A, LeBeau FE, Whittington MA, Buhl EH. A model of gamma-frequency network oscillations induced in the rat CA3 region by carbachol in vitro. Eur J Neurosci. 2000; 12 (11):4093-4106. https://doi.org/10.1046/j.1460-9568.2000.00300.x PMID: 11069606\n21. Cutsuridis V, Cobb S, Graham BP. Encoding and retrieval in a model of the hippocampal CA1 microcircuit. Hippocampus. 2010; 20(3):423-446. https://doi.org/10.1002/hipo.20661 PMID: 19489002\n22. Bezaire MJ, Raikov I, Burk K, Vyas D, Soltesz I. Interneuronal mechanisms of hippocampal theta oscillations in a full-scale model of the rodent CA1 circuit. Elife. 2016:5. https://doi.org/10.7554/eLife. 18566 PMID: 28009257\n23. Tsodyks M, Markram H. The neural code between neocortical pyramidal neurons depends on neurotransmitter release probability. Proc Natl Acad Sci U S A. 1997; 94(2):719-723. https://doi.org/10. 1073/pnas.94.2.719 PMID: 9012851"
    },
    {
      "markdown": "24. Yu GJ, Bouteiller JMC, Berger TW. Topographic Organization of Correlation Along the Longitudinal and Transverse Axes in Rat Hippocampal CA3 Due to Excitatory Afferents. Front Comput Neurosci. 2020; 14:588881. https://doi.org/10.3389/fncom.2020.588881 PMID: 33328947\n25. Eriksson O, Bhalla US, Blackwell KT, Crook SM, Keller D, Kramer A, et al. Combining hypothesis- and data-driven neuroscience modeling in FAIR workflows. Elife. 2022:11. https://doi.org/10.7554/eLife. 69013 PMID: 35792600\n26. Levenstein D, Alvarez VA, Amarasingham A, Azab H, Chen ZS, Gerkin RC, et al. On the Role of Theory and Modeling in Neuroscience. J Neurosci. 2023; 43(7):1074-1088. https://doi.org/10.1523/ JNEUROSCI.1179-22.2022 PMID: 36796842\n27. Markram H, Muller E, Ramaswamy S, Reimann MW, Abdellah M, Sanchez CA, et al. Reconstruction and Simulation of Neocortical Microcircuitry. Cell. 2015; 163(2):456-492. https://doi.org/10.1016/j.cell. 2015.09.029 PMID: 26451489\n28. lavarone E, Simko J, Shi Y, Bertschy M, García-Amado M, Litvak P, et al. Thalamic control of sensory processing and spindles in a biophysical somatosensory thalamoreticular circuit model of wakefulness and sleep. Cell Rep. 2023; 42(3):112200. https://doi.org/10.1016/j.celrep.2023.112200 PMID: 36867532\n29. Reimann MW, Bolaños Puchet S, Courcol JD, Santander DE, Amaudon A, Coste B, et al. Modeling and Simulation of Rat Non-Barrel Somatosensory Cortex. Part I: Modeling Anatomy bioRxiv. 2022: p. 2022.08.11.503144. https://doi.org/10.1101/2022.08.11.503144\n30. Isbister JB, Ecker A, Pokorny C, Bolaños-Puchet S, Santander DE, Amaudon A, et al. Modeling and Simulation of Neocortical Micro- and Mesocircuitry. Part II: Physiology and Experimentation bioRxiv. 2023:p. 2023.05.17.541168. https://doi.org/10.1101/2023.05.17.541168\n31. Teles-Grilo Ruivo LM, Mellor JR. Cholinergic modulation of hippocampal network function. Front Synaptic Neurosci. 2013; 5:2. https://doi.org/10.3389/fnsyn.2013.00002 PMID: 23908628\n32. Kanari L, Dlotko P, Scolamiero M, Levi R, Shillcock J, Hess K, et al. A Topological Representation of Branching Neuronal Morphologies. Neuroinformatics. 2018; 16(1):3-13. https://doi.org/10.1007/ s12021-017-9341-1 PMID: 28975511\n33. Petilla Interneuron Nomenclature Group, Ascoli GA, Alonso-Nanclares L, Anderson SA, Barrionuevo G, Benavides-Piccione R, et al. Petilla terminology: nomenclature of features of GABAergic interneurons of the cerebral cortex. Nat Rev Neurosci. 2008; 9(7):557-568. https://doi.org/10.1038/nrn2402 PMID: 18568015\n34. Ecker A, Romani A, Sáray S, Káli S, Migliore M, Falck J, et al. Data-driven integration of hippocampal CA1 synaptic physiology in silico. Hippocampus. 2020; 30(11):1129-1145. https://doi.org/10.1002/ hipo.23220 PMID: 32520422\n35. Migliore R, Lupascu CA, Bologna LL, Romani A, Courcol JD, Antonel S, et al. The physiological variability of channel density in hippocampal CA1 pyramidal cells and interneurons explored using a unified data-driven modeling workflow. PLoS Comput Biol. 2018; 14(9):e1006423. https://doi.org/10. 1371/journal.pcbi. 1006423 PMID: 30222740\n36. Golding NL, Kath WL, Spruston N. Dichotomy of action-potential backpropagation in CA1 pyramidal neuron dendrites. J Neurophysiol. 2001; 86(6):2998-3010. https://doi.org/10.1152/jn.2001.86.6.2998 PMID: 11731556\n37. Magee JC, Cook EP. Somatic EPSP amplitude is independent of synapse location in hippocampal pyramidal neurons. Nat Neurosci. 2000; 3(9):895-903. https://doi.org/10.1038/78800 PMID: 10966620\n38. Hay E, Hill S, Schürmann F, Markram H, Segev I. Models of Neocortical Layer 5b Pyramidal Cells Capturing a Wide Range of Dendritic and Perisomatic Active Properties. PLoS Comput Biol. 2011; 7 (7):e1002107. https://doi.org/10.1371/journal.pcbi.1002107 PMID: 21829333\n39. Ropireddy D, Bachus SE, Ascoli GA. Non-homogeneous stereological properties of the rat hippocampus from high-resolution 3D serial reconstruction of thin histological sections. Neuroscience. 2012; 205:91-111. https://doi.org/10.1016/j.neuroscience.2011.12.055 PMID: 22245503\n40. Reimann MW, King JG, Muller EB, Ramaswamy S, Markram H. An algorithm to predict the connectome of neural microcircuits. Front Comput Neurosci. 2015:9. https://doi.org/10.3389/fncom. 2015. 00120 PMID: 26500529\n41. Gal E, London M, Globerson A, Ramaswamy S, Reimann MW, Muller E, et al. Rich cell-type-specific network topology in neocortical microcircuitry. Nat Neurosci. 2017; 20(7):1004-1013. https://doi.org/ 10.1038/nn. 4576 PMID: 28581480\n42. Giacopelli G, Tegolo D, Spera E, Migliore M. On the structural connectivity of large-scale models of brain networks at cellular level. Sci Rep. 2021; 11(1):4345. https://doi.org/10.1038/s41598-021-83759-z PMID: 33623053"
    },
    {
      "markdown": "43. Megias M, Emri Z, Freund TF, Gulyas AI. Total number and distribution of inhibitory and excitatory synapses on hippocampal CA1 pyramidal cells. Neuroscience. 2001; 102(3):527-540. https://doi.org/ 10.1016/s0306-4522(00)00496-6 PMID: 11226691\n44. Harris E, Stewart M. Propagation of synchronous epileptiform events from subiculum backward into area CA1 of rat brain slices. Brain Res. 2001; 895(1-2):41-49. https://doi.org/10.1016/s0006-8993 (01)02023-6 PMID: 11259758\n45. Szirmai I, Buzsáki G, Kamondi A. 120 years of hippocampal Schaffer collaterals. Hippocampus. 2012; 22(7):1508-1516. https://doi.org/10.1002/hipo.22001 PMID: 22271231\n46. Dumas TC, Uttaro MR, Barriga C, Brinkley T, Halavi M, Wright SN, et al. Removal of area CA3 from hippocampal slices induces postsynaptic plasticity at Schaffer collateral synapses that normalizes CA1 pyramidal cell discharge. Neurosci Lett. 2018; 678:55-61. https://doi.org/10.1016/j.neulet.2018. 05.011 PMID: 29738844\n47. Sik A, Tamamaki N, Freund TF. Complete Axon Arborization of a Single CA3 Pyramidal Cell in the Rat Hippocampus, and its Relationship With Postsynaptic Parvalbumin-containing Interneurons. Eur J Neurosci. 1993; 5(12):1719-1728. https://doi.org/10.1111/j.1460-9568.1993.tb00239.x PMID: 8124522\n48. Li XG, Somogyi P, Yinen A, Buzsáki G. The hippocampal CA3 network: An in vivo intracellular labeling study: The hippocampal CA3 network. J Comp Neurol. 1994; 339(2):181-208. https://doi.org/10.1002/ cne.903390204 PMID: 8300905\n49. Wittner L, Henze DA, Záborszky L, Buzsáki G. Three-dimensional reconstruction of the axon arbor of a CA3 pyramidal cell recorded and filled in vivo. Brain Struct Funct. 2007; 212(1):75-83. https://doi. org/10.1007/s00429-007-0148-y PMID: 17717699\n50. Sayer RJ, Friedlander MJ, Redman SJ. The time course and amplitude of EPSPs evoked at synapses between pairs of CA3/CA1 neurons in the hippocampal slice. J Neurosci. 1990; 10(3):826-836. https://doi.org/10.1523/JNEUROSCI.10-03-00826.1990 PMID: 2319304\n51. Debanne D, Guérineau NC, Gåhwiler BH, Thompson SM. Physiology and pharmacology of unitary synaptic connections between pairs of cells in areas CA3 and CA1 of rat hippocampal slice cultures. J Neurophysiol. 1995; 73(3):1282-1294. https://doi.org/10.1152/jn.1995.73.3.1282 PMID: 7608771\n52. Milstein AD, Bloss EB, Apostolides PF, Vaidya SP, Dilly GA, Zemelman BV, et al. Inhibitory Gating of Input Comparison in the CA1 Microcircuit. Neuron. 2015; 87(6):1274-1289. https://doi.org/10.1016/j. neuron.2015.08.025 PMID: 26402609\n53. Wierenga CJ, Wadman WJ. Excitatory Inputs to CA1 Interneurons Show Selective Synaptic Dynamics. J Neurophysiol. 2003; 90(2):811-821. https://doi.org/10.1152/jn.00865.2002 PMID: 12904494\n54. Glickfeld LL, Scanziani M. Distinct timing in the activity of cannabinoid-sensitive and cannabinoidinsensitive basket cells. Nat Neurosci. 2006; 9(6):807-815. https://doi.org/10.1038/nn1688 PMID: 16648849\n55. Pouille F, Scanziani M. Enforcement of temporal fidelity in pyramidal cells by somatic feed-forward inhibition. Science. 2001; 293(5532):1159-1163. https://doi.org/10.1126/science.1060342 PMID: 11498596\n56. Sasaki T, Kimura R, Tsukamoto M, Matsuki N, Ikegaya Y. Integrative spike dynamics of rat CA1 neurons: a multineuronal imaging study. J Physiol. 2006; 574:195-208. https://doi.org/10.1113/jphysiol. 2006.108480 PMID: 16613875\n57. Pouille F, Marin-Burgin A, Adesnik H, Atallah BV, Scanziani M. Input normalization by global feedforward inhibition expands cortical dynamic range. Nat Neurosci. 2009; 12(12):1577-1585. https://doi. org/10.1038/nn. 2441 PMID: 19881502\n58. Dannenberg H, Young K, Hasselmo M. Modulation of Hippocampal Circuits by Muscarinic and Nicotinic Receptors. Front Neural Circuits. 2017; 11:102. https://doi.org/10.3389/fncir.2017.00102 PMID: 29321728\n59. Colangelo C, Shichkova P, Keller D, Markram H, Ramaswamy S. Cellular, Synaptic and Network Effects of Acetylcholine in the Neocortex. Front Neural Circuits. 2019; 13:24. https://doi.org/10.3389/ fncir.2019.00024 PMID: 31031601\n60. Hasselmo ME. The role of acetylcholine in learning and memory. Curr Opin Neurobiol. 2006; 16 (6):710-715. https://doi.org/10.1016/j.conb.2006.09.002 PMID: 17011181\n61. Yang D, Ding C, Qi G, Feldmeyer D. Cholinergic and Adenosinergic Modulation of Synaptic Release. Neuroscience. 2021; 456:114-130. https://doi.org/10.1016/j.neuroscience.2020.06.006 PMID: 32540364\n62. Buzsáki G. Theta rhythm of navigation: link between path integration and landmark navigation, episodic and semantic memory. Hippocampus. 2005; 15(7):827-840. https://doi.org/10.1002/hipo. 20113 PMID: 16149082"
    },
    {
      "markdown": "63. Jung R, Kommüller AE. Eine Methodik der Ableitung lokalisierter Potentialschwankungen aus subcorticalen Hirngebieten. Arch Psychiatr Nervenkr. 1938; 109(1):1-30. https://doi.org/10.1007/ BF02157817\n64. Grastyan E, Lissak K, Madarasz I, Donhoffer H. Hippocampal electrical activity during the development of conditioned reflexes. Electroencephalogr Clin Neurophysiol. 1959; 11(3):409-430. https://doi. org/10.1016/0013-4694(59)90040-9 PMID: 13663816\n65. Green JD, Arduini AA. Hippocampal electrical activity in arousal. J Neurophysiol. 1954; 17(6):533557. https://doi.org/10.1152/jn.1954.17.6.533 PMID: 13212425\n66. Vanderwolf CH. Hippocampal electrical activity and voluntary movement in the rat. Electroencephalogr Clin Neurophysiol. 1969; 26(4):407-418. https://doi.org/10.1016/0013-4694(69)90092-3 PMID: 4183562\n67. Goyal A, Miller J, Qasim SE, Watrous AJ, Zhang H, Stein JM, et al. Functionally distinct high and low theta oscillations in the human hippocampus. Nat Commun. 2020; 11(1):2469. https://doi.org/10. 1038/s41467-020-15670-6 PMID: 32424312\n68. Siapas AG, Lubenov EV, Wilson MA. Prefrontal phase locking to hippocampal theta oscillations. Neuron. 2005; 46(1):141-151. https://doi.org/10.1016/j.neuron.2005.02.028 PMID: 15820700\n69. Sirota A, Montgomery S, Fujisawa S, Isomura Y, Zugaro M, Buzsáki G. Entrainment of neocortical neurons and gamma oscillations by the hippocampal theta rhythm. Neuron. 2008; 60(4):683-697. https://doi.org/10.1016/j.neuron.2008.09.014 PMID: 19038224\n70. Buzsáki G. Theta oscillations in the hippocampus. Neuron. 2002; 33(3):325-340. https://doi.org/10. 1016/s0896-6273(02)00586-x PMID: 11832222\n71. Colgin LL. Mechanisms and functions of theta rhythms. Annu Rev Neurosci. 2013; 36:295-312. https://doi.org/10.1146/annurev-neuro-062012-170330 PMID: 23724998\n72. Goutagny R, Jackson J, Williams S. Self-generated theta oscillations in the hippocampus. Nat Neurosci. 2009; 12(12):1491-1493. https://doi.org/10.1038/nn.2440 PMID: 19881503\n73. Ferguson KA, Chatzikalymniou AP, Skinner FK. Combining Theory, Model, and Experiment to Explain How Intrinsic Theta Rhythms Are Generated in an In Vitro Whole Hippocampus Preparation without Oscillatory Inputs. eNeuro. 2017; 4(4). https://doi.org/10.1523/ENEURO.0131-17.2017 PMID: 28791333\n74. Buzsáki G, Rappelsberger P, Kelliényi L. Depth profiles of hippocampal rhythmic slow activity ('theta rhythm') depend on behaviour. Electroencephalogr Clin Neurophysiol. 1985; 61(1):77-88. https://doi. org/10.1016/0013-4694(85)91075-2 PMID: 2408867\n75. Belluscio MA, Mizuseki K, Schmidt R, Kempter R, Buzsáki G. Cross-frequency phase-phase coupling between Theta and Gamma oscillations in the hippocampus. J Neurosci. 2012; 32(2):423-435. https://doi.org/10.1523/JNEUROSCI.4122-11.2012 PMID: 22238079\n76. Fuentealba P, Begum R, Capogna M, Jinno S, Márton LF, Csicsvari J, et al. Ivy Cells: A Population of Nitric-Oxide-Producing, Slow-Spiking GABAergic Neurons and Their Involvement in Hippocampal Network Activity. Neuron. 2008; 57(6):917-929. https://doi.org/10.1016/j.neuron.2008.01.034 PMID: 18367092\n77. Klausberger T, Magill PJ, Márton LF, Roberts JDB, Cobden PM, Buzsáki G, et al. Brain-state- and cell-type-specific firing of hippocampal interneurons in vivo. Nature. 2003; 421(6925):844-848. https:// doi.org/10.1038/nature01374 PMID: 12594513\n78. Klausberger T, Márton LF, Baude A, Roberts JDB, Magill PJ, Somogyi P. Spike timing of dendrite-targeting bistratified cells during hippocampal network oscillations in vivo. Nat Neurosci. 2004; 7(1):4147. https://doi.org/10.1038/nn1159 PMID: 14634650\n79. Klausberger T. Complementary Roles of Cholecystokinin- and Parvalbumin-Expressing GABAergic Neurons in Hippocampal Network Oscillations. J Neurosci. 2005; 25(42):9782-9793. https://doi.org/ 10.1523/JNEUROSCI.3269-05.2005 PMID: 16237182\n80. Ylinen A, Soltész I, Bragin A, Penttonen M, Sik A, Buzsáki G. Intracellular correlates of hippocampal theta rhythm in identified pyramidal cells, granule cells, and basket cells. Hippocampus. 1995; 5 (1):78-90. https://doi.org/10.1002/hipo.450050110 PMID: 7787949\n81. Csicsvari J, Hirase H, Czurko A, Buzsáki G. Reliability and state dependence of pyramidal cell-interneuron synapses in the hippocampus: an ensemble approach in the behaving rat. Neuron. 1998; 21 (1):179-189. https://doi.org/10.1016/s0896-6273(00)80525-5 PMID: 9697862\n82. Hangya B, Borhegyi Z, Szilágyi N, Freund TF, Varga V. GABAergic neurons of the medial septum lead the hippocampal network during theta activity. J Neurosci. 2009; 29(25):8094-8102. https://doi.org/ 10.1523/JNEUROSCI.5665-08.2009 PMID: 19553449\n83. Müller C, Remy S. Septo-hippocampal interaction. Cell Tissue Res. 2018; 373(3):565-575. https:// doi.org/10.1007/s00441-017-2745-2 PMID: 29250747"
    },
    {
      "markdown": "84. Sun Y, Nguyen AQ, Nguyen JP, Le L, Saur D, Choi J, et al. Cell-type-specific circuit connectivity of hippocampal CA1 revealed through Cre-dependent rabies tracing. Cell Rep. 2014; 7(1):269-280. https:// doi.org/10.1016/j.cellrep.2014.02.030 PMID: 24656815\n85. Bianchi R, Wong RK. Carbachol-induced synchronized rhythmic bursts in CA3 neurons of guinea pig hippocampus in vitro. J Neurophysiol. 1994; 72(1):131-138. https://doi.org/10.1152/jn.1994.72.1.131 PMID: 7964998\n86. Fellous JM, Sejnowski TJ. Cholinergic induction of oscillations in the hippocampal slice in the slow $(0.5-2 \\mathrm{~Hz})$, theta ( $5-12 \\mathrm{~Hz}$ ), and gamma ( $35-70 \\mathrm{~Hz}$ ) bands. Hippocampus. 2000; 10(2):187-197. https://doi.org/10.1002/(SICI)1098-1063(2000)10:2<187::AID-HIPO8>3.0.CO;2-M PMID: 10791841\n87. Fisahn A, Pike FG, Buhl EH, Paulsen O. Cholinergic induction of network oscillations at 40 Hz in the hippocampus in vitro. Nature. 1998; 394(6689):186-189. https://doi.org/10.1038/28179 PMID: 9671302\n88. Williams JH, Kauer JA. Properties of carbachol-induced oscillatory activity in rat hippocampus. J Neurophysiol. 1997; 78(5):2631-2640. https://doi.org/10.1152/jn.1997.78.5.2631 PMID: 9356412\n89. Zemankovics R, Veres JM, Oren I, Hajos N. Feedforward Inhibition Underlies the Propagation of Cholinergically Induced Gamma Oscillations from Hippocampal CA3 to CA1. J Neurosci. 2013; 33 (30):12337-12351. https://doi.org/10.1523/JNEUROSCI.3680-12.2013 PMID: 23884940\n90. Jackson J, Amilhon B, Goutagny R, Bott JB, Manseau F, Kortleven C, et al. Reversal of theta rhythm flow through intact hippocampal circuits. Nat Neurosci. 2014; 17(10):1362-1370. https://doi.org/10. 1038/nn. 3803 PMID: 25174002\n91. Goaillard JM, Marder E. Ion Channel Degeneracy, Variability, and Covariation in Neuron and Circuit Resilience. Annu Rev Neurosci. 2021; 44:335-357. https://doi.org/10.1146/annurev-neuro-092920121538 PMID: 33770451\n92. Klausberger T, Somogyi P. Neuronal Diversity and Temporal Dynamics: The Unity of Hippocampal Circuit Operations. Science. 2008; 321(5885):53-57. https://doi.org/10.1126/science.1149381 PMID: 18599766\n93. Koutsoumpa A, Papatheodoropoulos C. Short-term dynamics of input and output of CA1 network greatly differ between the dorsal and ventral rat hippocampus. BMC Neurosci. 2019; 20(1):35. https:// doi.org/10.1186/s12868-019-0517-5 PMID: 31331291\n94. Bittner KC, Grienberger C, Vaidya SP, Milstein AD, Macklin JJ, Suh J, et al. Conjunctive input processing drives feature selectivity in hippocampal CA1 neurons. Nat Neurosci. 2015; 18(8):1133-1142. https://doi.org/10.1038/nn. 4062 PMID: 26167906\n95. Thomson AM, Bannister AP, Hughes DI, Pawelzik H. Differential sensitivity to Zolpidem of IPSPs activated by morphologically identified CA1 interneurons in slices of rat hippocampus: Zolpidem enhancement of basket cell IPSPs in CA1. Eur J Neurosci. 2000; 12(2):425-436. https://doi.org/10.1046/j. 1460-9568.2000.00915.x PMID: 10712623\n96. Pawelzik H, Hughes DI, Thomson AM. Physiological and morphological diversity of immunocytochemically defined parvalbumin- and cholecystokinin-positive interneurones in CA1 of the adult rat hippocampus. J Comp Neurol. 2002; 443(4):346-367. https://doi.org/10.1002/cne. 10118 PMID: 11807843\n97. Hughes DI, Bannister AP, Pawelzik H, Thomson AM. Double immunofluorescence, peroxidase labelling and ultrastructural analysis of interneurones following prolonged electrophysiological recordings in vitro. J Neurosci Methods. 2000; 101(2):107-116. https://doi.org/10.1016/s0165-0270(00)00254-5 PMID: 10996371\n98. Ali AB, Bannister AP, Thomson AM. IPSPs elicited in CA1 pyramidal cells by putative basket cells in slices of adult rat hippocampus: Basket cell IPSPs in CA1 pyramidal cells. Eur J Neurosci. 1999; 11 (5):1741-1753. https://doi.org/10.1046/j.1460-9568.1999.00592.x PMID: 10215927\n99. Mercer A, Bannister AP, Thomson AM. Electrical coupling between pyramidal cells in adult cortical regions. Brain Cell Biol. 2006; 35(1):13-27. https://doi.org/10.1007/s11068-006-9005-9 PMID: 17940910\n100. Pawelzik H, Bannister AP, Deuchars J, Ilia M, Thomson AM. Modulation of bistratifed cell IPSPs and basket cell IPSPs by pentobarbitone sodium, diazepam and $\\mathrm{Zn} 2+$ : dual recordings in slices of adult rat hippocampus. Eur J Neurosci. 1999; 13.\n101. Ali AB, Thomson AM. Synaptic alpha 5 subunit-containing GABAA receptors mediate IPSPs elicited by dendrite-preferring cells in rat neocortex. Cereb Cortex. 2008; 18(6):1260-1271. https://doi.org/10. 1093/cercor/bhm160 PMID: 17951598\n102. Ali AB, Deuchars J, Pawelzik H, Thomson AM. CA1 pyramidal to basket and bistratified cell EPSPs: dual intracellular recordings in rat hippocampal slices. J Physiol. 1998; 507(Pt 1):201-217. https://doi. org/10.1111/j.1469-7793.1998.201bu.x PMID: 9490840"
    },
    {
      "markdown": "103. Sáray S, Rössert CA, Appukuttan S, Migliore R, Vitale P, Lupascu CA, et al. HippoUnit: A software tool for the automated testing and systematic comparison of detailed models of hippocampal neurons based on electrophysiological data. PLoS Comput Biol. 2021; 17(1):e1008114. https://doi.org/10. 1371/journal.pcbi. 1008114 PMID: 33513130\n104. Wang Q, Ding SL, Li Y, Royall J, Feng D, Lesnar P, et al. The Allen Mouse Brain Common Coordinate Framework: A 3D Reference Atlas. Cell. 2020; 181(4):936-953.e20. https://doi.org/10.1016/j.cell. 2020.04.007 PMID: 32386544\n105. Lubenov EV, Siapas AG. Hippocampal theta oscillations are travelling waves. Nature. 2009; 459 (7246):534-539. https://doi.org/10.1038/nature08010 PMID: 19489117\n106. Chindemi G, Abdellah M, Amsalem O, Benavides-Piccione R, Delattre V, Doron M, et al. A calciumbased plasticity model for predicting long-term potentiation and depression in the neocortex. Nat Commun. 2022; 13(1):3038. https://doi.org/10.1038/s41467-022-30214-w PMID: 35650191\n107. Economides G, Falk S, Mercer A. Biocytin Recovery and 3D Reconstructions of Filled Hippocampal CA2 Interneurons. J Vis Exp. 2018; 141. https://doi.org/10.3791/58592 PMID: 30531716\n108. Baimbridge KG, Miller JJ. Immunohistochemical localization of calcium-binding protein in the cerebellum, hippocampal formation and olfactory bulb of the rat. Brain Res. 1982; 245(2):223-229. https://doi. org/10.1016/0006-8993(82)90804-6 PMID: 6751467\n109. Markram H, Lübke J, Frotscher M, Roth A, Sakmann B. Physiology and anatomy of synaptic connections between thick tufted pyramidal neurones in the developing rat neocortex. J Physiol. 1997; 500:409-440. https://doi.org/10.1113/jphysiol.1997.sp022031 PMID: 9147328\n110. Bannister NJ, Larkman AU. Dendritic morphology of CA1 pyramidal neurones from the rat hippocampus: I. Branching patterns. J Comp Neurol. 1995; 360(1):150-160. https://doi.org/10.1002/cne. 903600111 PMID: 7499560\n111. Deguchi Y, Donato F, Galimberti I, Cabuy E, Caroni P. Temporally matched subpopulations of selectively interconnected principal neurons in the hippocampus. Nat Neurosci. 2011; 14(4):495-504. https://doi.org/10.1038/nn. 2768 PMID: 21358645\n112. Mizuseki K, Diba K, Pastalkova E, Buzsáki G. Hippocampal CA1 pyramidal cells form functionally distinct sublayers. Nat Neurosci. 2011; 14(9):1174-1181. https://doi.org/10.1038/nn. 2894 PMID: 21822270\n113. Slomianka L, Amrein I, Knuesel I, Sørensen JC, Wolfer DP. Hippocampal pyramidal cells: the reemergence of cortical lamination. Brain Struct Funct. 2011; 216(4):301-317. https://doi.org/10.1007/ s00429-011-0322-0 PMID: 21597968\n114. Graves AR, Moore SJ, Bloss EB, Mensh BD, Kath WL, Spruston N. Hippocampal Pyramidal Neurons Comprise Two Distinct Cell Types that Are Countermodulated by Metabotropic Receptors. Neuron. 2012; 76(4):776-789. https://doi.org/10.1016/j.neuron.2012.09.036 PMID: 23177962\n115. Lee SH, Marchionni I, Bezaire M, Varga C, Danielson N, Lovett-Barron M, et al. Parvalbumin-positive basket cells differentiate among hippocampal pyramidal cells. Neuron. 2014; 82(5):1129-1144. https://doi.org/10.1016/j.neuron.2014.03.034 PMID: 24836505\n116. Malik R, Dougherty KA, Parikh K, Byrne C, Johnston D. Mapping the electrophysiological and morphological properties of CA1 pyramidal neurons along the longitudinal hippocampal axis. Hippocampus. 2016; 26(3):341-361. https://doi.org/10.1002/hipo.22526 PMID: 26333017\n117. Anwar H, Riachi I, Hill S, Schürmann F, Markram H. An Approach to Capturing Neuron Morphological Diversity. In: Computational Modeling Methods for Neuroscientists. The MIT Press; 2009. p. 211232. Available from: https://doi.org/10.7551/mitpress/9780262013277.003.0010\n118. Yang S, Yang S, Moreira T, Hoffman G, Carlson GC, Bender KJ, et al. Interlamellar CA1 network in the hippocampus. Proc Natl Acad Sci U S A. 2014; 111(35):12919-12924. https://doi.org/10.1073/ pnas. 1405468111 PMID: 25139992\n119. Palacios J, Lida Kanari, Zisis E, MikeG, Benoit Coate, Asanin-Epfl, et al. BlueBrain/NeuroM: v3.2.2; 2022. Available from: https://zenodo.org/record/597333.\n120. Kanari L, Ramaswamy S, Shi Y, Morand S, Meystre J, Perin R, et al. Objective Morphological Classification of Neocortical Pyramidal Cells. Cereb Cortex. 2019; 29(4):1719-1735. https://doi.org/10.1093/ cercor/bhy339 PMID: 30715238\n121. Migliore M, Hoffman DA, Magee JC, Johnston D. Role of an A-type K+ conductance in the back-propagation of action potentials in the dendrites of hippocampal pyramidal neurons. J Comput Neurosci. 1999; 7(1):5-15. https://doi.org/10.1023/a:1008906225285 PMID: 10481998\n122. Migliore M, Ferrante M, Ascoli GA. Signal propagation in oblique dendrites of CA1 pyramidal cells. J Neurophysiol. 2005; 94(6):4145-4155. https://doi.org/10.1152/jn.00521.2005 PMID: 16293591"
    },
    {
      "markdown": "123. Ascoli GA, Gasparini S, Medinilla V, Migliore M. Local control of postinhibitory rebound spiking in CA1 pyramidal neuron dendrites. J Neurosci. 2010; 30(18):6434-6442. https://doi.org/10.1523/ JNEUROSCI.4066-09.2010 PMID: 20445069\n124. Morse TM, Carnevale NT, Mutalik PG, Migliore M, Shepherd GM. Abnormal Excitability of Oblique Dendrites Implicated in Early Alzheimer's: A Computational Study. Front Neural Circuits. 2010; 4:16. https://doi.org/10.3389/fncir.2010.00016 PMID: 20725509\n125. Romani A, Schürmann F, Markram H, Migliore M. Reconstruction of the Hippocampus. Adv Exp Med Biol. 2022; 1359:261-283. https://doi.org/10.1007/978-3-030-89439-9_11 PMID: 35471543\n126. Hoffman DA, Johnston D. Neuromodulation of dendritic action potentials. J Neurophysiol. 1999; 81 (1):408-411. https://doi.org/10.1152/jn.1999.81.1.408 PMID: 9914302\n127. Magee JC. Dendritic lh normalizes temporal summation in hippocampal CA1 neurons. Nat Neurosci. 1999; 2(6):508-514. https://doi.org/10.1038/9158 PMID: 10448214\n128. Shah MM, Migliore M, Valencia I, Cooper EC, Brown DA. Functional significance of axonal Kv7 channels in hippocampal pyramidal neurons. Proc Natl Acad Sci U S A. 2008; 105(22):7869-7874. https:// doi.org/10.1073/pnas.0802805105 PMID: 18515424\n129. Hoffman DA, Magee JC, Colbert CM, Johnston D. K+ channel regulation of signal propagation in dendrites of hippocampal pyramidal neurons. Nature. 1997; 387(6636):869-875. https://doi.org/10.1038/ 43119 PMID: 9202119\n130. Hu H, Martina M, Jonas P. Dendritic mechanisms underlying rapid synaptic activation of fast-spiking hippocampal interneurons. Science. 2010; 327(5961):52-58. https://doi.org/10.1126/science. 1177876 PMID: 19965717\n131. Van Geit W, Gevaert M, Chindemi G, Rössert C, Courcoi JD, Muller EB, et al. BluePyOpt: Leveraging Open Source Software and Cloud Infrastructure to Optimise Model Parameters in Neuroscience. Front Neuroinform. 2016; 10:17. https://doi.org/10.3389/fninf.2016.00017 PMID: 27375471\n132. Sniedovich M. Dijkstra's algorithm revisited: the dynamic programming connexion; p. 599-620.\n133. Agoston MK. Computer graphics and geometric modeling: implementation and algorithms. Springer.\n134. Aika Y, Ren JQ, Kosaka K, Kosaka T. Quantitative analysis of GABA-like-immunoreactive and parval-bumin-containing neurons in the CA1 region of the rat hippocampus using a stereological method, the disector. Exp Brain Res. 1994; 99(2). https://doi.org/10.1007/BF00239593 PMID: 7925807\n135. Knowles WD, Schwartzkroin PA. Local circuit synaptic interactions in hippocampal brain slices. J Neurosci. 1981; 1(3):318-322. https://doi.org/10.1523/JNEUROSCI.01-03-00318.1981 PMID: 7264721\n136. Freund TF, Buzsáki G. Interneurons of the hippocampus. Hippocampus. 1996; 6(4):347-470. https:// doi.org/10.1002/(SICI)1098-1063(1996)6:4<347::AID-HIPO1>3.0.CO;2-I PMID: 8915675\n137. Vida I, Halasy K, Szinyei C, Somogyi P, Buhl EH. Unitary IPSPs evoked by interneurons at the stratum radiatum-stratum lacunosum-moleculare border in the CA1 area of the rat hippocampus in vitro. J Physiol. 1998; 506(3):755-773. https://doi.org/10.1111/j.1469-7793.1998.755bv.x PMID: 9503336\n138. Takács VT, Klausberger T, Somogyi P, Freund TF, Gulyás AI. Extrinsic and local glutamatergic inputs of the rat hippocampal CA1 area differentially innervate pyramidal cells and interneurons. Hippocampus. 2012; 22(6):1379-1391. https://doi.org/10.1002/hipo.20974 PMID: 21956752\n139. Sik A, Penttonen M, Ylinen A, Buzsáki G. Hippocampal CA1 interneurons: an in vivo intracellular labeling study. J Neurosci. 1995; 15(10):6651-6665. https://doi.org/10.1523/JNEUROSCI.15-10-06651. 1995 PMID: 7472426\n140. Markram H, Wang Y, Tsodyks M. Differential signaling via the same axon of neocortical pyramidal neurons. Proc Natl Acad Sci U S A. 1998; 95(9):5323-5328. https://doi.org/10.1073/pnas.95.9.5323 PMID: 9560274\n141. Fuhrmann G, Segev I, Markram H, Tsodyks M. Coding of temporal information by activity-dependent synapses. J Neurophysiol. 2002; 87(1):140-148. https://doi.org/10.1152/jn.00258.2001 PMID: 11784736\n142. Barros-Zulaica N, Rahmon J, Chindemi G, Perin R, Markram H, Muller E, et al. Estimating the ReadilyReleasable Vesicle Pool Size at Synaptic Connections in the Neocortex. Front Synaptic Neurosci. 2019; 11:29. https://doi.org/10.3389/fnsyn.2019.00029 PMID: 31680928\n143. Moradi K, Ascoli GA. A comprehensive knowledge base of synaptic electrophysiology in the rodent hippocampal formation. Hippocampus. 2020; 30(4):314-331. https://doi.org/10.1002/hipo.23148 PMID: 31472001\n144. Maccaferri G, David J, Roberts B, Szucs P, Cottingham CA, Somogyi P. Cell surface domain specific postsynaptic currents evoked by identified GABAergic neurones in rat hippocampus in vitro. J Physiol. 2000; 524(1):91-116. https://doi.org/10.1111/j.1469-7793.2000.t01-3-00091.x PMID: 10747186"
    },
    {
      "markdown": "145. Andrásfalvy BK, Magee JC. Distance-Dependent Increase in AMPA Receptor Number in the Dendrites of Adult Hippocampal CA1 Pyramidal Neurons. J Neurosci. 2001; 21(23):9151-9159. https:// doi.org/10.1523/JNEUROSCI.21-23-09151.2001 PMID: 11717348\n146. Neu A, Földy C, Soltesz I. Postsynaptic origin of CB1-dependent tonic inhibition of GABA release at cholecystokinin-positive basket cell to pyramidal cell synapses in the CA1 region of the rat hippocampus. J Physiol. 2007; 578:233-247. https://doi.org/10.1113/jphysiol.2006.115691 PMID: 17053036\n147. Földy C, Lee SH, Morgan RJ, Soltesz I. Regulation of fast-spiking basket cell synapses by the chloride channel ClC-2. Nat Neurosci. 2010; 13(9):1047-1049. https://doi.org/10.1038/nn. 2609 PMID: 20676104\n148. Lee SH, Foldy C, Soltesz I. Distinct Endocannabinoid Control of GABA Release at Perisomatic and Dendritic Synapses in the Hippocampus. J Neurosci. 2010; 30(23):7993-8000. https://doi.org/10. 1523/JNEUROSCI.6238-09.2010 PMID: 20534847\n149. Elfant D, Pál BZ, Emptage N, Capogna M. Specific inhibitory synapses shift the balance from feedforward to feedback inhibition of hippocampal CA1 pyramidal cells. Eur J Neurosci. 2008; 27(1):104-113. https://doi.org/10.1111/j.1460-9568.2007.06001.x PMID: 18184315\n150. Awile O, Kumbhar P, Cornu N, Dura-Bernal S, King JG, Lupton O, et al. Modernizing the NEURON Simulator for Sustainability, Portability, and Performance. Front Neuroinform. 2022; 16:884046. https://doi.org/10.3389/fninf.2022.884046 PMID: 35832575\n151. Denker M, Yegenoglu A, Grün S. Collaborative HPC-enabled workflows on the HBP Collaboratory using the Elephant framework. https://doi.org/10.12751/INCF.NI2018.0019\n152. Bokil H, Andrews P, Kulkarni JE, Mehta S, Mitra PP. Chronux: a platform for analyzing neural signals. J Neurosci Methods. 2010; 192(1):146-151. https://doi.org/10.1016/j.jneumeth.2010.06.020 PMID: 20637804\n153. Prieto GA, Parker RL, Vernon FL III. A Fortran 90 library for multitaper spectrum analysis. Comput Geosci. 2009; 35(8):1701-1710. https://doi.org/10.1016/j.cageo.2008.06.007\n154. Addison P, Walker J, Guido R. Time-frequency analysis of biosignals. IEEE Eng Med Biol Mag. 2009; 28(5):14-29. https://doi.org/10.1109/MEMB.2009.934244 PMID: 19775952\n155. Potworowski J, Jakuczun W, Leski S, Wojcik D. Kernel current source density method. Neural Comput. 2012; 24(2):541-575. https://doi.org/10.1162/NECO_a_00236 PMID: 22091662\n156. Wilkie D. Rayleigh test for randomness of circular data. J R Stat Soc Ser C Appl Stat. 1983; 32(3):311. https://doi.org/10.2307/2347954\n157. Abdellah M, Hernando J, Eilemann S, Lapere S, Antille N, Markram H, et al. NeuroMorphoVis: a collaborative framework for analysis and visualization of neuronal morphology skeletons reconstructed from microscopy stacks. Bioinformatics. 2018; 34(13):i574-i582. https://doi.org/10.1093/ bioinformatics/bty231 PMID: 29949998"
    }
  ],
  "usage_info": {
    "pages_processed": 61,
    "doc_size_bytes": 6442777
  },
  "_metadata": {
    "model_version": "0.0.0",
    "llm_model": "mistral-ocr-2505",
    "query_data": {
      "pdf": "/Users/satyaortiz-gagne/CODE/paperext/data/cache/fulltext/e6765086eddf9768d092d20114c76088/fulltext.pdf"
    },
    "model_id": "parsepdf"
  }
}